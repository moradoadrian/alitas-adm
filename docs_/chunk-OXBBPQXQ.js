var WP=Object.defineProperty,GP=Object.defineProperties;var KP=Object.getOwnPropertyDescriptors;var ew=Object.getOwnPropertySymbols,QP=Object.getPrototypeOf,YP=Object.prototype.hasOwnProperty,ZP=Object.prototype.propertyIsEnumerable,JP=Reflect.get;var tw=(n,e,t)=>e in n?WP(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ze=(n,e)=>{for(var t in e||={})YP.call(e,t)&&tw(n,t,e[t]);if(ew)for(var t of ew(e))ZP.call(e,t)&&tw(n,t,e[t]);return n},Je=(n,e)=>GP(n,KP(e));var rn=(n,e,t)=>JP(QP(n),t,e);var v=(n,e,t)=>new Promise((r,i)=>{var o=c=>{try{a(t.next(c))}catch(l){i(l)}},s=c=>{try{a(t.throw(c))}catch(l){i(l)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,s);a((t=t.apply(n,e)).next())});function np(n,e){return Object.is(n,e)}var Ge=null,pu=!1,rp=1,qt=Symbol("SIGNAL");function ce(n){let e=Ge;return Ge=n,e}function ip(){return Ge}var io={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function ra(n){if(pu)throw new Error("");if(Ge===null)return;Ge.consumerOnSignalRead(n);let e=Ge.nextProducerIndex++;if(_u(Ge),e<Ge.producerNode.length&&Ge.producerNode[e]!==n&&na(Ge)){let t=Ge.producerNode[e];vu(t,Ge.producerIndexOfThis[e])}Ge.producerNode[e]!==n&&(Ge.producerNode[e]=n,Ge.producerIndexOfThis[e]=na(Ge)?rw(n,Ge,e):0),Ge.producerLastReadVersion[e]=n.version}function nw(){rp++}function op(n){if(!(na(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===rp)){if(!n.producerMustRecompute(n)&&!yu(n)){tp(n);return}n.producerRecomputeValue(n),tp(n)}}function sp(n){if(n.liveConsumerNode===void 0)return;let e=pu;pu=!0;try{for(let t of n.liveConsumerNode)t.dirty||XP(t)}finally{pu=e}}function ap(){return Ge?.consumerAllowSignalWrites!==!1}function XP(n){n.dirty=!0,sp(n),n.consumerMarkedDirty?.(n)}function tp(n){n.dirty=!1,n.lastCleanEpoch=rp}function ia(n){return n&&(n.nextProducerIndex=0),ce(n)}function mu(n,e){if(ce(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(na(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)vu(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function yu(n){_u(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(op(t),r!==t.version))return!0}return!1}function oa(n){if(_u(n),na(n))for(let e=0;e<n.producerNode.length;e++)vu(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function rw(n,e,t){if(iw(n),n.liveConsumerNode.length===0&&ow(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=rw(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function vu(n,e){if(iw(n),n.liveConsumerNode.length===1&&ow(n))for(let r=0;r<n.producerNode.length;r++)vu(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];_u(i),i.producerIndexOfThis[r]=e}}function na(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function _u(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function iw(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function ow(n){return n.producerNode!==void 0}function cp(n,e){let t=Object.create(eM);t.computation=n,e!==void 0&&(t.equal=e);let r=()=>{if(op(t),ra(t),t.value===gu)throw t.error;return t.value};return r[qt]=t,r}var Xf=Symbol("UNSET"),ep=Symbol("COMPUTING"),gu=Symbol("ERRORED"),eM=Je(Ze({},io),{value:Xf,dirty:!0,error:null,equal:np,kind:"computed",producerMustRecompute(n){return n.value===Xf||n.value===ep},producerRecomputeValue(n){if(n.value===ep)throw new Error("Detected cycle in computations.");let e=n.value;n.value=ep;let t=ia(n),r,i=!1;try{r=n.computation(),ce(null),i=e!==Xf&&e!==gu&&r!==gu&&n.equal(e,r)}catch(o){r=gu,n.error=o}finally{mu(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function tM(){throw new Error}var sw=tM;function aw(n){sw(n)}function up(n){sw=n}var nM=null;function lp(n,e){let t=Object.create(Iu);t.value=n,e!==void 0&&(t.equal=e);let r=()=>(ra(t),t.value);return r[qt]=t,r}function sa(n,e){ap()||aw(n),n.equal(n.value,e)||(n.value=e,rM(n))}function dp(n,e){ap()||aw(n),sa(n,e(n.value))}var Iu=Je(Ze({},io),{equal:np,value:void 0,kind:"signal"});function rM(n){n.version++,nw(),sp(n),nM?.()}function hp(n){let e=ce(null);try{return n()}finally{ce(e)}}var fp;function aa(){return fp}function Nn(n){let e=fp;return fp=n,e}var Eu=Symbol("NotFound");function Y(n){return typeof n=="function"}function oo(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var wu=oo(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Zr(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var je=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(Y(r))try{r()}catch(o){e=o instanceof wu?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{cw(o)}catch(s){e=e??[],s instanceof wu?e=[...e,...s.errors]:e.push(s)}}if(e)throw new wu(e)}}add(e){var t;if(e&&e!==this)if(this.closed)cw(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Zr(t,e)}remove(e){let{_finalizers:t}=this;t&&Zr(t,e),e instanceof n&&e._removeParent(this)}};je.EMPTY=(()=>{let n=new je;return n.closed=!0,n})();var pp=je.EMPTY;function Tu(n){return n instanceof je||n&&"closed"in n&&Y(n.remove)&&Y(n.add)&&Y(n.unsubscribe)}function cw(n){Y(n)?n():n.unsubscribe()}var zt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var so={setTimeout(n,e,...t){let{delegate:r}=so;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=so;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Du(n){so.setTimeout(()=>{let{onUnhandledError:e}=zt;if(e)e(n);else throw n})}function Jr(){}var uw=gp("C",void 0,void 0);function lw(n){return gp("E",void 0,n)}function dw(n){return gp("N",n,void 0)}function gp(n,e,t){return{kind:n,value:e,error:t}}var Xr=null;function ao(n){if(zt.useDeprecatedSynchronousErrorHandling){let e=!Xr;if(e&&(Xr={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Xr;if(Xr=null,t)throw r}}else n()}function hw(n){zt.useDeprecatedSynchronousErrorHandling&&Xr&&(Xr.errorThrown=!0,Xr.error=n)}var ei=class extends je{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Tu(e)&&e.add(this)):this.destination=uM}static create(e,t,r){return new co(e,t,r)}next(e){this.isStopped?yp(dw(e),this):this._next(e)}error(e){this.isStopped?yp(lw(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?yp(uw,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},aM=Function.prototype.bind;function mp(n,e){return aM.call(n,e)}var vp=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){bu(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){bu(r)}else bu(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){bu(t)}}},co=class extends ei{constructor(e,t,r){super();let i;if(Y(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&zt.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&mp(e.next,o),error:e.error&&mp(e.error,o),complete:e.complete&&mp(e.complete,o)}):i=e}this.destination=new vp(i)}};function bu(n){zt.useDeprecatedSynchronousErrorHandling?hw(n):Du(n)}function cM(n){throw n}function yp(n,e){let{onStoppedNotification:t}=zt;t&&so.setTimeout(()=>t(n,e))}var uM={closed:!0,next:Jr,error:cM,complete:Jr};var uo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function lt(n){return n}function Cu(...n){return _p(n)}function _p(n){return n.length===0?lt:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var ee=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=dM(t)?t:new co(t,r,i);return ao(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=fw(r),new r((i,o)=>{let s=new co({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[uo](){return this}pipe(...t){return _p(t)(this)}toPromise(t){return t=fw(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function fw(n){var e;return(e=n??zt.Promise)!==null&&e!==void 0?e:Promise}function lM(n){return n&&Y(n.next)&&Y(n.error)&&Y(n.complete)}function dM(n){return n&&n instanceof ei||lM(n)&&Tu(n)}function Ip(n){return Y(n?.lift)}function te(n){return e=>{if(Ip(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Z(n,e,t,r,i){return new Ep(n,e,t,r,i)}var Ep=class extends ei{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function wp(){return te((n,e)=>{let t=null;n._refCount++;let r=Z(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var Tp=class extends ee{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Ip(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new je;let t=this.getSubject();e.add(this.source.subscribe(Z(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=je.EMPTY)}return e}refCount(){return wp()(this)}};var pw=oo(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Rn=(()=>{class n extends ee{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Su(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new pw}next(t){ao(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){ao(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){ao(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?pp:(this.currentObservers=null,o.push(t),new je(()=>{this.currentObservers=null,Zr(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new ee;return t.source=this,t}}return n.create=(e,t)=>new Su(e,t),n})(),Su=class extends Rn{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:pp}};var ca=class extends Rn{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Dp={now(){return(Dp.delegate||Date).now()},delegate:void 0};var Au=class extends je{constructor(e,t){super()}schedule(e,t=0){return this}};var ua={setInterval(n,e,...t){let{delegate:r}=ua;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=ua;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var lo=class extends Au{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return ua.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&ua.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Zr(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var ho=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};ho.now=Dp.now;var fo=class extends ho{constructor(e,t=ho.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var Nu=new fo(lo),bp=Nu;var Ru=class extends lo{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var Pu=class extends fo{};var Cp=new Pu(Ru);var la=new ee(n=>n.complete());function Mu(n){return n&&Y(n.schedule)}function gw(n){return n[n.length-1]}function ku(n){return Y(gw(n))?n.pop():void 0}function ir(n){return Mu(gw(n))?n.pop():void 0}function xu(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function yw(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{l(r.next(d))}catch(f){s(f)}}function c(d){try{l(r.throw(d))}catch(f){s(f)}}function l(d){d.done?o(d.value):i(d.value).then(a,c)}l((r=r.apply(n,e||[])).next())})}function mw(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ti(n){return this instanceof ti?(this.v=n,this):new ti(n)}function vw(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(m){return function(w){return Promise.resolve(w).then(m,f)}}function a(m,w){r[m]&&(i[m]=function(R){return new Promise(function(P,O){o.push([m,R,P,O])>1||c(m,R)})},w&&(i[m]=w(i[m])))}function c(m,w){try{l(r[m](w))}catch(R){g(o[0][3],R)}}function l(m){m.value instanceof ti?Promise.resolve(m.value.v).then(d,f):g(o[0][2],m)}function d(m){c("next",m)}function f(m){c("throw",m)}function g(m,w){m(w),o.shift(),o.length&&c(o[0][0],o[0][1])}}function _w(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof mw=="function"?mw(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,c){s=n[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}}var Ou=n=>n&&typeof n.length=="number"&&typeof n!="function";function Fu(n){return Y(n?.then)}function Lu(n){return Y(n[uo])}function Vu(n){return Symbol.asyncIterator&&Y(n?.[Symbol.asyncIterator])}function ju(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function hM(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Bu=hM();function Uu(n){return Y(n?.[Bu])}function $u(n){return vw(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield ti(t.read());if(i)return yield ti(void 0);yield yield ti(r)}}finally{t.releaseLock()}})}function Hu(n){return Y(n?.getReader)}function Me(n){if(n instanceof ee)return n;if(n!=null){if(Lu(n))return fM(n);if(Ou(n))return pM(n);if(Fu(n))return gM(n);if(Vu(n))return Iw(n);if(Uu(n))return mM(n);if(Hu(n))return yM(n)}throw ju(n)}function fM(n){return new ee(e=>{let t=n[uo]();if(Y(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function pM(n){return new ee(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function gM(n){return new ee(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Du)})}function mM(n){return new ee(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function Iw(n){return new ee(e=>{vM(n,e).catch(t=>e.error(t))})}function yM(n){return Iw($u(n))}function vM(n,e){var t,r,i,o;return yw(this,void 0,void 0,function*(){try{for(t=_w(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function yt(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function or(n,e=0){return te((t,r)=>{t.subscribe(Z(r,i=>yt(r,n,()=>r.next(i),e),()=>yt(r,n,()=>r.complete(),e),i=>yt(r,n,()=>r.error(i),e)))})}function sr(n,e=0){return te((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function Ew(n,e){return Me(n).pipe(sr(e),or(e))}function ww(n,e){return Me(n).pipe(sr(e),or(e))}function Tw(n,e){return new ee(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function Dw(n,e){return new ee(t=>{let r;return yt(t,e,()=>{r=n[Bu](),yt(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>Y(r?.return)&&r.return()})}function qu(n,e){if(!n)throw new Error("Iterable cannot be null");return new ee(t=>{yt(t,e,()=>{let r=n[Symbol.asyncIterator]();yt(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function bw(n,e){return qu($u(n),e)}function Cw(n,e){if(n!=null){if(Lu(n))return Ew(n,e);if(Ou(n))return Tw(n,e);if(Fu(n))return ww(n,e);if(Vu(n))return qu(n,e);if(Uu(n))return Dw(n,e);if(Hu(n))return bw(n,e)}throw ju(n)}function Vt(n,e){return e?Cw(n,e):Me(n)}function _M(...n){let e=ir(n);return Vt(n,e)}function IM(n,e){let t=Y(n)?n:()=>n,r=i=>i.error(t());return new ee(e?i=>e.schedule(r,0,i):r)}function EM(n){return!!n&&(n instanceof ee||Y(n.lift)&&Y(n.subscribe))}var ni=oo(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Sw(n){return n instanceof Date&&!isNaN(n)}function dt(n,e){return te((t,r)=>{let i=0;t.subscribe(Z(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:wM}=Array;function TM(n,e){return wM(e)?n(...e):n(e)}function zu(n){return dt(e=>TM(n,e))}var{isArray:DM}=Array,{getPrototypeOf:bM,prototype:CM,keys:SM}=Object;function Wu(n){if(n.length===1){let e=n[0];if(DM(e))return{args:e,keys:null};if(AM(e)){let t=SM(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function AM(n){return n&&typeof n=="object"&&bM(n)===CM}function Gu(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function NM(...n){let e=ir(n),t=ku(n),{args:r,keys:i}=Wu(n);if(r.length===0)return Vt([],e);let o=new ee(RM(r,e,i?s=>Gu(i,s):lt));return t?o.pipe(zu(t)):o}function RM(n,e,t=lt){return r=>{Aw(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let c=0;c<i;c++)Aw(e,()=>{let l=Vt(n[c],e),d=!1;l.subscribe(Z(r,f=>{o[c]=f,d||(d=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function Aw(n,e,t){n?yt(t,n,e):e()}function Nw(n,e,t,r,i,o,s,a){let c=[],l=0,d=0,f=!1,g=()=>{f&&!c.length&&!l&&e.complete()},m=R=>l<r?w(R):c.push(R),w=R=>{o&&e.next(R),l++;let P=!1;Me(t(R,d++)).subscribe(Z(e,O=>{i?.(O),o?m(O):e.next(O)},()=>{P=!0},void 0,()=>{if(P)try{for(l--;c.length&&l<r;){let O=c.shift();s?yt(e,s,()=>w(O)):w(O)}g()}catch(O){e.error(O)}}))};return n.subscribe(Z(e,m,()=>{f=!0,g()})),()=>{a?.()}}function ri(n,e,t=1/0){return Y(e)?ri((r,i)=>dt((o,s)=>e(r,o,i,s))(Me(n(r,i))),t):(typeof e=="number"&&(t=e),te((r,i)=>Nw(r,i,n,t)))}function Rw(n=1/0){return ri(lt,n)}function Pw(){return Rw(1)}function Ku(...n){return Pw()(Vt(n,ir(n)))}function PM(n){return new ee(e=>{Me(n()).subscribe(e)})}function MM(...n){let e=ku(n),{args:t,keys:r}=Wu(n),i=new ee(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),c=s,l=s;for(let d=0;d<s;d++){let f=!1;Me(t[d]).subscribe(Z(o,g=>{f||(f=!0,l--),a[d]=g},()=>c--,void 0,()=>{(!c||!f)&&(l||o.next(r?Gu(r,a):a),o.complete())}))}});return e?i.pipe(zu(e)):i}function Sp(n=0,e,t=bp){let r=-1;return e!=null&&(Mu(e)?t=e:r=e),new ee(i=>{let o=Sw(n)?+n-t.now():n;o<0&&(o=0);let s=0;return t.schedule(function(){i.closed||(i.next(s++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function ar(n,e){return te((t,r)=>{let i=0;t.subscribe(Z(r,o=>n.call(e,o,i++)&&r.next(o)))})}function Mw(n){return te((e,t)=>{let r=null,i=!1,o;r=e.subscribe(Z(t,void 0,void 0,s=>{o=Me(n(s,Mw(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function kw(n,e,t,r,i){return(o,s)=>{let a=t,c=e,l=0;o.subscribe(Z(s,d=>{let f=l++;c=a?n(c,d,f):(a=!0,d),r&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}function Ap(n,e){return Y(e)?ri(n,e,1):ri(n,1)}function da(n){return te((e,t)=>{let r=!1;e.subscribe(Z(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Np(n){return n<=0?()=>la:te((e,t)=>{let r=0;e.subscribe(Z(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Rp(n,e){return te((t,r)=>{let i=new Set;t.subscribe(Z(r,o=>{let s=n?n(o):o;i.has(s)||(i.add(s),r.next(o))})),e&&Me(e).subscribe(Z(r,()=>i.clear(),Jr))})}function Pp(n,e=lt){return n=n??kM,te((t,r)=>{let i,o=!0;t.subscribe(Z(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function kM(n,e){return n===e}function Qu(n=xM){return te((e,t)=>{let r=!1;e.subscribe(Z(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function xM(){return new ni}function OM(n){return te((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function FM(n,e){let t=arguments.length>=2;return r=>r.pipe(n?ar((i,o)=>n(i,o,r)):lt,Np(1),t?da(e):Qu(()=>new ni))}function Mp(n){return n<=0?()=>la:te((e,t)=>{let r=[];e.subscribe(Z(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function LM(n,e){let t=arguments.length>=2;return r=>r.pipe(n?ar((i,o)=>n(i,o,r)):lt,Mp(1),t?da(e):Qu(()=>new ni))}function kp(){return te((n,e)=>{let t,r=!1;n.subscribe(Z(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function Yu(n,e){return te(kw(n,e,arguments.length>=2,!0))}function xp(...n){let e=ir(n);return te((t,r)=>{(e?Ku(n,t,e):Ku(n,t)).subscribe(r)})}function xw(n,e){return te((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(Z(r,c=>{i?.unsubscribe();let l=0,d=o++;Me(n(c,d)).subscribe(i=Z(r,f=>r.next(e?e(c,f,d,l++):f),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function VM(n){return te((e,t)=>{Me(n).subscribe(Z(t,()=>t.complete(),Jr)),!t.closed&&e.subscribe(t)})}function jM(n,e,t){let r=Y(n)||e||t?{next:n,error:e,complete:t}:n;return r?te((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(Z(o,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),o.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),o.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):lt}var BM="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",ie=class extends Error{code;constructor(e,t){super($M(e,t)),this.code=e}};function UM(n){return`NG0${Math.abs(n)}`}function $M(n,e){return`${UM(n)}${e?": "+e:""}`}var IT=Symbol("InputSignalNode#UNSET"),HM=Je(Ze({},Iu),{transformFn:void 0,applyValueToInputSignal(n,e){sa(n,e)}});function ET(n,e){let t=Object.create(HM);t.value=n,t.transformFn=e?.transform;function r(){if(ra(t),t.value===IT){let i=null;throw new ie(-950,i)}return t.value}return r[qt]=t,r}function ba(n){return{toString:n}.toString()}var Zu="__parameters__";function qM(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function wT(n,e,t){return ba(()=>{let r=qM(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(c,l,d){let f=c.hasOwnProperty(Zu)?c[Zu]:Object.defineProperty(c,Zu,{value:[]})[Zu];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(s),c}}return i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Ju=globalThis;function Ie(n){for(let e in n)if(n[e]===Ie)return e;throw Error("Could not find renamed property on target object.")}function zM(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function _t(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(_t).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function Ow(n,e){return n?e?`${n} ${e}`:n:e||""}var WM=Ie({__forward_ref__:Ie});function TT(n){return n.__forward_ref__=TT,n.toString=function(){return _t(this())},n}function ht(n){return DT(n)?n():n}function DT(n){return typeof n=="function"&&n.hasOwnProperty(WM)&&n.__forward_ref__===TT}function Te(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function kl(n){return{providers:n.providers||[],imports:n.imports||[]}}function xl(n){return Fw(n,bT)||Fw(n,CT)}function V8(n){return xl(n)!==null}function Fw(n,e){return n.hasOwnProperty(e)?n[e]:null}function GM(n){let e=n&&(n[bT]||n[CT]);return e||null}function Lw(n){return n&&(n.hasOwnProperty(Vw)||n.hasOwnProperty(KM))?n[Vw]:null}var bT=Ie({\u0275prov:Ie}),Vw=Ie({\u0275inj:Ie}),CT=Ie({ngInjectableDef:Ie}),KM=Ie({ngInjectorDef:Ie}),oe=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Te({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function ST(n){return n&&!!n.\u0275providers}var QM=Ie({\u0275cmp:Ie}),YM=Ie({\u0275dir:Ie}),ZM=Ie({\u0275pipe:Ie}),JM=Ie({\u0275mod:Ie}),ol=Ie({\u0275fac:Ie}),ga=Ie({__NG_ELEMENT_ID__:Ie}),jw=Ie({__NG_ENV_ID__:Ie});function AT(n){return typeof n=="string"?n:n==null?"":String(n)}function XM(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():AT(n)}function NT(n,e){throw new ie(-200,n)}function Vg(n,e){throw new ie(-201,!1)}var ne=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ne||{}),Yp;function RT(){return Yp}function vt(n){let e=Yp;return Yp=n,e}function PT(n,e,t){let r=xl(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&ne.Optional)return null;if(e!==void 0)return e;Vg(n,"Injector")}var ek={},oi=ek,Zp="__NG_DI_FLAG__",sl=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=t;return this.injector.get(e,r.optional?Eu:oi,r)}},al="ngTempTokenPath",tk="ngTokenPath",nk=/\n/gm,rk="\u0275",Bw="__source";function ik(n,e=ne.Default){if(aa()===void 0)throw new ie(-203,!1);if(aa()===null)return PT(n,void 0,e);{let t=aa(),r;return t instanceof sl?r=t.injector:r=t,r.get(n,e&ne.Optional?null:void 0,e)}}function ft(n,e=ne.Default){return(RT()||ik)(ht(n),e)}function Q(n,e=ne.Default){return ft(n,Ol(e))}function Ol(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Jp(n){let e=[];for(let t=0;t<n.length;t++){let r=ht(n[t]);if(Array.isArray(r)){if(r.length===0)throw new ie(900,!1);let i,o=ne.Default;for(let s=0;s<r.length;s++){let a=r[s],c=ok(a);typeof c=="number"?c===-1?i=a.token:o|=c:i=a}e.push(ft(i,o))}else e.push(ft(r))}return e}function MT(n,e){return n[Zp]=e,n.prototype[Zp]=e,n}function ok(n){return n[Zp]}function sk(n,e,t,r){let i=n[al];throw e[Bw]&&i.unshift(e[Bw]),n.message=ak(`
`+n.message,i,t,r),n[tk]=i,n[al]=null,n}function ak(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==rk?n.slice(2):n;let i=_t(e);if(Array.isArray(e))i=e.map(_t).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):_t(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(nk,`
  `)}`}var At=MT(wT("Optional"),8);var ck=MT(wT("SkipSelf"),4);function ai(n,e){let t=n.hasOwnProperty(ol);return t?n[ol]:null}function jg(n,e){n.forEach(t=>Array.isArray(t)?jg(t,e):e(t))}function kT(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function cl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function uk(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function lk(n,e,t){let r=Ca(n,e);return r>=0?n[r|1]=t:(r=~r,uk(n,r,e,t)),r}function Op(n,e){let t=Ca(n,e);if(t>=0)return n[t|1]}function Ca(n,e){return dk(n,e,1)}function dk(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var ci={},jt=[],ul=new oe(""),xT=new oe("",-1),OT=new oe(""),ll=class{get(e,t=oi){if(t===oi){let r=new Error(`NullInjectorError: No provider for ${_t(e)}!`);throw r.name="NullInjectorError",r}return t}};function FT(n,e){let t=n[JM]||null;if(!t&&e===!0)throw new Error(`Type ${_t(n)} does not have '\u0275mod' property.`);return t}function vo(n){return n[QM]||null}function hk(n){return n[YM]||null}function fk(n){return n[ZM]||null}function No(n){return{\u0275providers:n}}function pk(...n){return{\u0275providers:LT(!0,n),\u0275fromNgModule:!0}}function LT(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return jg(e,s=>{let a=s;Xp(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&VT(i,o),t}function VT(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Bg(i,o=>{e(o,r)})}}function Xp(n,e,t,r){if(n=ht(n),!n)return!1;let i=null,o=Lw(n),s=!o&&vo(n);if(!o&&!s){let c=n.ngModule;if(o=Lw(c),o)i=c;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of c)Xp(l,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let l;try{jg(o.imports,d=>{Xp(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&VT(l,e)}if(!a){let l=ai(i)||(()=>new i);e({provide:i,useFactory:l,deps:jt},i),e({provide:OT,useValue:i,multi:!0},i),e({provide:ul,useValue:()=>ft(i),multi:!0},i)}let c=o.providers;if(c!=null&&!a){let l=n;Bg(c,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function Bg(n,e){for(let t of n)ST(t)&&(t=t.\u0275providers),Array.isArray(t)?Bg(t,e):e(t)}var gk=Ie({provide:String,useValue:Ie});function jT(n){return n!==null&&typeof n=="object"&&gk in n}function mk(n){return!!(n&&n.useExisting)}function yk(n){return!!(n&&n.useFactory)}function _o(n){return typeof n=="function"}function vk(n){return!!n.useClass}var BT=new oe(""),el={},Uw={},Fp;function Ug(){return Fp===void 0&&(Fp=new ll),Fp}var sn=class{},ma=class extends sn{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,tg(e,s=>this.processProvider(s)),this.records.set(xT,po(void 0,this)),i.has("environment")&&this.records.set(sn,po(void 0,this));let o=this.records.get(BT);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(OT,jt,ne.Self))}retrieve(e,t){let r=t;return this.get(e,r.optional?Eu:oi,r)}destroy(){fa(this),this._destroyed=!0;let e=ce(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ce(e)}}onDestroy(e){return fa(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){fa(this);let t=Nn(this),r=vt(void 0),i;try{return e()}finally{Nn(t),vt(r)}}get(e,t=oi,r=ne.Default){if(fa(this),e.hasOwnProperty(jw))return e[jw](this);r=Ol(r);let i,o=Nn(this),s=vt(void 0);try{if(!(r&ne.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=Tk(e)&&xl(e);l&&this.injectableDefInScope(l)?c=po(eg(e),el):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c,r)}let a=r&ne.Self?Ug():this.parent;return t=r&ne.Optional&&t===oi?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[al]=a[al]||[]).unshift(_t(e)),o)throw a;return sk(a,e,"R3InjectorError",this.source)}else throw a}finally{vt(s),Nn(o)}}resolveInjectorInitializers(){let e=ce(null),t=Nn(this),r=vt(void 0),i;try{let o=this.get(ul,jt,ne.Self);for(let s of o)s()}finally{Nn(t),vt(r),ce(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(_t(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=ht(e);let t=_o(e)?e:ht(e&&e.provide),r=Ik(e);if(!_o(e)&&e.multi===!0){let i=this.records.get(t);i||(i=po(void 0,el,!0),i.factory=()=>Jp(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let i=ce(null);try{return t.value===Uw?NT(_t(e)):t.value===el&&(t.value=Uw,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&wk(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ce(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=ht(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function eg(n){let e=xl(n),t=e!==null?e.factory:ai(n);if(t!==null)return t;if(n instanceof oe)throw new ie(204,!1);if(n instanceof Function)return _k(n);throw new ie(204,!1)}function _k(n){if(n.length>0)throw new ie(204,!1);let t=GM(n);return t!==null?()=>t.factory(n):()=>new n}function Ik(n){if(jT(n))return po(void 0,n.useValue);{let e=UT(n);return po(e,el)}}function UT(n,e,t){let r;if(_o(n)){let i=ht(n);return ai(i)||eg(i)}else if(jT(n))r=()=>ht(n.useValue);else if(yk(n))r=()=>n.useFactory(...Jp(n.deps||[]));else if(mk(n))r=(i,o)=>ft(ht(n.useExisting),o!==void 0&&o&ne.Optional?ne.Optional:void 0);else{let i=ht(n&&(n.useClass||n.provide));if(Ek(n))r=()=>new i(...Jp(n.deps));else return ai(i)||eg(i)}return r}function fa(n){if(n.destroyed)throw new ie(205,!1)}function po(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Ek(n){return!!n.deps}function wk(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function Tk(n){return typeof n=="function"||typeof n=="object"&&n instanceof oe}function tg(n,e){for(let t of n)Array.isArray(t)?tg(t,e):t&&ST(t)?tg(t.\u0275providers,e):e(t)}function Ro(n,e){let t;n instanceof ma?(fa(n),t=n):t=new sl(n);let r,i=Nn(t),o=vt(void 0);try{return e()}finally{Nn(i),vt(o)}}function $T(){return RT()!==void 0||aa()!=null}function $g(n){if(!$T())throw new ie(-203,!1)}function Dk(n){return typeof n=="function"}var Pn=0,he=1,J=2,pt=3,Gt=4,Kt=5,dl=6,hl=7,It=8,Io=9,dr=10,Xe=11,ya=12,$w=13,Po=14,an=15,Eo=16,go=17,wo=18,Fl=19,HT=20,ur=21,Lp=22,ui=23,Bt=24,Vp=25,St=26,qT=1;var li=7,fl=8,pl=9,Ut=10;function lr(n){return Array.isArray(n)&&typeof n[qT]=="object"}function Mn(n){return Array.isArray(n)&&n[qT]===!0}function Hg(n){return(n.flags&4)!==0}function Mo(n){return n.componentOffset>-1}function Ll(n){return(n.flags&1)===1}function cn(n){return!!n.template}function gl(n){return(n[J]&512)!==0}function ko(n){return(n[J]&256)===256}var ng=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function zT(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var bk=(()=>{let n=()=>WT;return n.ngInherit=!0,n})();function WT(n){return n.type.prototype.ngOnChanges&&(n.setInput=Sk),Ck}function Ck(){let n=KT(this),e=n?.current;if(e){let t=n.previous;if(t===ci)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function Sk(n,e,t,r,i){let o=this.declaredInputs[r],s=KT(n)||Ak(n,{previous:ci,current:null}),a=s.current||(s.current={}),c=s.previous,l=c[o];a[o]=new ng(l&&l.currentValue,t,c===ci),zT(n,e,i,t)}var GT="__ngSimpleChanges__";function KT(n){return n[GT]||null}function Ak(n,e){return n[GT]=e}var Hw=null;var Ee=function(n,e=null,t){Hw?.(n,e,t)},Nk="svg",Rk="math";function un(n){for(;Array.isArray(n);)n=n[Pn];return n}function QT(n,e){return un(e[n])}function kn(n,e){return un(e[n.index])}function YT(n,e){return n.data[e]}function ZT(n,e){return n[e]}function Pk(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function ln(n,e){let t=e[n];return lr(t)?t:t[Pn]}function qg(n){return(n[J]&128)===128}function Mk(n){return Mn(n[pt])}function To(n,e){return e==null?null:n[e]}function JT(n){n[go]=0}function XT(n){n[J]&1024||(n[J]|=1024,qg(n)&&Sa(n))}function kk(n,e){for(;n>0;)e=e[Po],n--;return e}function Vl(n){return!!(n[J]&9216||n[Bt]?.dirty)}function rg(n){n[dr].changeDetectionScheduler?.notify(8),n[J]&64&&(n[J]|=1024),Vl(n)&&Sa(n)}function Sa(n){n[dr].changeDetectionScheduler?.notify(0);let e=di(n);for(;e!==null&&!(e[J]&8192||(e[J]|=8192,!qg(e)));)e=di(e)}function eD(n,e){if(ko(n))throw new ie(911,!1);n[ur]===null&&(n[ur]=[]),n[ur].push(e)}function xk(n,e){if(n[ur]===null)return;let t=n[ur].indexOf(e);t!==-1&&n[ur].splice(t,1)}function di(n){let e=n[pt];return Mn(e)?e[pt]:e}function tD(n){return n[hl]??=[]}function nD(n){return n.cleanup??=[]}var re={lFrame:lD(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var ig=!1;function Ok(){return re.lFrame.elementDepthCount}function Fk(){re.lFrame.elementDepthCount++}function Lk(){re.lFrame.elementDepthCount--}function zg(){return re.bindingsEnabled}function Vk(){return re.skipHydrationRootTNode!==null}function jk(n){return re.skipHydrationRootTNode===n}function Bk(){re.skipHydrationRootTNode=null}function Ce(){return re.lFrame.lView}function Nt(){return re.lFrame.tView}function j8(n){return re.lFrame.contextLView=n,n[It]}function B8(n){return re.lFrame.contextLView=null,n}function Rt(){let n=rD();for(;n!==null&&n.type===64;)n=n.parent;return n}function rD(){return re.lFrame.currentTNode}function Uk(){let n=re.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function mi(n,e){let t=re.lFrame;t.currentTNode=n,t.isParent=e}function Wg(){return re.lFrame.isParent}function iD(){re.lFrame.isParent=!1}function $k(){return re.lFrame.contextLView}function oD(){return ig}function ml(n){let e=ig;return ig=n,e}function Hk(){let n=re.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function qk(n){return re.lFrame.bindingIndex=n}function sD(){return re.lFrame.bindingIndex++}function zk(n){let e=re.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Wk(){return re.lFrame.inI18n}function Gk(n,e){let t=re.lFrame;t.bindingIndex=t.bindingRootIndex=n,og(e)}function Kk(){return re.lFrame.currentDirectiveIndex}function og(n){re.lFrame.currentDirectiveIndex=n}function Qk(n){let e=re.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function aD(n){re.lFrame.currentQueryIndex=n}function Yk(n){let e=n[he];return e.type===2?e.declTNode:e.type===1?n[Kt]:null}function cD(n,e,t){if(t&ne.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&ne.Host);)if(i=Yk(o),i===null||(o=o[Po],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=re.lFrame=uD();return r.currentTNode=e,r.lView=n,!0}function Gg(n){let e=uD(),t=n[he];re.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function uD(){let n=re.lFrame,e=n===null?null:n.child;return e===null?lD(n):e}function lD(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function dD(){let n=re.lFrame;return re.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var hD=dD;function Kg(){let n=dD();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Zk(n){return(re.lFrame.contextLView=kk(n,re.lFrame.contextLView))[It]}function xo(){return re.lFrame.selectedIndex}function hi(n){re.lFrame.selectedIndex=n}function Jk(){let n=re.lFrame;return YT(n.tView,n.selectedIndex)}function Xk(){return re.lFrame.currentNamespace}var fD=!0;function jl(){return fD}function Bl(n){fD=n}function ex(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=WT(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function Qg(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function tl(n,e,t){pD(n,e,3,t)}function nl(n,e,t,r){(n[J]&3)===t&&pD(n,e,t,r)}function jp(n,e){let t=n[J];(t&3)===e&&(t&=16383,t+=1,n[J]=t)}function pD(n,e,t,r){let i=r!==void 0?n[go]&65535:0,o=r??-1,s=e.length-1,a=0;for(let c=i;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[go]+=65536),(a<o||o==-1)&&(tx(n,t,e,c),n[go]=(n[go]&4294901760)+c+2),c++}function qw(n,e){Ee(4,n,e);let t=ce(null);try{e.call(n)}finally{ce(t),Ee(5,n,e)}}function tx(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[J]>>14<n[go]>>16&&(n[J]&3)===e&&(n[J]+=16384,qw(a,o)):qw(a,o)}var yo=-1,fi=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=r}};function nx(n){return(n.flags&8)!==0}function rx(n){return(n.flags&16)!==0}function ix(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];sx(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function ox(n){return n===3||n===4||n===6}function sx(n){return n.charCodeAt(0)===64}function Do(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?zw(n,t,i,null,e[++r]):zw(n,t,i,null,null))}}return n}function zw(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){i!==null&&(n[o+1]=i);return}o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),i!==null&&n.splice(o++,0,i)}function gD(n){return n!==yo}function yl(n){return n&32767}function ax(n){return n>>16}function vl(n,e){let t=ax(n),r=e;for(;t>0;)r=r[Po],t--;return r}var sg=!0;function _l(n){let e=sg;return sg=n,e}var cx=256,mD=cx-1,yD=5,ux=0,on={};function lx(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(ga)&&(r=t[ga]),r==null&&(r=t[ga]=ux++);let i=r&mD,o=1<<i;e.data[n+(i>>yD)]|=o}function Il(n,e){let t=vD(n,e);if(t!==-1)return t;let r=e[he];r.firstCreatePass&&(n.injectorIndex=e.length,Bp(r.data,n),Bp(e,null),Bp(r.blueprint,null));let i=Yg(n,e),o=n.injectorIndex;if(gD(i)){let s=yl(i),a=vl(i,e),c=a[he].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|c[s+l]}return e[o+8]=i,o}function Bp(n,e){n.push(0,0,0,0,0,0,0,0,e)}function vD(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Yg(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=TD(i),r===null)return yo;if(t++,i=i[Po],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return yo}function ag(n,e,t){lx(n,e,t)}function _D(n,e,t){if(t&ne.Optional||n!==void 0)return n;Vg(e,"NodeInjector")}function ID(n,e,t,r){if(t&ne.Optional&&r===void 0&&(r=null),(t&(ne.Self|ne.Host))===0){let i=n[Io],o=vt(void 0);try{return i?i.get(e,r,t&ne.Optional):PT(e,r,t&ne.Optional)}finally{vt(o)}}return _D(r,e,t)}function ED(n,e,t,r=ne.Default,i){if(n!==null){if(e[J]&2048&&!(r&ne.Self)){let s=gx(n,e,t,r,on);if(s!==on)return s}let o=wD(n,e,t,r,on);if(o!==on)return o}return ID(e,t,r,i)}function wD(n,e,t,r,i){let o=fx(t);if(typeof o=="function"){if(!cD(e,n,r))return r&ne.Host?_D(i,t,r):ID(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&ne.Optional))Vg(t);else return s}finally{hD()}}else if(typeof o=="number"){let s=null,a=vD(n,e),c=yo,l=r&ne.Host?e[an][Kt]:null;for((a===-1||r&ne.SkipSelf)&&(c=a===-1?Yg(n,e):e[a+8],c===yo||!Gw(r,!1)?a=-1:(s=e[he],a=yl(c),e=vl(c,e)));a!==-1;){let d=e[he];if(Ww(o,a,d.data)){let f=dx(a,e,t,s,r,l);if(f!==on)return f}c=e[a+8],c!==yo&&Gw(r,e[he].data[a+8]===l)&&Ww(o,a,e)?(s=d,a=yl(c),e=vl(c,e)):a=-1}}return i}function dx(n,e,t,r,i,o){let s=e[he],a=s.data[n+8],c=r==null?Mo(a)&&sg:r!=s&&(a.type&3)!==0,l=i&ne.Host&&o===a,d=hx(a,s,t,c,l);return d!==null?El(e,s,d,a,i):on}function hx(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,c=n.directiveStart,l=n.directiveEnd,d=o>>20,f=r?a:a+d,g=i?a+d:l;for(let m=f;m<g;m++){let w=s[m];if(m<c&&t===w||m>=c&&w.type===t)return m}if(i){let m=s[c];if(m&&cn(m)&&m.type===t)return c}return null}function El(n,e,t,r,i){let o=n[t],s=e.data;if(o instanceof fi){let a=o;a.resolving&&NT(XM(s[t]));let c=_l(a.canSeeViewProviders);a.resolving=!0;let l,d=a.injectImpl?vt(a.injectImpl):null,f=cD(n,r,ne.Default);try{o=n[t]=a.factory(void 0,i,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&ex(t,s[t],e)}finally{d!==null&&vt(d),_l(c),a.resolving=!1,hD()}}return o}function fx(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(ga)?n[ga]:void 0;return typeof e=="number"?e>=0?e&mD:px:e}function Ww(n,e,t){let r=1<<n;return!!(t[e+(n>>yD)]&r)}function Gw(n,e){return!(n&ne.Self)&&!(n&ne.Host&&e)}var si=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return ED(this._tNode,this._lView,e,Ol(r),t)}};function px(){return new si(Rt(),Ce())}function U8(n){return ba(()=>{let e=n.prototype.constructor,t=e[ol]||cg(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[ol]||cg(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function cg(n){return DT(n)?()=>{let e=cg(ht(n));return e&&e()}:ai(n)}function gx(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[J]&2048&&!gl(s);){let a=wD(o,s,t,r|ne.Self,on);if(a!==on)return a;let c=o.parent;if(!c){let l=s[HT];if(l){let d=l.get(t,on,r);if(d!==on)return d}c=TD(s),s=s[Po]}o=c}return i}function TD(n){let e=n[he],t=e.type;return t===2?e.declTNode:t===1?n[Kt]:null}function Kw(n,e=null,t=null,r){let i=DD(n,e,t,r);return i.resolveInjectorInitializers(),i}function DD(n,e=null,t=null,r,i=new Set){let o=[t||jt,pk(n)];return r=r||(typeof n=="object"?void 0:_t(n)),new ma(o,e||Ug(),r||null,i)}var Et=class n{static THROW_IF_NOT_FOUND=oi;static NULL=new ll;static create(e,t){if(Array.isArray(e))return Kw({name:""},t,e,"");{let r=e.name??"";return Kw({name:r},e.parent,e.providers,r)}}static \u0275prov=Te({token:n,providedIn:"any",factory:()=>ft(xT)});static __NG_ELEMENT_ID__=-1};var mx=new oe("");mx.__NG_ELEMENT_ID__=n=>{let e=Rt();if(e===null)throw new ie(204,!1);if(e.type&2)return e.value;if(n&ne.Optional)return null;throw new ie(204,!1)};var bD=!1,Ul=(()=>{class n{static __NG_ELEMENT_ID__=yx;static __NG_ENV_ID__=t=>t}return n})(),wl=class extends Ul{_lView;constructor(e){super(),this._lView=e}onDestroy(e){let t=this._lView;return ko(t)?(e(),()=>{}):(eD(t,e),()=>xk(t,e))}};function yx(){return new wl(Ce())}var pi=class{},CD=new oe("",{providedIn:"root",factory:()=>!1});var SD=new oe(""),AD=new oe(""),Aa=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new ca(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=Te({token:n,providedIn:"root",factory:()=>new n})}return n})(),$l=(()=>{class n{internalPendingTasks=Q(Aa);scheduler=Q(pi);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){return v(this,null,function*(){let r=this.add();try{return yield t()}finally{r()}})}static \u0275prov=Te({token:n,providedIn:"root",factory:()=>new n})}return n})(),ug=class extends Rn{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,$T()&&(this.destroyRef=Q(Ul,{optional:!0})??void 0,this.pendingTasks=Q(Aa,{optional:!0})??void 0)}emit(e){let t=ce(null);try{super.next(e)}finally{ce(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof je&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},cr=ug;function va(...n){}function ND(n){let e,t;function r(){n=va;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function Qw(n){return queueMicrotask(()=>n()),()=>{n=va}}var Zg="isAngularZone",Tl=Zg+"_ID",vx=0,xe=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new cr(!1);onMicrotaskEmpty=new cr(!1);onStable=new cr(!1);onError=new cr(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=bD}=e;if(typeof Zone>"u")throw new ie(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,Ex(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Zg)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ie(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ie(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,_x,va,va);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},_x={};function Jg(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Ix(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){ND(()=>{n.callbackScheduled=!1,lg(n),n.isCheckStableRunning=!0,Jg(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),lg(n)}function Ex(n){let e=()=>{Ix(n)},t=vx++;n._inner=n._inner.fork({name:"angular",properties:{[Zg]:!0,[Tl]:t,[Tl+t]:!0},onInvokeTask:(r,i,o,s,a,c)=>{if(wx(c))return r.invokeTask(o,s,a,c);try{return Yw(n),r.invokeTask(o,s,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),Zw(n)}},onInvoke:(r,i,o,s,a,c,l)=>{try{return Yw(n),r.invoke(o,s,a,c,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!Tx(c)&&e(),Zw(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,lg(n),Jg(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function lg(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function Yw(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Zw(n){n._nesting--,Jg(n)}var dg=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new cr;onMicrotaskEmpty=new cr;onStable=new cr;onError=new cr;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function wx(n){return RD(n,"__ignore_ng_zone__")}function Tx(n){return RD(n,"__scheduler_tick__")}function RD(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var bo=class{_console=console;handleError(e){this._console.error("ERROR",e)}},Dx=new oe("",{providedIn:"root",factory:()=>{let n=Q(xe),e=Q(bo);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function Jw(n,e){return ET(n,e)}function bx(n){return ET(IT,n)}var $8=(Jw.required=bx,Jw);function Cx(){return Hl(Rt(),Ce())}function Hl(n,e){return new Xg(kn(n,e))}var Xg=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=Cx}return n})();function Sx(n,e){let t=lp(n,e?.equal),r=t[qt];return t.set=i=>sa(r,i),t.update=i=>dp(r,i),t.asReadonly=Ax.bind(t),t}function Ax(){let n=this[qt];if(n.readonlyFn===void 0){let e=()=>this();e[qt]=n,n.readonlyFn=e}return n.readonlyFn}function PD(n){return(n.flags&128)===128}var MD=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(MD||{}),kD=new Map,Nx=0;function Rx(){return Nx++}function Px(n){kD.set(n[Fl],n)}function hg(n){kD.delete(n[Fl])}var Xw="__ngContext__";function Oo(n,e){lr(e)?(n[Xw]=e[Fl],Px(e)):n[Xw]=e}function xD(n){return FD(n[ya])}function OD(n){return FD(n[Gt])}function FD(n){for(;n!==null&&!Mn(n);)n=n[Gt];return n}var fg;function H8(n){fg=n}function Mx(){if(fg!==void 0)return fg;if(typeof document<"u")return document;throw new ie(210,!1)}var q8=new oe("",{providedIn:"root",factory:()=>kx}),kx="ng",xx=new oe(""),LD=new oe("",{providedIn:"platform",factory:()=>"unknown"});var z8=new oe("",{providedIn:"root",factory:()=>Mx().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Ox="h",Fx="b";var VD=!1,Lx=new oe("",{providedIn:"root",factory:()=>VD});var jD=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(jD||{}),BD=new oe(""),eT=new Set;function Vx(n){eT.has(n)||(eT.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var UD=(()=>{class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=jx}return n})();function jx(){return new UD(Ce(),Rt())}var Bx=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=Te({token:n,providedIn:"root",factory:()=>new n})}return n})();var Ux=(n,e,t,r)=>{};function $x(n,e,t,r){Ux(n,e,t,r)}var Hx=()=>null;function $D(n,e,t=!1){return Hx(n,e,t)}function HD(n,e){let t=n.contentQueries;if(t!==null){let r=ce(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];aD(o),a.contentQueries(2,e[s],s)}}}finally{ce(r)}}}function pg(n,e,t){aD(0);let r=ce(null);try{e(n,t)}finally{ce(r)}}function em(n,e,t){if(Hg(e)){let r=ce(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{ce(r)}}}var _a=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(_a||{});var gg=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${BM})`}};function qx(n){return n instanceof gg?n.changingThisBreaksApplicationSecurity:n}var zx=/^>|^->|<!--|-->|--!>|<!-$/g,Wx=/(<|>)/g,Gx="\u200B$1\u200B";function Kx(n){return n.replace(zx,e=>e.replace(Wx,Gx))}function qD(n){return n instanceof Function?n():n}function Qx(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}var zD="ng-template";function Yx(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&Qx(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(tm(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function tm(n){return n.type===4&&n.value!==zD}function Zx(n,e,t){let r=n.type===4&&!t?zD:n.value;return e===r}function Jx(n,e,t){let r=4,i=n.attrs,o=i!==null?t1(i):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!Wt(r)&&!Wt(c))return!1;if(s&&Wt(c))continue;s=!1,r=c|r&1;continue}if(!s)if(r&4){if(r=2|r&1,c!==""&&!Zx(n,c,t)||c===""&&e.length===1){if(Wt(r))return!1;s=!0}}else if(r&8){if(i===null||!Yx(n,i,c,t)){if(Wt(r))return!1;s=!0}}else{let l=e[++a],d=Xx(c,i,tm(n),t);if(d===-1){if(Wt(r))return!1;s=!0;continue}if(l!==""){let f;if(d>o?f="":f=i[d+1].toLowerCase(),r&2&&l!==f){if(Wt(r))return!1;s=!0}}}}return Wt(r)||s}function Wt(n){return(n&1)===0}function Xx(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return n1(e,n)}function e1(n,e,t=!1){for(let r=0;r<e.length;r++)if(Jx(n,e[r],t))return!0;return!1}function t1(n){for(let e=0;e<n.length;e++){let t=n[e];if(ox(t))return e}return n.length}function n1(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function tT(n,e){return n?":not("+e.trim()+")":e}function r1(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Wt(s)&&(e+=tT(o,i),i=""),r=s,o=o||!Wt(r);t++}return i!==""&&(e+=tT(o,i)),e}function i1(n){return n.map(r1).join(",")}function o1(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Wt(i))break;i=o}r++}return t.length&&e.push(1,...t),e}var yi={};function s1(n,e){return n.createText(e)}function a1(n,e,t){n.setValue(e,t)}function c1(n,e){return n.createComment(Kx(e))}function WD(n,e,t){return n.createElement(e,t)}function Dl(n,e,t,r,i){n.insertBefore(e,t,r,i)}function GD(n,e,t){n.appendChild(e,t)}function nT(n,e,t,r,i){r!==null?Dl(n,e,t,r,i):GD(n,e,t)}function u1(n,e,t){n.removeChild(null,e,t)}function l1(n,e,t){n.setAttribute(e,"style",t)}function d1(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function KD(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&ix(n,e,r),i!==null&&d1(n,e,i),o!==null&&l1(n,e,o)}function nm(n,e,t,r,i,o,s,a,c,l,d){let f=St+r,g=f+i,m=h1(f,g),w=typeof l=="function"?l():l;return m[he]={type:n,blueprint:m,template:t,queries:null,viewQuery:a,declTNode:e,data:m.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:d}}function h1(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:yi);return t}function f1(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=nm(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function rm(n,e,t,r,i,o,s,a,c,l,d){let f=e.blueprint.slice();return f[Pn]=i,f[J]=r|4|128|8|64|1024,(l!==null||n&&n[J]&2048)&&(f[J]|=2048),JT(f),f[pt]=f[Po]=n,f[It]=t,f[dr]=s||n&&n[dr],f[Xe]=a||n&&n[Xe],f[Io]=c||n&&n[Io]||null,f[Kt]=o,f[Fl]=Rx(),f[dl]=d,f[HT]=l,f[an]=e.type==2?n[an]:f,f}function p1(n,e,t){let r=kn(e,n),i=f1(t),o=n[dr].rendererFactory,s=im(n,rm(n,i,null,QD(t),r,e,null,o.createRenderer(r,t),null,null,null));return n[e.index]=s}function QD(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function YD(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function im(n,e){return n[ya]?n[$w][Gt]=e:n[ya]=e,n[$w]=e,e}function W8(n=1){ZD(Nt(),Ce(),xo()+n,!1)}function ZD(n,e,t,r){if(!r)if((e[J]&3)===3){let o=n.preOrderCheckHooks;o!==null&&tl(e,o,t)}else{let o=n.preOrderHooks;o!==null&&nl(e,o,0,t)}hi(t)}var ql=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(ql||{});function mg(n,e,t,r){let i=ce(null);try{let[o,s,a]=n.inputs[t],c=null;(s&ql.SignalBased)!==0&&(c=e[o][qt]),c!==null&&c.transformFn!==void 0?r=c.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,c,r,t,o):zT(e,c,o,r)}finally{ce(i)}}function JD(n,e,t,r,i){let o=xo(),s=r&2;try{hi(-1),s&&e.length>St&&ZD(n,e,St,!1),Ee(s?2:0,i),t(r,i)}finally{hi(o),Ee(s?3:1,i)}}function zl(n,e,t){E1(n,e,t),(t.flags&64)===64&&w1(n,e,t)}function om(n,e,t=kn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function g1(n,e,t,r){let o=r.get(Lx,VD)||t===_a.ShadowDom,s=n.selectRootElement(e,o);return m1(s),s}function m1(n){y1(n)}var y1=()=>null;function v1(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function _1(n,e,t,r,i,o,s,a){if(!a&&am(e,n,t,r,i)){Mo(e)&&I1(t,e.index);return}if(e.type&3){let c=kn(e,t);r=v1(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(c,r,i)}else e.type&12}function I1(n,e){let t=ln(e,n);t[J]&16||(t[J]|=64)}function E1(n,e,t){let r=t.directiveStart,i=t.directiveEnd;Mo(t)&&p1(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Il(t,e);let o=t.initialInputs;for(let s=r;s<i;s++){let a=n.data[s],c=El(e,n,s,t);if(Oo(c,e),o!==null&&D1(e,s-r,c,a,t,o),cn(a)){let l=ln(t.index,e);l[It]=El(e,n,s,t)}}}function w1(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=Kk();try{hi(o);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];og(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&T1(c,l)}}finally{hi(-1),og(s)}}function T1(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function sm(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let o=t[i];e1(e,o.selectors,!1)&&(r??=[],cn(o)?r.unshift(o):r.push(o))}return r}function D1(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let c=s[a],l=s[a+1];mg(r,t,c,l)}}function b1(n,e){let t=n[Io],r=t?t.get(bo,null):null;r&&r.handleError(e)}function am(n,e,t,r,i){let o=n.inputs?.[r],s=n.hostDirectiveInputs?.[r],a=!1;if(s)for(let c=0;c<s.length;c+=2){let l=s[c],d=s[c+1],f=e.data[l];mg(f,t[l],d,i),a=!0}if(o)for(let c of o){let l=t[c],d=e.data[c];mg(d,l,r,i),a=!0}return a}function C1(n,e){let t=ln(e,n),r=t[he];S1(r,t);let i=t[Pn];i!==null&&t[dl]===null&&(t[dl]=$D(i,t[Io])),Ee(18),cm(r,t,t[It]),Ee(19,t[It])}function S1(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function cm(n,e,t){Gg(e);try{let r=n.viewQuery;r!==null&&pg(1,r,t);let i=n.template;i!==null&&JD(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[wo]?.finishViewCreation(n),n.staticContentQueries&&HD(n,e),n.staticViewQueries&&pg(2,n.viewQuery,t);let o=n.components;o!==null&&A1(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[J]&=-5,Kg()}}function A1(n,e){for(let t=0;t<e.length;t++)C1(n,e[t])}function N1(n,e,t,r){let i=ce(null);try{let o=e.tView,a=n[J]&4096?4096:16,c=rm(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[Eo]=l;let d=n[wo];return d!==null&&(c[wo]=d.createEmbeddedView(o)),cm(o,c,t),c}finally{ce(i)}}function rT(n,e){return!e||e.firstChild===null||PD(n)}var R1;function um(n,e){return R1(n,e)}var bl=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(bl||{});function XD(n){return(n.flags&32)===32}function mo(n,e,t,r,i){if(r!=null){let o,s=!1;Mn(r)?o=r:lr(r)&&(s=!0,r=r[Pn]);let a=un(r);n===0&&t!==null?i==null?GD(e,t,a):Dl(e,t,a,i||null,!0):n===1&&t!==null?Dl(e,t,a,i||null,!0):n===2?u1(e,a,s):n===3&&e.destroyNode(a),o!=null&&$1(e,n,o,t,i)}}function P1(n,e){eb(n,e),e[Pn]=null,e[Kt]=null}function M1(n,e,t,r,i,o){r[Pn]=i,r[Kt]=e,Gl(n,r,t,1,i,o)}function eb(n,e){e[dr].changeDetectionScheduler?.notify(9),Gl(n,e,e[Xe],2,null,null)}function k1(n){let e=n[ya];if(!e)return Up(n[he],n);for(;e;){let t=null;if(lr(e))t=e[ya];else{let r=e[Ut];r&&(t=r)}if(!t){for(;e&&!e[Gt]&&e!==n;)lr(e)&&Up(e[he],e),e=e[pt];e===null&&(e=n),lr(e)&&Up(e[he],e),t=e&&e[Gt]}e=t}}function lm(n,e){let t=n[pl],r=t.indexOf(e);t.splice(r,1)}function tb(n,e){if(ko(e))return;let t=e[Xe];t.destroyNode&&Gl(n,e,t,3,null,null),k1(e)}function Up(n,e){if(ko(e))return;let t=ce(null);try{e[J]&=-129,e[J]|=256,e[Bt]&&oa(e[Bt]),O1(n,e),x1(n,e),e[he].type===1&&e[Xe].destroy();let r=e[Eo];if(r!==null&&Mn(e[pt])){r!==e[pt]&&lm(r,e);let i=e[wo];i!==null&&i.detachView(n)}hg(e)}finally{ce(t)}}function x1(n,e){let t=n.cleanup,r=e[hl];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[hl]=null);let i=e[ur];if(i!==null){e[ur]=null;for(let s=0;s<i.length;s++){let a=i[s];a()}}let o=e[ui];if(o!==null){e[ui]=null;for(let s of o)s.destroy()}}function O1(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof fi)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],c=o[s+1];Ee(4,a,c);try{c.call(a)}finally{Ee(5,a,c)}}else{Ee(4,i,o);try{o.call(i)}finally{Ee(5,i,o)}}}}}function F1(n,e,t){return L1(n,e.parent,t)}function L1(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[Pn];if(Mo(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===_a.None||i===_a.Emulated)return null}return kn(r,t)}function V1(n,e,t){return B1(n,e,t)}function j1(n,e,t){return n.type&40?kn(n,t):null}var B1=j1,iT;function Wl(n,e,t,r){let i=F1(n,r,e),o=e[Xe],s=r.parent||e[Kt],a=V1(s,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)nT(o,i,t[c],a,!1);else nT(o,i,t,a,!1);iT!==void 0&&iT(o,r,e,t,i)}function pa(n,e){if(e!==null){let t=e.type;if(t&3)return kn(e,n);if(t&4)return yg(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return pa(n,r);{let i=n[e.index];return Mn(i)?yg(-1,i):un(i)}}else{if(t&128)return pa(n,e.next);if(t&32)return um(e,n)()||un(n[e.index]);{let r=nb(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=di(n[an]);return pa(i,r)}else return pa(n,e.next)}}}return null}function nb(n,e){if(e!==null){let r=n[an][Kt],i=e.projection;return r.projection[i]}return null}function yg(n,e){let t=Ut+n+1;if(t<e.length){let r=e[t],i=r[he].firstChild;if(i!==null)return pa(r,i)}return e[li]}function dm(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(s&&e===0&&(a&&Oo(un(a),r),t.flags|=2),!XD(t))if(c&8)dm(n,e,t.child,r,i,o,!1),mo(e,n,i,a,o);else if(c&32){let l=um(t,r),d;for(;d=l();)mo(e,n,i,d,o);mo(e,n,i,a,o)}else c&16?U1(n,e,r,t,i,o):mo(e,n,i,a,o);t=s?t.projectionNext:t.next}}function Gl(n,e,t,r,i,o){dm(t,r,n.firstChild,e,i,o,!1)}function U1(n,e,t,r,i,o){let s=t[an],c=s[Kt].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];mo(e,n,i,d,o)}else{let l=c,d=s[pt];PD(r)&&(l.flags|=128),dm(n,e,l,d,i,o,!0)}}function $1(n,e,t,r,i){let o=t[li],s=un(t);o!==s&&mo(e,n,r,o,i);for(let a=Ut;a<t.length;a++){let c=t[a];Gl(c[he],c,n,e,r,o)}}function H1(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:bl.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=bl.Important),n.setStyle(t,r,i,o))}}function Cl(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(un(o)),Mn(o)&&q1(o,r);let s=t.type;if(s&8)Cl(n,e,t.child,r);else if(s&32){let a=um(t,e),c;for(;c=a();)r.push(c)}else if(s&16){let a=nb(e,t);if(Array.isArray(a))r.push(...a);else{let c=di(e[an]);Cl(c[he],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function q1(n,e){for(let t=Ut;t<n.length;t++){let r=n[t],i=r[he].firstChild;i!==null&&Cl(r[he],r,i,e)}n[li]!==n[Pn]&&e.push(n[li])}function rb(n){if(n[Vp]!==null){for(let e of n[Vp])e.impl.addSequence(e);n[Vp].length=0}}var ib=[];function z1(n){return n[Bt]??W1(n)}function W1(n){let e=ib.pop()??Object.create(K1);return e.lView=n,e}function G1(n){n.lView[Bt]!==n&&(n.lView=null,ib.push(n))}var K1=Je(Ze({},io),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Sa(n.lView)},consumerOnSignalRead(){this.lView[Bt]=this}});function Q1(n){let e=n[Bt]??Object.create(Y1);return e.lView=n,e}var Y1=Je(Ze({},io),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=di(n.lView);for(;e&&!ob(e[he]);)e=di(e);e&&XT(e)},consumerOnSignalRead(){this.lView[Bt]=this}});function ob(n){return n.type!==2}function sb(n){if(n[ui]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[ui])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[J]&8192)}}var Z1=100;function ab(n,e=!0,t=0){let i=n[dr].rendererFactory,o=!1;o||i.begin?.();try{J1(n,t)}catch(s){throw e&&b1(n,s),s}finally{o||i.end?.()}}function J1(n,e){let t=oD();try{ml(!0),vg(n,e);let r=0;for(;Vl(n);){if(r===Z1)throw new ie(103,!1);r++,vg(n,1)}}finally{ml(t)}}function X1(n,e,t,r){if(ko(e))return;let i=e[J],o=!1,s=!1;Gg(e);let a=!0,c=null,l=null;o||(ob(n)?(l=z1(e),c=ia(l)):ip()===null?(a=!1,l=Q1(e),c=ia(l)):e[Bt]&&(oa(e[Bt]),e[Bt]=null));try{JT(e),qk(n.bindingStartIndex),t!==null&&JD(n,e,t,2,r);let d=(i&3)===3;if(!o)if(d){let m=n.preOrderCheckHooks;m!==null&&tl(e,m,null)}else{let m=n.preOrderHooks;m!==null&&nl(e,m,0,null),jp(e,0)}if(s||eO(e),sb(e),cb(e,0),n.contentQueries!==null&&HD(n,e),!o)if(d){let m=n.contentCheckHooks;m!==null&&tl(e,m)}else{let m=n.contentHooks;m!==null&&nl(e,m,1),jp(e,1)}nO(n,e);let f=n.components;f!==null&&lb(e,f,0);let g=n.viewQuery;if(g!==null&&pg(2,g,r),!o)if(d){let m=n.viewCheckHooks;m!==null&&tl(e,m)}else{let m=n.viewHooks;m!==null&&nl(e,m,2),jp(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Lp]){for(let m of e[Lp])m();e[Lp]=null}o||(rb(e),e[J]&=-73)}catch(d){throw o||Sa(e),d}finally{l!==null&&(mu(l,c),a&&G1(l)),Kg()}}function cb(n,e){for(let t=xD(n);t!==null;t=OD(t))for(let r=Ut;r<t.length;r++){let i=t[r];ub(i,e)}}function eO(n){for(let e=xD(n);e!==null;e=OD(e)){if(!(e[J]&2))continue;let t=e[pl];for(let r=0;r<t.length;r++){let i=t[r];XT(i)}}}function tO(n,e,t){Ee(18);let r=ln(e,n);ub(r,t),Ee(19,r[It])}function ub(n,e){qg(n)&&vg(n,e)}function vg(n,e){let r=n[he],i=n[J],o=n[Bt],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&yu(o)),s||=!1,o&&(o.dirty=!1),n[J]&=-9217,s)X1(r,n,r.template,n[It]);else if(i&8192){sb(n),cb(n,1);let a=r.components;a!==null&&lb(n,a,1),rb(n)}}function lb(n,e,t){for(let r=0;r<e.length;r++)tO(n,e[r],t)}function nO(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)hi(~i);else{let o=i,s=t[++r],a=t[++r];Gk(s,o);let c=e[o];Ee(24,c),a(2,c),Ee(25,c)}}}finally{hi(-1)}}function hm(n,e){let t=oD()?64:1088;for(n[dr].changeDetectionScheduler?.notify(e);n;){n[J]|=t;let r=di(n);if(gl(n)&&!r)return n;n=r}return null}function db(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function rO(n,e,t,r=!0){let i=e[he];if(iO(i,e,n,t),r){let s=yg(t,n),a=e[Xe],c=a.parentNode(n[li]);c!==null&&M1(i,n[Kt],a,e,c,s)}let o=e[dl];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function _g(n,e){if(n.length<=Ut)return;let t=Ut+e,r=n[t];if(r){let i=r[Eo];i!==null&&i!==n&&lm(i,r),e>0&&(n[t-1][Gt]=r[Gt]);let o=cl(n,Ut+e);P1(r[he],r);let s=o[wo];s!==null&&s.detachView(o[he]),r[pt]=null,r[Gt]=null,r[J]&=-129}return r}function iO(n,e,t,r){let i=Ut+r,o=t.length;r>0&&(t[i-1][Gt]=e),r<o-Ut?(e[Gt]=t[i],kT(t,Ut+r,e)):(t.push(e),e[Gt]=null),e[pt]=t;let s=e[Eo];s!==null&&t!==s&&hb(s,e);let a=e[wo];a!==null&&a.insertView(n),rg(e),e[J]|=128}function hb(n,e){let t=n[pl],r=e[pt];if(lr(r))n[J]|=2;else{let i=r[pt][an];e[an]!==i&&(n[J]|=2)}t===null?n[pl]=[e]:t.push(e)}var Ia=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let e=this._lView,t=e[he];return Cl(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r}get context(){return this._lView[It]}set context(e){this._lView[It]=e}get destroyed(){return ko(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[pt];if(Mn(e)){let t=e[fl],r=t?t.indexOf(this):-1;r>-1&&(_g(e,r),cl(t,r))}this._attachedToViewContainer=!1}tb(this._lView[he],this._lView)}onDestroy(e){eD(this._lView,e)}markForCheck(){hm(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[J]&=-129}reattach(){rg(this._lView),this._lView[J]|=128}detectChanges(){this._lView[J]|=1024,ab(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ie(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=gl(this._lView),t=this._lView[Eo];t!==null&&!e&&lm(t,this._lView),eb(this._lView[he],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ie(902,!1);this._appRef=e;let t=gl(this._lView),r=this._lView[Eo];r!==null&&!t&&hb(r,this._lView),rg(this._lView)}};var Kl=(()=>{class n{static __NG_ELEMENT_ID__=aO}return n})(),oO=Kl,sO=class extends oO{_declarationLView;_declarationTContainer;elementRef;constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=N1(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new Ia(i)}};function aO(){return fb(Rt(),Ce())}function fb(n,e){return n.type&4?new sO(e,n,Hl(n,e)):null}function Ql(n,e,t,r,i){let o=n.data[e];if(o===null)o=cO(n,e,t,r,i),Wk()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=Uk();o.injectorIndex=s===null?-1:s.injectorIndex}return mi(o,!0),o}function cO(n,e,t,r,i){let o=rD(),s=Wg(),a=s?o:o&&o.parent,c=n.data[e]=lO(n,a,t,e,r,i);return uO(n,c,o,s),c}function uO(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function lO(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return Vk()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var Q8=new RegExp(`^(\\d+)*(${Fx}|${Ox})*(.*)`);var dO=()=>null;function oT(n,e){return dO(n,e)}var hO=class{},pb=class{},Ig=class{resolveComponentFactory(e){throw Error(`No component factory found for ${_t(e)}.`)}},Yl=class{static NULL=new Ig},Sl=class{},gb=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>fO()}return n})();function fO(){let n=Ce(),e=Rt(),t=ln(e.index,n);return(lr(t)?t:n)[Xe]}var pO=(()=>{class n{static \u0275prov=Te({token:n,providedIn:"root",factory:()=>null})}return n})();var $p={},Eg=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=Ol(r);let i=this.injector.get(e,$p,r);return i!==$p||t===$p?i:this.parentInjector.get(e,t,r)}};function wg(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=Ow(i,a);else if(o==2){let c=a,l=e[++s];r=Ow(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function wt(n,e=ne.Default){let t=Ce();if(t===null)return ft(n,e);let r=Rt();return ED(r,t,ht(n),e)}function fm(n,e,t,r,i){let o=r===null?null:{"":-1},s=i(n,t);if(s!==null){let a,c=null,l=null,d=mO(s);d===null?a=s:[a,c,l]=d,_O(n,e,t,a,o,c,l)}o!==null&&r!==null&&gO(t,r,o)}function gO(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new ie(-301,!1);r.push(e[i],o)}}function mO(n){let e=null,t=!1;for(let s=0;s<n.length;s++){let a=n[s];if(s===0&&cn(a)&&(e=a),a.findHostDirectiveDefs!==null){t=!0;break}}if(!t)return null;let r=null,i=null,o=null;for(let s of n)s.findHostDirectiveDefs!==null&&(r??=[],i??=new Map,o??=new Map,yO(s,r,o,i)),s===e&&(r??=[],r.push(s));return r!==null?(r.push(...e===null?n:n.slice(1)),[r,i,o]):null}function yO(n,e,t,r){let i=e.length;n.findHostDirectiveDefs(n,e,r),t.set(n,[i,e.length-1])}function vO(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function _O(n,e,t,r,i,o,s){let a=r.length,c=!1;for(let g=0;g<a;g++){let m=r[g];!c&&cn(m)&&(c=!0,vO(n,t,g)),ag(Il(t,e),n,m.type)}bO(t,n.data.length,a);for(let g=0;g<a;g++){let m=r[g];m.providersResolver&&m.providersResolver(m)}let l=!1,d=!1,f=YD(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let g=0;g<a;g++){let m=r[g];if(t.mergedAttrs=Do(t.mergedAttrs,m.hostAttrs),EO(n,t,e,f,m),DO(f,m,i),s!==null&&s.has(m)){let[R,P]=s.get(m);t.directiveToIndex.set(m.type,[f,R+t.directiveStart,P+t.directiveStart])}else(o===null||!o.has(m))&&t.directiveToIndex.set(m.type,f);m.contentQueries!==null&&(t.flags|=4),(m.hostBindings!==null||m.hostAttrs!==null||m.hostVars!==0)&&(t.flags|=64);let w=m.type.prototype;!l&&(w.ngOnChanges||w.ngOnInit||w.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),l=!0),!d&&(w.ngOnChanges||w.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),d=!0),f++}IO(n,t,o)}function IO(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))sT(0,e,i,r),sT(1,e,i,r),cT(e,r,!1);else{let o=t.get(i);aT(0,e,o,r),aT(1,e,o,r),cT(e,r,!0)}}}function sT(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(r),mb(e,o)}}function aT(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s=i[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(r,o),mb(e,s)}}function mb(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function cT(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:o}=n;if(r===null||!t&&i===null||t&&o===null||tm(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<r.length;){let c=r[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!t&&i.hasOwnProperty(c)){let l=i[c];for(let d of l)if(d===e){s??=[],s.push(c,r[a+1]);break}}else if(t&&o.hasOwnProperty(c)){let l=o[c];for(let d=0;d<l.length;d+=2)if(l[d]===e){s??=[],s.push(l[d+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function EO(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=ai(i.type,!0)),s=new fi(o,cn(i),wt);n.blueprint[r]=s,t[r]=s,wO(n,e,r,YD(n,t,i.hostVars,yi),i)}function wO(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;TO(s)!=a&&s.push(a),s.push(t,r,o)}}function TO(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function DO(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;cn(e)&&(t[""]=n)}}function bO(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function yb(n,e,t,r,i,o,s,a){let c=e.consts,l=To(c,s),d=Ql(e,n,2,r,l);return o&&fm(e,t,d,To(c,a),i),d.mergedAttrs=Do(d.mergedAttrs,d.attrs),d.attrs!==null&&wg(d,d.attrs,!1),d.mergedAttrs!==null&&wg(d,d.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,d),d}function vb(n,e){Qg(n,e),Hg(e)&&n.queries.elementEnd(e)}var Al=class extends Yl{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=vo(e);return new Ea(t,this.ngModule)}};function CO(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],o={propName:t,templateName:e,isSignal:(r&ql.SignalBased)!==0};return i&&(o.transform=i),o})}function SO(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function AO(n,e,t){let r=e instanceof sn?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new Eg(t,r):t}function NO(n){let e=n.get(Sl,null);if(e===null)throw new ie(407,!1);let t=n.get(pO,null),r=n.get(pi,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r}}function RO(n,e){let t=(n.selectors[0][0]||"div").toLowerCase();return WD(e,t,t==="svg"?Nk:t==="math"?Rk:null)}var Ea=class extends pb{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=CO(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=SO(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=i1(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i){Ee(22);let o=ce(null);try{let s=this.componentDef,a=r?["ng-version","19.2.14"]:o1(this.componentDef.selectors[0]),c=nm(0,null,null,1,0,null,null,null,null,[a],null),l=AO(s,i||this.ngModule,e),d=NO(l),f=d.rendererFactory.createRenderer(null,s),g=r?g1(f,r,s.encapsulation,l):RO(s,f),m=rm(null,c,null,512|QD(s),null,null,d,f,l,null,$D(g,l,!0));m[St]=g,Gg(m);let w=null;try{let R=yb(St,c,m,"#host",()=>[this.componentDef],!0,0);g&&(KD(f,g,R),Oo(g,m)),zl(c,m,R),em(c,R,m),vb(c,R),t!==void 0&&PO(R,this.ngContentSelectors,t),w=ln(R.index,m),m[It]=w[It],cm(c,m,null)}catch(R){throw w!==null&&hg(w),hg(m),R}finally{Ee(23),Kg()}return new Tg(this.componentType,m)}finally{ce(o)}}},Tg=class extends hO{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t){super(),this._rootLView=t,this._tNode=YT(t[he],St),this.location=Hl(this._tNode,t),this.instance=ln(this._tNode.index,t)[It],this.hostView=this.changeDetectorRef=new Ia(t,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,o=am(r,i[he],i,e,t);this.previousInputValues.set(e,t);let s=ln(r.index,i);hm(s,1)}get injector(){return new si(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function PO(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null&&o.length?Array.from(o):null)}}var Zl=(()=>{class n{static __NG_ELEMENT_ID__=MO}return n})();function MO(){let n=Rt();return xO(n,Ce())}var kO=Zl,_b=class extends kO{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Hl(this._hostTNode,this._hostLView)}get injector(){return new si(this._hostTNode,this._hostLView)}get parentInjector(){let e=Yg(this._hostTNode,this._hostLView);if(gD(e)){let t=vl(e,this._hostLView),r=yl(e),i=t[he].data[r+8];return new si(i,t)}else return new si(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=uT(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Ut}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=oT(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,rT(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!Dk(e),a;if(s)a=t;else{let w=t||{};a=w.index,r=w.injector,i=w.projectableNodes,o=w.environmentInjector||w.ngModuleRef}let c=s?e:new Ea(vo(e)),l=r||this.parentInjector;if(!o&&c.ngModule==null){let R=(s?l:this.parentInjector).get(sn,null);R&&(o=R)}let d=vo(c.componentType??{}),f=oT(this._lContainer,d?.id??null),g=f?.firstChild??null,m=c.create(l,i,g,o);return this.insertImpl(m.hostView,a,rT(this._hostTNode,f)),m}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(Mk(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[pt],l=new _b(c,c[Kt],c[pt]);l.detach(l.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return rO(s,i,o,r),e.attachToViewContainerRef(),kT(Hp(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=uT(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=_g(this._lContainer,t);r&&(cl(Hp(this._lContainer),t),tb(r[he],r))}detach(e){let t=this._adjustIndex(e,-1),r=_g(this._lContainer,t);return r&&cl(Hp(this._lContainer),t)!=null?new Ia(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function uT(n){return n[fl]}function Hp(n){return n[fl]||(n[fl]=[])}function xO(n,e){let t,r=e[n.index];return Mn(r)?t=r:(t=db(r,e,null,n),e[n.index]=t,im(e,t)),FO(t,e,n,r),new _b(t,n,e)}function OO(n,e){let t=n[Xe],r=t.createComment(""),i=kn(e,n),o=t.parentNode(i);return Dl(t,o,r,t.nextSibling(i),!1),r}var FO=jO,LO=()=>!1;function VO(n,e,t){return LO(n,e,t)}function jO(n,e,t,r){if(n[li])return;let i;t.type&8?i=un(r):i=OO(e,t),n[li]=i}var Co=class{},BO=class{};var Dg=class extends Co{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Al(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let o=FT(e);this._bootstrapComponents=qD(o.bootstrap),this._r3Injector=DD(e,t,[{provide:Co,useValue:this},{provide:Yl,useValue:this.componentFactoryResolver},...r],_t(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},bg=class extends BO{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new Dg(this.moduleType,e,[])}};var Nl=class extends Co{injector;componentFactoryResolver=new Al(this);instance=null;constructor(e){super();let t=new ma([...e.providers,{provide:Co,useValue:this},{provide:Yl,useValue:this.componentFactoryResolver}],e.parent||Ug(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function UO(n,e,t=null){return new Nl({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var $O=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=LT(!1,t.type),i=r.length>0?UO([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Te({token:n,providedIn:"environment",factory:()=>new n(ft(sn))})}return n})();function n5(n){return ba(()=>{let e=Eb(n),t=Je(Ze({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===MD.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get($O).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||_a.Emulated,styles:n.styles||jt,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Vx("NgStandalone"),wb(t);let r=n.dependencies;return t.directiveDefs=lT(r,!1),t.pipeDefs=lT(r,!0),t.id=GO(t),t})}function HO(n){return vo(n)||hk(n)}function qO(n){return n!==null}function Jl(n){return ba(()=>({type:n.type,bootstrap:n.bootstrap||jt,declarations:n.declarations||jt,imports:n.imports||jt,exports:n.exports||jt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function zO(n,e){if(n==null)return ci;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a,c;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o,c=i[3]||null):(o=i,s=i,a=ql.None,c=null),t[o]=[r,a,c],e[o]=s}return t}function WO(n){if(n==null)return ci;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Xl(n){return ba(()=>{let e=Eb(n);return wb(e),e})}function Ib(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function Eb(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||ci,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||jt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:zO(n.inputs,e),outputs:WO(n.outputs),debugInfo:null}}function wb(n){n.features?.forEach(e=>e(n))}function lT(n,e){if(!n)return null;let t=e?fk:HO;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(qO)}function GO(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function KO(n){return Object.getPrototypeOf(n.prototype).constructor}function QO(n){let e=KO(n.type),t=!0,r=[n];for(;e;){let i;if(cn(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ie(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let s=n;s.inputs=qp(n.inputs),s.declaredInputs=qp(n.declaredInputs),s.outputs=qp(n.outputs);let a=i.hostBindings;a&&eF(n,a);let c=i.viewQuery,l=i.contentQueries;if(c&&JO(n,c),l&&XO(n,l),YO(n,i),zM(n.outputs,i.outputs),cn(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===QO&&(t=!1)}}e=Object.getPrototypeOf(e)}ZO(r)}function YO(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t])}}function ZO(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Do(i.hostAttrs,t=Do(t,i.hostAttrs))}}function qp(n){return n===ci?{}:n===jt?[]:n}function JO(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function XO(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,o)=>{e(r,i,o),t(r,i,o)}:n.contentQueries=e}function eF(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function Tb(n){return nF(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function tF(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function nF(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function rF(n,e,t){return n[e]=t}function So(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function iF(n,e,t,r){let i=So(n,e,t);return So(n,e+1,r)||i}function oF(n,e,t,r,i){let o=iF(n,e,t,r);return So(n,e+2,i)||o}function sF(n,e,t,r,i,o,s,a,c){let l=e.consts,d=Ql(e,n,4,s||null,a||null);zg()&&fm(e,t,d,To(l,c),sm),d.mergedAttrs=Do(d.mergedAttrs,d.attrs),Qg(e,d);let f=d.tView=nm(2,d,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}function aF(n,e,t,r,i,o,s,a,c,l){let d=t+St,f=e.firstCreatePass?sF(d,e,n,r,i,o,s,a,c):e.data[d];mi(f,!1);let g=uF(e,n,f,t);jl()&&Wl(e,n,g,f),Oo(g,n);let m=db(g,n,g,f);return n[d]=m,im(n,m),VO(m,f,n),Ll(f)&&zl(e,n,f),c!=null&&om(n,f,l),f}function cF(n,e,t,r,i,o,s,a){let c=Ce(),l=Nt(),d=To(l.consts,o);return aF(c,l,n,e,t,r,i,d,s,a),cF}var uF=lF;function lF(n,e,t,r){return Bl(!0),e[Xe].createComment("")}var r5=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var dF=new oe("");var Db=(()=>{class n{static \u0275prov=Te({token:n,providedIn:"root",factory:()=>new Cg})}return n})(),Cg=class{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),this.queuedEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}};function pm(n){return!!n&&typeof n.then=="function"}function bb(n){return!!n&&typeof n.subscribe=="function"}var hF=new oe("");var Cb=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=Q(hF,{optional:!0})??[];injector=Q(Et);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=Ro(this.injector,i);if(pm(o))t.push(o);else if(bb(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),fF=new oe("");function pF(){up(()=>{throw new ie(600,!1)})}function gF(n){return n.isBoundToModule}var mF=10;var wa=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=Q(Dx);afterRenderManager=Q(Bx);zonelessEnabled=Q(CD);rootEffectScheduler=Q(Db);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new Rn;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=Q(Aa).hasPendingTasks.pipe(dt(t=>!t));constructor(){Q(BD,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=Q(sn);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=Et.NULL){Ee(10);let o=t instanceof pb;if(!this._injector.get(Cb).done){let m="";throw new ie(405,m)}let a;o?a=t:a=this._injector.get(Yl).resolveComponentFactory(t),this.componentTypes.push(a.componentType);let c=gF(a)?void 0:this._injector.get(Co),l=r||a.selector,d=a.create(i,[],l,c),f=d.location.nativeElement,g=d.injector.get(dF,null);return g?.registerApplication(f),d.onDestroy(()=>{this.detachView(d.hostView),rl(this.components,d),g?.unregisterApplication(f)}),this._loadComponent(d),Ee(11,d),d}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){Ee(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(jD.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new ie(101,!1);let t=ce(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,ce(t),this.afterTick.next(),Ee(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Sl,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<mF;)Ee(14),this.synchronizeOnce(),Ee(15)}synchronizeOnce(){if(this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let t=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:i}of this.allViews)yF(r,i,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Vl(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;rl(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(fF,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>rl(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ie(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function rl(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function yF(n,e,t,r){if(!t&&!Vl(n))return;ab(n,e,t&&!r?0:1)}function vF(n,e,t,r){return So(n,sD(),t)?e+AT(t)+r:yi}function Xu(n,e){return n<<17|e<<2}function gi(n){return n>>17&32767}function _F(n){return(n&2)==2}function IF(n,e){return n&131071|e<<17}function Sg(n){return n|2}function Ao(n){return(n&131068)>>2}function zp(n,e){return n&-131069|e<<2}function EF(n){return(n&1)===1}function Ag(n){return n|1}function wF(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,a=gi(s),c=Ao(s);n[r]=t;let l=!1,d;if(Array.isArray(t)){let f=t;d=f[1],(d===null||Ca(f,d)>0)&&(l=!0)}else d=t;if(i)if(c!==0){let g=gi(n[a+1]);n[r+1]=Xu(g,a),g!==0&&(n[g+1]=zp(n[g+1],r)),n[a+1]=IF(n[a+1],r)}else n[r+1]=Xu(a,0),a!==0&&(n[a+1]=zp(n[a+1],r)),a=r;else n[r+1]=Xu(c,0),a===0?a=r:n[c+1]=zp(n[c+1],r),c=r;l&&(n[r+1]=Sg(n[r+1])),dT(n,d,r,!0),dT(n,d,r,!1),TF(e,d,n,r,o),s=Xu(a,c),o?e.classBindings=s:e.styleBindings=s}function TF(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Ca(o,e)>=0&&(t[r+1]=Ag(t[r+1]))}function dT(n,e,t,r){let i=n[t+1],o=e===null,s=r?gi(i):Ao(i),a=!1;for(;s!==0&&(a===!1||o);){let c=n[s],l=n[s+1];DF(c,e)&&(a=!0,n[s+1]=r?Ag(l):Sg(l)),s=r?gi(l):Ao(l)}a&&(n[t+1]=r?Sg(i):Ag(i))}function DF(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Ca(n,e)>=0:!1}function bF(n,e,t){let r=Ce(),i=sD();if(So(r,i,e)){let o=Nt(),s=Jk();_1(o,s,r,n,e,r[Xe],t,!1)}return bF}function hT(n,e,t,r,i){am(e,n,t,i?"class":"style",r)}function CF(n,e,t){return Sb(n,e,t,!1),CF}function SF(n,e){return Sb(n,e,null,!0),SF}function Sb(n,e,t,r){let i=Ce(),o=Nt(),s=zk(2);if(o.firstUpdatePass&&NF(o,n,s,r),e!==yi&&So(i,s,e)){let a=o.data[xo()];xF(o,a,i,i[Xe],n,i[s+1]=OF(e,t),r,s)}}function AF(n,e){return e>=n.expandoStartIndex}function NF(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[xo()],s=AF(n,t);FF(o,r)&&e===null&&!s&&(e=!1),e=RF(i,o,e,r),wF(i,o,e,t,s,r)}}function RF(n,e,t,r){let i=Qk(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=Wp(null,n,e,t,r),t=Ta(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=Wp(i,n,e,t,r),o===null){let c=PF(n,e,r);c!==void 0&&Array.isArray(c)&&(c=Wp(null,n,e,c[1],r),c=Ta(c,e.attrs,r),MF(n,e,r,c))}else o=kF(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function PF(n,e,t){let r=t?e.classBindings:e.styleBindings;if(Ao(r)!==0)return n[gi(r)]}function MF(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[gi(i)]=r}function kF(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=Ta(r,s,t)}return Ta(r,e.attrs,t)}function Wp(n,e,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],r=Ta(r,o.hostAttrs,i),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function Ta(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),lk(n,s,t?!0:e[++o]))}return n===void 0?null:n}function xF(n,e,t,r,i,o,s,a){if(!(e.type&3))return;let c=n.data,l=c[a+1],d=EF(l)?fT(c,e,t,i,Ao(l),s):void 0;if(!Rl(d)){Rl(o)||_F(l)&&(o=fT(c,null,t,i,a,s));let f=QT(xo(),t);H1(r,s,f,i,o)}}function fT(n,e,t,r,i,o){let s=e===null,a;for(;i>0;){let c=n[i],l=Array.isArray(c),d=l?c[1]:c,f=d===null,g=t[i+1];g===yi&&(g=f?jt:void 0);let m=f?Op(g,r):d===r?g:void 0;if(l&&!Rl(m)&&(m=Op(c,r)),Rl(m)&&(a=m,s))return a;let w=n[i+1];i=s?gi(w):Ao(w)}if(e!==null){let c=o?e.residualClasses:e.residualStyles;c!=null&&(a=Op(c,r))}return a}function Rl(n){return n!==void 0}function OF(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=_t(qx(n)))),n}function FF(n,e){return(n.flags&(e?8:16))!==0}function Ab(n,e,t,r){let i=Ce(),o=Nt(),s=St+n,a=i[Xe],c=o.firstCreatePass?yb(s,o,i,e,sm,zg(),t,r):o.data[s],l=VF(o,i,c,a,e,n);i[s]=l;let d=Ll(c);return mi(c,!0),KD(a,l,c),!XD(c)&&jl()&&Wl(o,i,l,c),(Ok()===0||d)&&Oo(l,i),Fk(),d&&(zl(o,i,c),em(o,c,i)),r!==null&&om(i,c),Ab}function Nb(){let n=Rt();Wg()?iD():(n=n.parent,mi(n,!1));let e=n;jk(e)&&Bk(),Lk();let t=Nt();return t.firstCreatePass&&vb(t,e),e.classesWithoutHost!=null&&nx(e)&&hT(t,e,Ce(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&rx(e)&&hT(t,e,Ce(),e.stylesWithoutHost,!1),Nb}function LF(n,e,t,r){return Ab(n,e,t,r),Nb(),LF}var VF=(n,e,t,r,i,o)=>(Bl(!0),WD(r,i,Xk()));function jF(n,e,t,r,i){let o=e.consts,s=To(o,r),a=Ql(e,n,8,"ng-container",s);s!==null&&wg(a,s,!0);let c=To(o,i);return zg()&&fm(e,t,a,c,sm),a.mergedAttrs=Do(a.mergedAttrs,a.attrs),e.queries!==null&&e.queries.elementStart(e,a),a}function BF(n,e,t){let r=Ce(),i=Nt(),o=n+St,s=i.firstCreatePass?jF(o,i,r,e,t):i.data[o];mi(s,!0);let a=$F(i,r,s,n);return r[o]=a,jl()&&Wl(i,r,a,s),Oo(a,r),Ll(s)&&(zl(i,r,s),em(i,s,r)),t!=null&&om(r,s),BF}function UF(){let n=Rt(),e=Nt();return Wg()?iD():(n=n.parent,mi(n,!1)),e.firstCreatePass&&(Qg(e,n),Hg(n)&&e.queries.elementEnd(n)),UF}var $F=(n,e,t,r)=>(Bl(!0),c1(e[Xe],""));function i5(){return Ce()}var ii=void 0;function HF(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var qF=["en",[["a","p"],["AM","PM"],ii],[["AM","PM"],ii,ii],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ii,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ii,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ii,"{1} 'at' {0}",ii],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",HF],Gp={};function ed(n){let e=zF(n),t=pT(e);if(t)return t;let r=e.split("-")[0];if(t=pT(r),t)return t;if(r==="en")return qF;throw new ie(701,!1)}function pT(n){return n in Gp||(Gp[n]=Ju.ng&&Ju.ng.common&&Ju.ng.common.locales&&Ju.ng.common.locales[n]),Gp[n]}var vi=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(vi||{});function zF(n){return n.toLowerCase().replace(/_/g,"-")}var Pl="en-US",WF="USD";var GF=Pl;function KF(n){typeof n=="string"&&(GF=n.toLowerCase().replace(/_/g,"-"))}function gT(n,e,t){return function r(i){if(i===Function)return t;let o=Mo(n)?ln(n.index,e):e;hm(o,5);let s=e[It],a=mT(e,s,t,i),c=r.__ngNextListenerFn__;for(;c;)a=mT(e,s,c,i)&&a,c=c.__ngNextListenerFn__;return a}}function mT(n,e,t,r){let i=ce(null);try{return Ee(6,e,t),t(r)!==!1}catch(o){return QF(n,o),!1}finally{Ee(7,e,t),ce(i)}}function QF(n,e){let t=n[Io],r=t?t.get(bo,null):null;r&&r.handleError(e)}function yT(n,e,t,r,i,o){let s=e[t],a=e[he],l=a.data[t].outputs[r],d=s[l],f=a.firstCreatePass?nD(a):null,g=tD(e),m=d.subscribe(o),w=g.length;g.push(o,m),f&&f.push(i,n.index,w,-(w+1))}function YF(n,e,t,r){let i=Ce(),o=Nt(),s=Rt();return JF(o,i,i[Xe],s,n,e,r),YF}function ZF(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[hl],c=i[o+2];return a.length>c?a[c]:null}typeof s=="string"&&(o+=2)}return null}function JF(n,e,t,r,i,o,s){let a=Ll(r),l=n.firstCreatePass?nD(n):null,d=tD(e),f=!0;if(r.type&3||s){let g=kn(r,e),m=s?s(g):g,w=d.length,R=s?O=>s(un(O[r.index])):r.index,P=null;if(!s&&a&&(P=ZF(n,e,i,r.index)),P!==null){let O=P.__ngLastListenerFn__||P;O.__ngNextListenerFn__=o,P.__ngLastListenerFn__=o,f=!1}else{o=gT(r,e,o),$x(e,m,i,o);let O=t.listen(m,i,o);d.push(o,O),l&&l.push(i,R,w,w+1)}}else o=gT(r,e,o);if(f){let g=r.outputs?.[i],m=r.hostDirectiveOutputs?.[i];if(m&&m.length)for(let w=0;w<m.length;w+=2){let R=m[w],P=m[w+1];yT(r,e,R,P,i,o)}if(g&&g.length)for(let w of g)yT(r,e,w,i,i,o)}}function o5(n=1){return Zk(n)}function s5(n){let e=$k();return ZT(e,St+n)}function a5(n,e=""){let t=Ce(),r=Nt(),i=n+St,o=r.firstCreatePass?Ql(r,i,1,e,null):r.data[i],s=XF(r,t,o,e,n);t[i]=s,jl()&&Wl(r,t,s,o),mi(o,!1)}var XF=(n,e,t,r,i)=>(Bl(!0),s1(e[Xe],r));function eL(n){return Rb("",n,""),eL}function Rb(n,e,t){let r=Ce(),i=vF(r,n,e,t);return i!==yi&&tL(r,xo(),i),Rb}function tL(n,e,t){let r=QT(e,n);a1(n[Xe],r,t)}function nL(n,e,t){let r=Nt();if(r.firstCreatePass){let i=cn(n);Ng(t,r.data,r.blueprint,i,!0),Ng(e,r.data,r.blueprint,i,!1)}}function Ng(n,e,t,r,i){if(n=ht(n),Array.isArray(n))for(let o=0;o<n.length;o++)Ng(n[o],e,t,r,i);else{let o=Nt(),s=Ce(),a=Rt(),c=_o(n)?n:ht(n.provide),l=UT(n),d=a.providerIndexes&1048575,f=a.directiveStart,g=a.providerIndexes>>20;if(_o(n)||!n.multi){let m=new fi(l,i,wt),w=Qp(c,e,i?d:d+g,f);w===-1?(ag(Il(a,s),o,c),Kp(o,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(m),s.push(m)):(t[w]=m,s[w]=m)}else{let m=Qp(c,e,d+g,f),w=Qp(c,e,d,d+g),R=m>=0&&t[m],P=w>=0&&t[w];if(i&&!P||!i&&!R){ag(Il(a,s),o,c);let O=oL(i?iL:rL,t.length,i,r,l);!i&&P&&(t[w].providerFactory=O),Kp(o,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(O),s.push(O)}else{let O=Pb(t[i?w:m],l,!i&&r);Kp(o,n,m>-1?m:w,O)}!i&&r&&P&&t[w].componentProviders++}}}function Kp(n,e,t,r){let i=_o(e),o=vk(e);if(i||o){let c=(o?ht(e.useClass):e).prototype.ngOnDestroy;if(c){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=l.indexOf(t);d===-1?l.push(t,[r,c]):l[d+1].push(r,c)}else l.push(t,c)}}}function Pb(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Qp(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function rL(n,e,t,r,i){return Rg(this.multi,[])}function iL(n,e,t,r,i){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,c=El(r,r[he],this.providerFactory.index,i);s=c.slice(0,a),Rg(o,s);for(let l=a;l<c.length;l++)s.push(c[l])}else s=[],Rg(o,s);return s}function Rg(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function oL(n,e,t,r,i){let o=new fi(n,t,wt);return o.multi=[],o.index=e,o.componentProviders=0,Pb(o,i,r&&!t),o}function c5(n,e=[]){return t=>{t.providersResolver=(r,i)=>nL(r,i?i(n):n,e)}}function sL(n,e){let t=n[e];return t===yi?void 0:t}function aL(n,e,t,r,i,o,s,a){let c=e+t;return oF(n,c,i,o,s)?rF(n,c+3,a?r.call(a,i,o,s):r(i,o,s)):sL(n,c+3)}function u5(n,e){let t=Nt(),r,i=n+St;t.firstCreatePass?(r=cL(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let o=r.factory||(r.factory=ai(r.type,!0)),s,a=vt(wt);try{let c=_l(!1),l=o();return _l(c),Pk(t,Ce(),i,l),l}finally{vt(a)}}function cL(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function l5(n,e,t,r,i){let o=n+St,s=Ce(),a=ZT(s,o);return uL(s,o)?aL(s,Hk(),e,a.transform,t,r,i,a):a.transform(t,r,i)}function uL(n,e){return n[he].data[e].pure}function d5(n,e){return fb(n,e)}var Da=class{full;major;minor;patch;constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},Mb=new Da("19.2.14"),Pg=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},h5=(()=>{class n{compileModuleSync(t){return new bg(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=FT(t),o=qD(i.declarations).reduce((s,a)=>{let c=vo(a);return c&&s.push(new Ea(c)),s},[]);return new Pg(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var lL=(()=>{class n{zone=Q(xe);changeDetectionScheduler=Q(pi);applicationRef=Q(wa);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function dL({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new xe(Je(Ze({},hL()),{scheduleInRootZone:t})),[{provide:xe,useFactory:n},{provide:ul,multi:!0,useFactory:()=>{let r=Q(lL,{optional:!0});return()=>r.initialize()}},{provide:ul,multi:!0,useFactory:()=>{let r=Q(fL);return()=>{r.initialize()}}},e===!0?{provide:SD,useValue:!0}:[],{provide:AD,useValue:t??bD}]}function hL(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var fL=(()=>{class n{subscription=new je;initialized=!1;zone=Q(xe);pendingTasks=Q(Aa);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{xe.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{xe.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var pL=(()=>{class n{appRef=Q(wa);taskService=Q(Aa);ngZone=Q(xe);zonelessEnabled=Q(CD);tracing=Q(BD,{optional:!0});disableScheduling=Q(SD,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new je;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Tl):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(Q(AD,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof dg||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let r=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{this.appRef.dirtyFlags|=16,r=!0;break}case 13:{this.appRef.dirtyFlags|=2,r=!0;break}case 11:{r=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?Qw:ND;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Tl+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,Qw(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function gL(){return typeof $localize<"u"&&$localize.locale||Pl}var td=new oe("",{providedIn:"root",factory:()=>Q(td,ne.Optional|ne.SkipSelf)||gL()}),kb=new oe("",{providedIn:"root",factory:()=>WF});var Mg=new oe(""),mL=new oe("");function ha(n){return!n.moduleRef}function yL(n){let e=ha(n)?n.r3Injector:n.moduleRef.injector,t=e.get(xe);return t.run(()=>{ha(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(bo,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),ha(n)){let o=()=>e.destroy(),s=n.platformInjector.get(Mg);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(Mg);s.add(o),n.moduleRef.onDestroy(()=>{rl(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return _L(r,t,()=>{let o=e.get(Cb);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(td,Pl);if(KF(s||Pl),!e.get(mL,!0))return ha(n)?e.get(wa):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(ha(n)){let c=e.get(wa);return n.rootComponent!==void 0&&c.bootstrap(n.rootComponent),c}else return vL(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function vL(n,e){let t=n.injector.get(wa);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new ie(-403,!1);e.push(n)}function _L(n,e,t){try{let r=t();return pm(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var il=null;function IL(n=[],e){return Et.create({name:e,providers:[{provide:BT,useValue:"platform"},{provide:Mg,useValue:new Set([()=>il=null])},...n]})}function EL(n=[]){if(il)return il;let e=IL(n);return il=e,pF(),wL(e),e}function wL(n){let e=n.get(xx,null);Ro(n,()=>{e?.forEach(t=>t())})}function gm(){return!1}var TL=(()=>{class n{static __NG_ELEMENT_ID__=DL}return n})();function DL(n){return bL(Rt(),Ce(),(n&16)===16)}function bL(n,e,t){if(Mo(n)&&!t){let r=ln(n.index,e);return new Ia(r,r)}else if(n.type&175){let r=e[an];return new Ia(r,e)}return null}var kg=class{constructor(){}supports(e){return Tb(e)}create(e){return new xg(e)}},CL=(n,e)=>e,xg=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||CL}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<vT(r,i,o)?t:r,a=vT(s,i,o),c=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let l=a-i,d=c-i;if(l!=d){for(let g=0;g<l;g++){let m=g<o.length?o[g]:o[g]=0,w=m+g;d<=w&&w<l&&(o[g]=m+1)}let f=s.previousIndex;o[f]=d-l}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!Tb(e))throw new ie(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,tF(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new Og(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Ml),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Ml),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Og=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},Fg=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Ml=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Fg,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function vT(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function _T(){return new mm([new kg])}var mm=(()=>{class n{factories;static \u0275prov=Te({token:n,providedIn:"root",factory:_T});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||_T()),deps:[[n,new ck,new At]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new ie(901,!1)}}return n})();function f5(n){Ee(8);try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=EL(r),o=[dL({}),{provide:pi,useExisting:pL},...t||[]],s=new Nl({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return yL({r3Injector:s.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}finally{Ee(9)}}function p5(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function xb(n){return hp(n)}function SL(n,e){return cp(n,e?.equal)}var Lg=class{[qt];constructor(e){this[qt]=e}destroy(){this[qt].destroy()}};function Ob(n,e){!e?.injector&&$g(Ob);let t=e?.injector??Q(Et),r=e?.manualCleanup!==!0?t.get(Ul):null,i,o=t.get(UD,null,{optional:!0}),s=t.get(pi);return o!==null&&!e?.forceRoot?(i=RL(o.view,s,n),r instanceof wl&&r._lView===o.view&&(r=null)):i=PL(n,t.get(Db),s),i.injector=t,r!==null&&(i.onDestroyFn=r.onDestroy(()=>i.destroy())),new Lg(i)}var Fb=Je(Ze({},io),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,hasRun:!1,cleanupFns:void 0,zone:null,kind:"effect",onDestroyFn:va,run(){if(this.dirty=!1,this.hasRun&&!yu(this))return;this.hasRun=!0;let n=r=>(this.cleanupFns??=[]).push(r),e=ia(this),t=ml(!1);try{this.maybeCleanup(),this.fn(n)}finally{ml(t),mu(this,e)}},maybeCleanup(){if(this.cleanupFns?.length)try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[]}}}),AL=Je(Ze({},Fb),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){oa(this),this.onDestroyFn(),this.maybeCleanup(),this.scheduler.remove(this)}}),NL=Je(Ze({},Fb),{consumerMarkedDirty(){this.view[J]|=8192,Sa(this.view),this.notifier.notify(13)},destroy(){oa(this),this.onDestroyFn(),this.maybeCleanup(),this.view[ui]?.delete(this)}});function RL(n,e,t){let r=Object.create(NL);return r.view=n,r.zone=typeof Zone<"u"?Zone.current:null,r.notifier=e,r.fn=t,n[ui]??=new Set,n[ui].add(r),r.consumerMarkedDirty(r),r}function PL(n,e,t){let r=Object.create(AL);return r.fn=n,r.scheduler=e,r.notifier=t,r.zone=typeof Zone<"u"?Zone.current:null,r.scheduler.schedule(r),r.notifier.notify(12),r}var Lb=()=>{};var Bb=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},ML=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],s=n[t++],a=n[t++],c=((i&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let o=n[t++],s=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},rd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],s=i+1<n.length,a=s?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,d=o>>2,f=(o&3)<<4|a>>4,g=(a&15)<<2|l>>6,m=l&63;c||(m=64,s||(g=64)),r.push(t[d],t[f],t[g],t[m])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Bb(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):ML(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let f=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||a==null||l==null||f==null)throw new vm;let g=o<<2|a>>4;if(r.push(g),l!==64){let m=a<<4&240|l>>2;if(r.push(m),f!==64){let w=l<<6&192|f;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},vm=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},kL=function(n){let e=Bb(n);return rd.encodeByteArray(e,!0)},Ra=function(n){return kL(n).replace(/\./g,"")},id=function(n){try{return rd.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function od(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var xL=()=>od().__FIREBASE_DEFAULTS__,OL=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},FL=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&id(n[1]);return e&&JSON.parse(e)},sd=()=>{try{return Lb()||xL()||OL()||FL()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Im=n=>{var e,t;return(t=(e=sd())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Ub=n=>{let e=Im(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Em=()=>{var n;return(n=sd())===null||n===void 0?void 0:n.config},wm=n=>{var e;return(e=sd())===null||e===void 0?void 0:e[`_${n}`]};var _i=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function xn(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}function Pa(n){return v(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function $b(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Ra(JSON.stringify(t)),Ra(JSON.stringify(s)),""].join(".")}var Na={};function LL(){let n={prod:[],emulator:[]};for(let e of Object.keys(Na))Na[e]?n.emulator.push(e):n.prod.push(e);return n}function VL(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var Vb=!1;function ad(n,e){if(typeof window>"u"||typeof document>"u"||!xn(window.location.host)||Na[n]===e||Na[n]||Vb)return;Na[n]=e;function t(g){return`__firebase__banner__${g}`}let r="__firebase__banner",o=LL().prod.length>0;function s(){let g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,m){g.setAttribute("width","24"),g.setAttribute("id",m),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function l(){let g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Vb=!0,s()},g}function d(g,m){g.setAttribute("id",m),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function f(){let g=VL(r),m=t("text"),w=document.getElementById(m)||document.createElement("span"),R=t("learnmore"),P=document.getElementById(R)||document.createElement("a"),O=t("preprendIcon"),B=document.getElementById(O)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){let U=g.element;a(U),d(P,R);let W=l();c(B,O),U.append(B,w,P,W),document.body.appendChild(U)}o?(w.innerText="Preview backend disconnected.",B.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(B.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function Oe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Hb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Oe())}function qb(){var n;let e=(n=sd())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function zb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Wb(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Gb(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Kb(){let n=Oe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Tm(){return!qb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Dm(){return!qb()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Fo(){try{return typeof indexedDB=="object"}catch{return!1}}function Qb(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var jL="FirebaseError",Pt=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=jL,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qt.prototype.create)}},Qt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?BL(o,r):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new Pt(i,a,r)}};function BL(n,e){return n.replace(UL,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var UL=/\{\$([^}]+)}/g;function Yb(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Tt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],s=e[i];if(jb(o)&&jb(s)){if(!Tt(o,s))return!1}else if(o!==s)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function jb(n){return n!==null&&typeof n=="object"}function Lo(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Zb(n,e){let t=new _m(n,e);return t.subscribe.bind(t)}var _m=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");$L(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=ym),i.error===void 0&&(i.error=ym),i.complete===void 0&&(i.complete=ym);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function $L(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ym(){}var v5=4*60*60*1e3;function ge(n){return n&&n._delegate?n._delegate:n}var gt=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Ii="[DEFAULT]";var bm=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new _i;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qL(e))try{this.getOrInitializeService({instanceIdentifier:Ii})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Ii){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return v(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Ii){return this.instances.has(e)}getOptions(e=Ii){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(o);r===a&&s.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let s=this.instances.get(i);return s&&e(s,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:HL(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ii){return this.component?this.component.multipleInstances?e:Ii:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function HL(n){return n===Ii?void 0:n}function qL(n){return n.instantiationMode==="EAGER"}var cd=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new bm(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var zL=[],se=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(se||{}),WL={debug:se.DEBUG,verbose:se.VERBOSE,info:se.INFO,warn:se.WARN,error:se.ERROR,silent:se.SILENT},GL=se.INFO,KL={[se.DEBUG]:"log",[se.VERBOSE]:"log",[se.INFO]:"info",[se.WARN]:"warn",[se.ERROR]:"error"},QL=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=KL[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},dn=class{constructor(e){this.name=e,this._logLevel=GL,this._logHandler=QL,this._userLogHandler=null,zL.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in se))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?WL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,se.DEBUG,...e),this._logHandler(this,se.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,se.VERBOSE,...e),this._logHandler(this,se.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,se.INFO,...e),this._logHandler(this,se.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,se.WARN,...e),this._logHandler(this,se.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,se.ERROR,...e),this._logHandler(this,se.ERROR,...e)}};var YL=(n,e)=>e.some(t=>n instanceof t),Jb,Xb;function ZL(){return Jb||(Jb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JL(){return Xb||(Xb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var eC=new WeakMap,Sm=new WeakMap,tC=new WeakMap,Cm=new WeakMap,Nm=new WeakMap;function XL(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(hn(n.result)),i()},s=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&eC.set(t,n)}).catch(()=>{}),Nm.set(e,n),e}function eV(n){if(Sm.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});Sm.set(n,e)}var Am={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Sm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||tC.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return hn(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function nC(n){Am=n(Am)}function tV(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(ud(this),e,...t);return tC.set(r,e.sort?e.sort():[e]),hn(r)}:JL().includes(n)?function(...e){return n.apply(ud(this),e),hn(eC.get(this))}:function(...e){return hn(n.apply(ud(this),e))}}function nV(n){return typeof n=="function"?tV(n):(n instanceof IDBTransaction&&eV(n),YL(n,ZL())?new Proxy(n,Am):n)}function hn(n){if(n instanceof IDBRequest)return XL(n);if(Cm.has(n))return Cm.get(n);let e=nV(n);return e!==n&&(Cm.set(n,e),Nm.set(e,n)),e}var ud=n=>Nm.get(n);function iC(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let s=indexedDB.open(n,e),a=hn(s);return r&&s.addEventListener("upgradeneeded",c=>{r(hn(s.result),c.oldVersion,c.newVersion,hn(s.transaction),c)}),t&&s.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var rV=["get","getKey","getAll","getAllKeys","count"],iV=["put","add","delete","clear"],Rm=new Map;function rC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Rm.get(e))return Rm.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=iV.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||rV.includes(t)))return;let o=function(s,...a){return v(this,null,function*(){let c=this.transaction(s,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&c.done]))[0]})};return Rm.set(e,o),o}nC(n=>Je(Ze({},n),{get:(e,t,r)=>rC(e,t)||n.get(e,t,r),has:(e,t)=>!!rC(e,t)||n.has(e,t)}));var Mm=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(oV(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function oV(n){let e=n.getComponent();return e?.type==="VERSION"}var km="@firebase/app",oC="0.13.2";var On=new dn("@firebase/app"),sV="@firebase/app-compat",aV="@firebase/analytics-compat",cV="@firebase/analytics",uV="@firebase/app-check-compat",lV="@firebase/app-check",dV="@firebase/auth",hV="@firebase/auth-compat",fV="@firebase/database",pV="@firebase/data-connect",gV="@firebase/database-compat",mV="@firebase/functions",yV="@firebase/functions-compat",vV="@firebase/installations",_V="@firebase/installations-compat",IV="@firebase/messaging",EV="@firebase/messaging-compat",wV="@firebase/performance",TV="@firebase/performance-compat",DV="@firebase/remote-config",bV="@firebase/remote-config-compat",CV="@firebase/storage",SV="@firebase/storage-compat",AV="@firebase/firestore",NV="@firebase/ai",RV="@firebase/firestore-compat",PV="firebase",MV="11.10.0";var ld="[DEFAULT]",kV={[km]:"fire-core",[sV]:"fire-core-compat",[cV]:"fire-analytics",[aV]:"fire-analytics-compat",[lV]:"fire-app-check",[uV]:"fire-app-check-compat",[dV]:"fire-auth",[hV]:"fire-auth-compat",[fV]:"fire-rtdb",[pV]:"fire-data-connect",[gV]:"fire-rtdb-compat",[mV]:"fire-fn",[yV]:"fire-fn-compat",[vV]:"fire-iid",[_V]:"fire-iid-compat",[IV]:"fire-fcm",[EV]:"fire-fcm-compat",[wV]:"fire-perf",[TV]:"fire-perf-compat",[DV]:"fire-rc",[bV]:"fire-rc-compat",[CV]:"fire-gcs",[SV]:"fire-gcs-compat",[AV]:"fire-fst",[RV]:"fire-fst-compat",[NV]:"fire-vertex","fire-js":"fire-js",[PV]:"fire-js-all"};var Ma=new Map,xV=new Map,xm=new Map;function sC(n,e){try{n.container.addComponent(e)}catch(t){On.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Yt(n){let e=n.name;if(xm.has(e))return On.debug(`There were multiple attempts to register component ${e}.`),!1;xm.set(e,n);for(let t of Ma.values())sC(t,n);for(let t of xV.values())sC(t,n);return!0}function fr(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function lC(n,e,t=ld){fr(n,e).clearInstance(t)}function Mt(n){return n==null?!1:n.settings!==void 0}var OV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},hr=new Qt("app","Firebase",OV);var Om=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new gt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw hr.create("app-deleted",{appName:this._name})}};var pr=MV;function Vm(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:ld,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw hr.create("bad-app-name",{appName:String(i)});if(t||(t=Em()),!t)throw hr.create("no-options");let o=Ma.get(i);if(o){if(Tt(t,o.options)&&Tt(r,o.config))return o;throw hr.create("duplicate-app",{appName:i})}let s=new cd(i);for(let c of xm.values())s.addComponent(c);let a=new Om(t,r,s);return Ma.set(i,a),a}function gr(n=ld){let e=Ma.get(n);if(!e&&n===ld&&Em())return Vm();if(!e)throw hr.create("no-app",{appName:n});return e}function dd(){return Array.from(Ma.values())}function Ne(n,e,t){var r;let i=(r=kV[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){let a=[`Unable to register library "${i}" with version "${e}":`];o&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),On.warn(a.join(" "));return}Yt(new gt(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var FV="firebase-heartbeat-database",LV=1,ka="firebase-heartbeat-store",Pm=null;function dC(){return Pm||(Pm=iC(FV,LV,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ka)}catch(t){console.warn(t)}}}}).catch(n=>{throw hr.create("idb-open",{originalErrorMessage:n.message})})),Pm}function VV(n){return v(this,null,function*(){try{let t=(yield dC()).transaction(ka),r=yield t.objectStore(ka).get(hC(n));return yield t.done,r}catch(e){if(e instanceof Pt)On.warn(e.message);else{let t=hr.create("idb-get",{originalErrorMessage:e?.message});On.warn(t.message)}}})}function aC(n,e){return v(this,null,function*(){try{let r=(yield dC()).transaction(ka,"readwrite");yield r.objectStore(ka).put(e,hC(n)),yield r.done}catch(t){if(t instanceof Pt)On.warn(t.message);else{let r=hr.create("idb-set",{originalErrorMessage:t?.message});On.warn(r.message)}}})}function hC(n){return`${n.name}!${n.options.appId}`}var jV=1024,BV=30,Fm=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Lm(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return v(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=cC();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(s=>s.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>BV){let s=$V(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){On.warn(r)}})}getHeartbeatsHeader(){return v(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=cC(),{heartbeatsToSend:r,unsentEntries:i}=UV(this._heartbeatsCache.heartbeats),o=Ra(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return On.warn(t),""}})}};function cC(){return new Date().toISOString().substring(0,10)}function UV(n,e=jV){let t=[],r=n.slice();for(let i of n){let o=t.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),uC(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),uC(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Lm=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return v(this,null,function*(){return Fo()?Qb().then(()=>!0).catch(()=>!1):!1})}read(){return v(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield VV(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return v(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return aC(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return v(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return aC(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function uC(n){return Ra(JSON.stringify({version:2,heartbeats:n})).length}function $V(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function HV(n){Yt(new gt("platform-logger",e=>new Mm(e),"PRIVATE")),Yt(new gt("heartbeat",e=>new Fm(e),"PRIVATE")),Ne(km,oC,n),Ne(km,oC,"esm2017"),Ne("fire-js","")}HV("");var qV="firebase",zV="11.10.0";Ne(qV,zV,"app");function jm(n){n===void 0&&($g(jm),n=Q(Et));let e=n.get($l);return t=>new ee(r=>{let i=e.add(),o=!1;function s(){o||(i(),o=!0)}let a=t.subscribe({next:c=>{r.next(c),s()},complete:()=>{r.complete(),s()},error:c=>{r.error(c),s()}});return a.add(()=>{r.unsubscribe(),s()}),a})}var Fn=new Da("ANGULARFIRE2_VERSION");function xa(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(s=>s.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var wi=(n,e)=>{let t=e?[e]:dd(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},Vo=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(Vo||{}),fC=gm()&&typeof Zone<"u"?Vo.WARN:Vo.SILENT;var hd=class{zone;delegate;constructor(e,t=Cp){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i?i.runGuarded(()=>{e.apply(this,[s])}):e.apply(this,[s])};return this.delegate.schedule(o,t,r)}},mr=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=Q(xe);this.outsideAngular=t.runOutsideAngular(()=>new hd(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new hd(typeof Zone>"u"?void 0:Zone.current,Nu))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),pC=!1;function WV(n,e){!pC&&(fC>Vo.SILENT||gm())&&(pC=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),fC>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function GV(n){let e=Q(xe,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function Ei(n){let e=Q(xe,{optional:!0});return e?e.run(()=>n()):n()}var KV=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),Ro(t,()=>Ei(()=>n.apply(void 0,r)))),j=(n,e,t)=>(t||=e?Vo.WARN:Vo.VERBOSE,function(){let r,i=arguments,o,s,a;try{o=Q(mr),s=Q($l),a=Q(sn)}catch{return WV(n,t),n.apply(this,i)}for(let l=0;l<arguments.length;l++)typeof i[l]=="function"&&(e&&(r||=Ei(()=>s.add())),i[l]=KV(i[l],r,a));let c=GV(()=>n.apply(this,i));return e?c instanceof ee?c.pipe(sr(o.outsideAngular),or(o.insideAngular),jm(a)):c instanceof Promise?Ei(()=>{let l=s.add();return new Promise((d,f)=>{c.then(g=>Ro(a,()=>Ei(()=>d(g))),g=>Ro(a,()=>Ei(()=>f(g)))).finally(l)})}):typeof c=="function"&&r?function(){return setTimeout(r,0),c.apply(this,arguments)}:Ei(()=>c):c instanceof ee?c.pipe(sr(o.outsideAngular),or(o.insideAngular)):Ei(()=>c)});var Ln=class{constructor(e){return e}},Ti=class{constructor(){return dd()}};function QV(n){return n&&n.length===1?n[0]:new Ln(gr())}var Bm=new oe("angularfire2._apps"),YV={provide:Ln,useFactory:QV,deps:[[new At,Bm]]},ZV={provide:Ti,deps:[[new At,Bm]]};function JV(n){return(e,t)=>{let r=t.get(LD);Ne("angularfire",Fn.full,"core"),Ne("angularfire",Fn.full,"app"),Ne("angular",Mb.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Ln(i)}}function gW(n,...e){return No([YV,ZV,{provide:Bm,useFactory:JV(n),multi:!0,deps:[xe,Et,mr,...e]}])}var mW=j(gr,!0);var yW=j(Vm,!0);var fd=new oe("");var yC=null;function pd(){return yC}function XV(n){yC??=n}var Um=class{},$m=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Te({token:n,factory:()=>Q(vC),providedIn:"platform"})}return n})();var vC=(()=>{class n extends $m{_location;_history;_doc=Q(fd);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return pd().getBaseHref(this._doc)}onPopState(t){let r=pd().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=pd().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Te({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function _C(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function gC(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function yr(n){return n&&n[0]!=="?"?`?${n}`:n}var gd=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Te({token:n,factory:()=>Q(EC),providedIn:"root"})}return n})(),IC=new oe(""),EC=(()=>{class n extends gd{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Q(fd).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return _C(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+yr(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+yr(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+yr(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(ft($m),ft(IC,8))};static \u0275prov=Te({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),wC=(()=>{class n{_subject=new Rn;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=n2(gC(mC(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+yr(r))}normalize(t){return n.stripTrailingSlash(t2(this._basePath,mC(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+yr(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+yr(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=yr;static joinWithSlash=_C;static stripTrailingSlash=gC;static \u0275fac=function(r){return new(r||n)(ft(gd))};static \u0275prov=Te({token:n,factory:()=>e2(),providedIn:"root"})}return n})();function e2(){return new wC(ft(gd))}function t2(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function mC(n){return n.replace(/\/index.html$/,"")}function n2(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var AC={ADP:[void 0,void 0,0],AFN:[void 0,"\u060B",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058F",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20BC"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09F3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xA5","\xA5"],COP:[void 0,"$",2],CRC:[void 0,"\u20A1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010D",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xA3"],ESP:[void 0,"\u20A7",0],EUR:["\u20AC"],FJD:[void 0,"$"],FKP:[void 0,"\xA3"],GBP:["\xA3"],GEL:[void 0,"\u20BE"],GHS:[void 0,"GH\u20B5"],GIP:[void 0,"\xA3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20AA"],INR:["\u20B9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xA5",void 0,0],KHR:[void 0,"\u17DB"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20A9",0],KRW:["\u20A9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20B8"],LAK:[void 0,"\u20AD",0],LBP:[void 0,"L\xA3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20AE",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20A6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20B1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20B2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20BD"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xA3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xA3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xA3",0],THB:[void 0,"\u0E3F"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20BA"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20B4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20AB",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202FCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xA4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]},Wm=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(Wm||{});var fn={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function jo(n,e){let t=ed(n),r=t[vi.NumberSymbols][e];if(typeof r>"u"){if(e===fn.CurrencyDecimal)return t[vi.NumberSymbols][fn.Decimal];if(e===fn.CurrencyGroup)return t[vi.NumberSymbols][fn.Group]}return r}function NC(n,e){return ed(n)[vi.NumberFormats][e]}function r2(n){return ed(n)[vi.Currencies]}function RC(n,e,t="en"){let r=r2(t)[n]||AC[n]||[],i=r[1];return e==="narrow"&&typeof i=="string"?i:r[0]||n}var i2=2;function PC(n){let e,t=AC[n];return t&&(e=t[2]),typeof e=="number"?e:i2}var o2=/^(\d+)?\.((\d+)(-(\d+))?)?$/,TC=22,md=".",Oa="0",s2=";",a2=",",Hm="#",DC="\xA4";function c2(n,e,t,r,i,o,s=!1){let a="",c=!1;if(!isFinite(n))a=jo(t,fn.Infinity);else{let l=d2(n);s&&(l=l2(l));let d=e.minInt,f=e.minFrac,g=e.maxFrac;if(o){let B=o.match(o2);if(B===null)throw new Error(`${o} is not a valid digit info`);let U=B[1],W=B[3],de=B[5];U!=null&&(d=qm(U)),W!=null&&(f=qm(W)),de!=null?g=qm(de):W!=null&&f>g&&(g=f)}h2(l,f,g);let m=l.digits,w=l.integerLen,R=l.exponent,P=[];for(c=m.every(B=>!B);w<d;w++)m.unshift(0);for(;w<0;w++)m.unshift(0);w>0?P=m.splice(w,m.length):(P=m,m=[0]);let O=[];for(m.length>=e.lgSize&&O.unshift(m.splice(-e.lgSize,m.length).join(""));m.length>e.gSize;)O.unshift(m.splice(-e.gSize,m.length).join(""));m.length&&O.unshift(m.join("")),a=O.join(jo(t,r)),P.length&&(a+=jo(t,i)+P.join("")),R&&(a+=jo(t,fn.Exponential)+"+"+R)}return n<0&&!c?a=e.negPre+a+e.negSuf:a=e.posPre+a+e.posSuf,a}function MC(n,e,t,r,i){let o=NC(e,Wm.Currency),s=u2(o,jo(e,fn.MinusSign));return s.minFrac=PC(r),s.maxFrac=s.minFrac,c2(n,s,e,fn.CurrencyGroup,fn.CurrencyDecimal,i).replace(DC,t).replace(DC,"").trim()}function u2(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(s2),i=r[0],o=r[1],s=i.indexOf(md)!==-1?i.split(md):[i.substring(0,i.lastIndexOf(Oa)+1),i.substring(i.lastIndexOf(Oa)+1)],a=s[0],c=s[1]||"";t.posPre=a.substring(0,a.indexOf(Hm));for(let d=0;d<c.length;d++){let f=c.charAt(d);f===Oa?t.minFrac=t.maxFrac=d+1:f===Hm?t.maxFrac=d+1:t.posSuf+=f}let l=a.split(a2);if(t.gSize=l[1]?l[1].length:0,t.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,o){let d=i.length-t.posPre.length-t.posSuf.length,f=o.indexOf(Hm);t.negPre=o.substring(0,f).replace(/'/g,""),t.negSuf=o.slice(f+d).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function l2(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function d2(n){let e=Math.abs(n)+"",t=0,r,i,o,s,a;for((i=e.indexOf(md))>-1&&(e=e.replace(md,"")),(o=e.search(/e/i))>0?(i<0&&(i=o),i+=+e.slice(o+1),e=e.substring(0,o)):i<0&&(i=e.length),o=0;e.charAt(o)===Oa;o++);if(o===(a=e.length))r=[0],i=1;else{for(a--;e.charAt(a)===Oa;)a--;for(i-=o,r=[],s=0;o<=a;o++,s++)r[s]=Number(e.charAt(o))}return i>TC&&(r=r.splice(0,TC-1),t=i-1,i=1),{digits:r,exponent:t,integerLen:i}}function h2(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let r=n.digits,i=r.length-n.integerLen,o=Math.min(Math.max(e,i),t),s=o+n.integerLen,a=r[s];if(s>0){r.splice(Math.max(n.integerLen,s));for(let f=s;f<r.length;f++)r[f]=0}else{i=Math.max(0,i),n.integerLen=1,r.length=Math.max(1,s=o+1),r[0]=0;for(let f=1;f<s;f++)r[f]=0}if(a>=5)if(s-1<0){for(let f=0;f>s;f--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[s-1]++;for(;i<Math.max(0,o);i++)r.push(0);let c=o!==0,l=e+n.integerLen,d=r.reduceRight(function(f,g,m,w){return g=g+f,w[m]=g<10?g:g-10,c&&(w[m]===0&&m>=l?w.pop():c=!1),g>=10?1:0},0);d&&(r.unshift(d),n.integerLen++)}function qm(n){let e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}var zm=/\s+/,bC=[],f2=(()=>{class n{_ngEl;_renderer;initialClasses=bC;rawClass;stateMap=new Map;constructor(t,r){this._ngEl=t,this._renderer=r}set klass(t){this.initialClasses=t!=null?t.trim().split(zm):bC}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(zm):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(zm).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||n)(wt(Xg),wt(gb))};static \u0275dir=Xl({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var yd=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},kC=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new yd(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),CC(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);CC(o,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(wt(Zl),wt(Kl),wt(mm))};static \u0275dir=Xl({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function CC(n,e){n.context.$implicit=e.item}var p2=(()=>{class n{_viewContainer;_context=new vd;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){SC(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){SC(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(wt(Zl),wt(Kl))};static \u0275dir=Xl({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),vd=class{$implicit=null;ngIf=null};function SC(n,e){if(n&&!n.createEmbeddedView)throw new ie(2020,!1)}function g2(n,e){return new ie(2100,!1)}var m2=(()=>{class n{_locale;_defaultCurrencyCode;constructor(t,r="USD"){this._locale=t,this._defaultCurrencyCode=r}transform(t,r=this._defaultCurrencyCode,i="symbol",o,s){if(!y2(t))return null;s||=this._locale,typeof i=="boolean"&&(i=i?"symbol":"code");let a=r||this._defaultCurrencyCode;i!=="code"&&(i==="symbol"||i==="symbol-narrow"?a=RC(a,i==="symbol"?"wide":"narrow",s):a=i);try{let c=v2(t);return MC(c,s,a,r,o)}catch(c){throw g2(n,c.message)}}static \u0275fac=function(r){return new(r||n)(wt(td,16),wt(kb,16))};static \u0275pipe=Ib({name:"currency",type:n,pure:!0})}return n})();function y2(n){return!(n==null||n===""||n!==n)}function v2(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new Error(`${n} is not a number`);return n}var _2=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Jl({type:n});static \u0275inj=kl({})}return n})();function I2(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var E2="browser",xC="server";function w2(n){return n===xC}var Gm=class{};var T2=new Map,D2={activated:!1,tokenObservers:[]},b2={initialized:!1,enabled:!1};function Zt(n){return T2.get(n)||Object.assign({},D2)}function VC(){return b2}var C2="https://content-firebaseappcheck.googleapis.com/v1";var S2="exchangeDebugToken",OC={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},n7=24*60*60*1e3;var Ym=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return v(this,null,function*(){this.stop();try{this.pending=new _i,this.pending.promise.catch(t=>{}),yield A2(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new _i,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function A2(n){return new Promise(e=>{setTimeout(e,n)})}var N2={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},vr=new Qt("appCheck","AppCheck",N2);function jC(n){if(!Zt(n).activated)throw vr.create("use-before-activation",{appName:n.name})}function BC(r,i){return v(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let m=yield s.getHeartbeatsHeader();m&&(o["X-Firebase-Client"]=m)}let a={method:"POST",body:JSON.stringify(e),headers:o},c;try{c=yield fetch(n,a)}catch(m){throw vr.create("fetch-network-error",{originalErrorMessage:m?.message})}if(c.status!==200)throw vr.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(m){throw vr.create("fetch-parse-error",{originalErrorMessage:m?.message})}let d=l.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw vr.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let f=Number(d[1])*1e3,g=Date.now();return{token:l.token,expireTimeMillis:g+f,issuedAtTimeMillis:g}})}function UC(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${C2}/projects/${t}/apps/${r}:${S2}?key=${i}`,body:{debug_token:e}}}var R2="firebase-app-check-database",P2=1,Zm="firebase-app-check-store";var _d=null;function M2(){return _d||(_d=new Promise((n,e)=>{try{let t=indexedDB.open(R2,P2);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(vr.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Zm,{keyPath:"compositeKey"})}}}catch(t){e(vr.create("storage-open",{originalErrorMessage:t?.message}))}}),_d)}function k2(n,e){return x2(O2(n),e)}function x2(n,e){return v(this,null,function*(){let r=(yield M2()).transaction(Zm,"readwrite"),o=r.objectStore(Zm).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=c=>{s()},r.onerror=c=>{var l;a(vr.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function O2(n){return`${n.options.appId}-${n.name}`}var Fa=new dn("@firebase/app-check");function Km(n,e){return Fo()?k2(n,e).catch(t=>{Fa.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function $C(){return VC().enabled}function HC(){return v(this,null,function*(){let n=VC();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var F2={error:"UNKNOWN_ERROR"};function L2(n){return rd.encodeString(JSON.stringify(n),!1)}function Jm(n,e=!1,t=!1){return v(this,null,function*(){let r=n.app;jC(r);let i=Zt(r),o=i.token,s;if(o&&!La(o)&&(i.token=void 0,o=void 0),!o){let l=yield i.cachedTokenPromise;l&&(La(l)?o=l:yield Km(r,void 0))}if(!e&&o&&La(o))return{token:o.token};let a=!1;if($C())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=BC(UC(r,yield HC()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),a=!0);let l=yield i.exchangeTokenPromise;return yield Km(r,l),i.token=l,{token:l.token}}catch(l){return l.code==="appCheck/throttled"||l.code==="appCheck/initial-throttle"?Fa.warn(l.message):t&&Fa.error(l),Qm(l)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),a=!0),o=yield Zt(r).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"||l.code==="appCheck/initial-throttle"?Fa.warn(l.message):t&&Fa.error(l),s=l}let c;return o?s?La(o)?c={token:o.token,internalError:s}:c=Qm(s):(c={token:o.token},i.token=o,yield Km(r,o)):c=Qm(s),a&&U2(r,c),c})}function V2(n){return v(this,null,function*(){let e=n.app;jC(e);let{provider:t}=Zt(e);if($C()){let r=yield HC(),{token:i}=yield BC(UC(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function j2(n,e,t,r){let{app:i}=n,o=Zt(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&La(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),FC(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>FC(n))}function qC(n,e){let t=Zt(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function FC(n){let{app:e}=n,t=Zt(e),r=t.tokenRefresher;r||(r=B2(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function B2(n){let{app:e}=n;return new Ym(()=>v(null,null,function*(){let t=Zt(e),r;if(t.token?r=yield Jm(n,!0):r=yield Jm(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Zt(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},OC.RETRIAL_MIN_WAIT,OC.RETRIAL_MAX_WAIT)}function U2(n,e){let t=Zt(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function La(n){return n.expireTimeMillis-Date.now()>0}function Qm(n){return{token:L2(F2),error:n}}var Xm=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Zt(this.app);for(let t of e)qC(this.app,t.next);return Promise.resolve()}};function $2(n,e){return new Xm(n,e)}function H2(n){return{getToken:e=>Jm(n,e),getLimitedUseToken:()=>V2(n),addTokenListener:e=>j2(n,"INTERNAL",e),removeTokenListener:e=>qC(n.app,e)}}var q2="@firebase/app-check",z2="0.10.1";var W2="app-check",LC="app-check-internal";function G2(){Yt(new gt(W2,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return $2(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(LC).initialize()})),Yt(new gt(LC,n=>{let e=n.getProvider("app-check").getImmediate();return H2(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Ne(q2,z2)}G2();var K2="app-check";var Bo=class{constructor(){return wi(K2)}};var Q2=["localhost","0.0.0.0","127.0.0.1"],g7=typeof window<"u"&&Q2.includes(window.location.hostname);function oS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var sS=oS,aS=new Qt("auth","Firebase",oS());var bd=new dn("@firebase/auth");function Y2(n,...e){bd.logLevel<=se.WARN&&bd.warn(`Auth (${pr}): ${n}`,...e)}function Ed(n,...e){bd.logLevel<=se.ERROR&&bd.error(`Auth (${pr}): ${n}`,...e)}function gn(n,...e){throw yy(n,...e)}function Jt(n,...e){return yy(n,...e)}function my(n,e,t){let r=Object.assign(Object.assign({},sS()),{[e]:t});return new Qt("auth","Firebase",r).create(e,{appName:n.name})}function Di(n){return my(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Z2(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&gn(n,"argument-error"),my(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function yy(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return aS.create(n,...e)}function G(n,e,...t){if(!n)throw yy(e,...t)}function Vn(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ed(e),new Error(e)}function Bn(n,e){n||Vn(e)}function ny(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function J2(){return zC()==="http:"||zC()==="https:"}function zC(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function X2(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(J2()||Wb()||"connection"in navigator)?navigator.onLine:!0}function ej(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var bi=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Bn(t>e,"Short delay should be less than long delay!"),this.isMobile=Hb()||Gb()}get(){return X2()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function vy(n,e){Bn(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Cd=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var tj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var nj=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],rj=new bi(3e4,6e4);function _y(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function $o(o,s,a,c){return v(this,arguments,function*(n,e,t,r,i={}){return cS(n,i,()=>v(null,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let f=Lo(Object.assign({key:n.config.apiKey},d)).slice(1),g=yield n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);let m=Object.assign({method:e,headers:g},l);return zb()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&xn(n.emulatorConfig.host)&&(m.credentials="include"),Cd.fetch()(yield uS(n,n.config.apiHost,t,f),m)}))})}function cS(n,e,t){return v(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},tj),e);try{let i=new ry(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let s=yield o.json();if("needConfirmation"in s)throw Id(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Id(n,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw Id(n,"email-already-in-use",s);if(c==="USER_DISABLED")throw Id(n,"user-disabled",s);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw my(n,d,l);gn(n,d)}}catch(i){if(i instanceof Pt)throw i;gn(n,"network-request-failed",{message:String(i)})}})}function ij(o,s,a,c){return v(this,arguments,function*(n,e,t,r,i={}){let l=yield $o(n,e,t,r,i);return"mfaPendingCredential"in l&&gn(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function uS(n,e,t,r){return v(this,null,function*(){let i=`${e}${t}?${r}`,o=n,s=o.config.emulator?vy(n.config,i):`${n.config.apiScheme}://${i}`;return nj.includes(t)&&(yield o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s})}var ry=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Jt(this.auth,"network-request-failed")),rj.get())})}};function Id(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Jt(n,e,r);return i.customData._tokenResponse=t,i}function oj(n,e){return v(this,null,function*(){return $o(n,"POST","/v1/accounts:delete",e)})}function Sd(n,e){return v(this,null,function*(){return $o(n,"POST","/v1/accounts:lookup",e)})}function Va(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Iy(n,e=!1){return v(this,null,function*(){let t=ge(n),r=yield t.getIdToken(e),i=Ey(r);G(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:r,authTime:Va(ey(i.auth_time)),issuedAtTime:Va(ey(i.iat)),expirationTime:Va(ey(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function ey(n){return Number(n)*1e3}function Ey(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ed("JWT malformed, contained fewer than 3 sections"),null;try{let i=id(t);return i?JSON.parse(i):(Ed("Failed to decode base64 JWT payload"),null)}catch(i){return Ed("Caught error parsing JWT payload as JSON",i?.toString()),null}}function WC(n){let e=Ey(n);return G(e,"internal-error"),G(typeof e.exp<"u","internal-error"),G(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Ba(n,e,t=!1){return v(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Pt&&sj(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function sj({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var iy=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>v(this,null,function*(){yield this.iteration()}),t)}iteration(){return v(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Ua=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Va(this.lastLoginAt),this.creationTime=Va(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Ad(n){return v(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Ba(n,Sd(t,{idToken:r}));G(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let s=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?lS(o.providerUserInfo):[],a=aj(n.providerData,s),c=n.isAnonymous,l=!(n.email&&o.passwordHash)&&!a?.length,d=c?l:!1,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new Ua(o.createdAt,o.lastLoginAt),isAnonymous:d};Object.assign(n,f)})}function wy(n){return v(this,null,function*(){let e=ge(n);yield Ad(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function aj(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function lS(n){return n.map(e=>{var{providerId:t}=e,r=xu(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function cj(n,e){return v(this,null,function*(){let t=yield cS(n,{},()=>v(null,null,function*(){let r=Lo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,s=yield uS(n,i,"/v1/token",`key=${o}`),a=yield n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let c={method:"POST",headers:a,body:r};return n.emulatorConfig&&xn(n.emulatorConfig.host)&&(c.credentials="include"),Cd.fetch()(s,c)}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function uj(n,e){return v(this,null,function*(){return $o(n,"POST","/v2/accounts:revokeToken",_y(n,e))})}var ja=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){G(e.idToken,"internal-error"),G(typeof e.idToken<"u","internal-error"),G(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):WC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){G(e.length!==0,"internal-error");let t=WC(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return v(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(G(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return v(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield cj(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,s=new n;return r&&(G(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(G(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(G(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Vn("not implemented")}};function _r(n,e){G(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Ir=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=xu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new iy(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Ua(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return v(this,null,function*(){let t=yield Ba(this,this.stsTokenManager.getToken(this.auth,e));return G(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Iy(this,e)}reload(){return wy(this)}_assign(e){this!==e&&(G(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){G(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return v(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Ad(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return v(this,null,function*(){if(Mt(this.auth.app))return Promise.reject(Di(this.auth));let e=yield this.getIdToken();return yield Ba(this,oj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,s,a,c,l,d;let f=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(i=t.email)!==null&&i!==void 0?i:void 0,m=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,w=(s=t.photoURL)!==null&&s!==void 0?s:void 0,R=(a=t.tenantId)!==null&&a!==void 0?a:void 0,P=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,O=(l=t.createdAt)!==null&&l!==void 0?l:void 0,B=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:U,emailVerified:W,isAnonymous:de,providerData:K,stsTokenManager:T}=t;G(U&&T,e,"internal-error");let _=ja.fromJSON(this.name,T);G(typeof U=="string",e,"internal-error"),_r(f,e.name),_r(g,e.name),G(typeof W=="boolean",e,"internal-error"),G(typeof de=="boolean",e,"internal-error"),_r(m,e.name),_r(w,e.name),_r(R,e.name),_r(P,e.name),_r(O,e.name),_r(B,e.name);let E=new n({uid:U,auth:e,email:g,emailVerified:W,displayName:f,isAnonymous:de,photoURL:w,phoneNumber:m,tenantId:R,stsTokenManager:_,createdAt:O,lastLoginAt:B});return K&&Array.isArray(K)&&(E.providerData=K.map(D=>Object.assign({},D))),P&&(E._redirectEventId=P),E}static _fromIdTokenResponse(e,t,r=!1){return v(this,null,function*(){let i=new ja;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Ad(o),o})}static _fromGetAccountInfoResponse(e,t,r){return v(this,null,function*(){let i=t.users[0];G(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?lS(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,a=new ja;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Ua(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(c,l),c})}};var GC=new Map;function jn(n){Bn(n instanceof Function,"Expected a class definition");let e=GC.get(n);return e?(Bn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,GC.set(n,e),e)}var lj=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return v(this,null,function*(){return!0})}_set(t,r){return v(this,null,function*(){this.storage[t]=r})}_get(t){return v(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return v(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),oy=lj;function wd(n,e,t){return`firebase:${n}:${e}:${t}`}var Nd=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=wd(this.userKey,i.apiKey,o),this.fullPersistenceKey=wd("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return v(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield Sd(this.auth,{idToken:e}).catch(()=>{});return t?Ir._fromGetAccountInfoResponse(this.auth,t,e):null}return Ir._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return v(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return v(this,null,function*(){if(!t.length)return new n(jn(oy),e,r);let i=(yield Promise.all(t.map(l=>v(null,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),o=i[0]||jn(oy),s=wd(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let d=yield l._get(s);if(d){let f;if(typeof d=="string"){let g=yield Sd(e,{idToken:d}).catch(()=>{});if(!g)break;f=yield Ir._fromGetAccountInfoResponse(e,g,d)}else f=Ir._fromJSON(e,d);l!==o&&(a=f),o=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new n(o,e,r):(o=c[0],a&&(yield o._set(s,a.toJSON())),yield Promise.all(t.map(l=>v(null,null,function*(){if(l!==o)try{yield l._remove(s)}catch{}}))),new n(o,e,r))})}};function KC(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(pS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(dS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mS(e))return"Blackberry";if(yS(e))return"Webos";if(hS(e))return"Safari";if((e.includes("chrome/")||fS(e))&&!e.includes("edge/"))return"Chrome";if(gS(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function dS(n=Oe()){return/firefox\//i.test(n)}function hS(n=Oe()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fS(n=Oe()){return/crios\//i.test(n)}function pS(n=Oe()){return/iemobile/i.test(n)}function gS(n=Oe()){return/android/i.test(n)}function mS(n=Oe()){return/blackberry/i.test(n)}function yS(n=Oe()){return/webos/i.test(n)}function Ty(n=Oe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function dj(n=Oe()){var e;return Ty(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function hj(){return Kb()&&document.documentMode===10}function vS(n=Oe()){return Ty(n)||gS(n)||yS(n)||mS(n)||/windows phone/i.test(n)||pS(n)}function _S(n,e=[]){let t;switch(n){case"Browser":t=KC(Oe());break;case"Worker":t=`${KC(Oe())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${pr}/${r}`}var sy=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((s,a)=>{try{let c=e(o);s(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return v(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function fj(t){return v(this,arguments,function*(n,e={}){return $o(n,"GET","/v2/passwordPolicy",_y(n,e))})}var pj=6,ay=class{constructor(e){var t,r,i,o;let s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=s.minPasswordLength)!==null&&t!==void 0?t:pj,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),s.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),s.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),s.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),s.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,s,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsUppercaseLetter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(s=c.containsNumericCharacter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var cy=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Rd(this),this.idTokenSubscription=new Rd(this),this.beforeStateQueue=new sy(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=aS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=jn(t)),this._initializationPromise=this.queue(()=>v(this,null,function*(){var r,i,o;if(!this._deleted&&(this.persistenceManager=yield Nd.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return v(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return v(this,null,function*(){try{let t=yield Sd(this,{idToken:e}),r=yield Ir._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return v(this,null,function*(){var t;if(Mt(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let s=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!s||s===a)&&c?.user&&(i=c.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(s){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return G(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return v(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return v(this,null,function*(){try{yield Ad(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=ej()}_delete(){return v(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return v(this,null,function*(){if(Mt(this.app))return Promise.reject(Di(this));let t=e?ge(e):null;return t&&G(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return v(this,null,function*(){if(!this._deleted)return e&&G(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>v(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return v(this,null,function*(){return Mt(this.app)?Promise.reject(Di(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Mt(this.app)?Promise.reject(Di(this)):this.queue(()=>v(this,null,function*(){yield this.assertedPersistence.setPersistence(jn(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return v(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return v(this,null,function*(){let e=yield fj(this),t=new ay(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return v(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield uj(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return v(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return v(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&jn(e)||this._popupRedirectResolver;G(t,this,"argument-error"),this.redirectPersistenceManager=yield Nd.create(this,[jn(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return v(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>v(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return v(this,null,function*(){if(e===this.currentUser)return this.queue(()=>v(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(G(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{s=!0,c()}}else{let c=e.addObserver(t);return()=>{s=!0,c()}}}directlySetCurrentUser(e){return v(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return G(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_S(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return v(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return v(this,null,function*(){var e;if(Mt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&Y2(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Vd(n){return ge(n)}var Rd=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Zb(t=>this.observer=t)}get next(){return G(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Dy={loadJS(){return v(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function gj(n){Dy=n}function mj(n){return Dy.loadJS(n)}function yj(){return Dy.gapiScript}function IS(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function by(n,e){let t=fr(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(Tt(o,e??{}))return i;gn(i,"already-initialized")}return t.initialize({options:e})}function vj(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(jn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Cy(n,e,t){let r=Vd(n);G(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=ES(e),{host:s,port:a}=_j(e),c=a===null?"":`:${a}`,l={url:`${o}//${s}${c}/`},d=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){G(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),G(Tt(l,r.config.emulator)&&Tt(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=l,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,xn(s)?(Pa(`${o}//${s}${c}`),ad("Auth",!0)):i||Ij()}function ES(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function _j(n){let e=ES(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:QC(r.substr(o.length+1))}}else{let[o,s]=r.split(":");return{host:o,port:QC(s)}}}function QC(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function Ij(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var $a=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Vn("not implemented")}_getIdTokenResponse(e){return Vn("not implemented")}_linkToIdToken(e,t){return Vn("not implemented")}_getReauthenticationResolver(e){return Vn("not implemented")}};function Uo(n,e){return v(this,null,function*(){return ij(n,"POST","/v1/accounts:signInWithIdp",_y(n,e))})}var Ej="http://localhost",Pd=class n extends $a{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):gn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,o=xu(t,["providerId","signInMethod"]);if(!r||!i)return null;let s=new n(r,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){let t=this.buildRequest();return Uo(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Uo(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Uo(e,t)}buildRequest(){let e={requestUri:Ej,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Lo(t)}return e}};var Ha=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Md=class extends Ha{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var wj=(()=>{class n extends Md{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Pd._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var qa=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return v(this,null,function*(){let o=yield Ir._fromIdTokenResponse(e,r,i),s=YC(r);return new n({user:o,providerId:s,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return v(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=YC(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function YC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var uy=class n extends Pt{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function wS(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?uy._fromErrorAndOperation(n,o,e,r):o})}function Tj(n,e,t=!1){return v(this,null,function*(){let r=yield Ba(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return qa._forOperation(n,"link",r)})}function Dj(n,e,t=!1){return v(this,null,function*(){let{auth:r}=n;if(Mt(r.app))return Promise.reject(Di(r));let i="reauthenticate";try{let o=yield Ba(n,wS(r,i,e,n),t);G(o.idToken,r,"internal-error");let s=Ey(o.idToken);G(s,r,"internal-error");let{sub:a}=s;return G(n.uid===a,r,"user-mismatch"),qa._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&gn(r,"user-mismatch"),o}})}function bj(n,e,t=!1){return v(this,null,function*(){if(Mt(n.app))return Promise.reject(Di(n));let r="signIn",i=yield wS(n,r,e),o=yield qa._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(o.user)),o})}function Sy(n,e,t,r){return ge(n).onIdTokenChanged(e,t,r)}function Ay(n,e,t){return ge(n).beforeAuthStateChanged(e,t)}function Ny(n,e,t,r){return ge(n).onAuthStateChanged(e,t,r)}function Ry(n){return ge(n).signOut()}var kd="__sak";var xd=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(kd,"1"),this.storage.removeItem(kd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var Cj=1e3,Sj=10,Aj=(()=>{class n extends xd{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=vS(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);hj()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,Sj):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},Cj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return v(this,null,function*(){yield rn(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return v(this,null,function*(){let r=yield rn(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return v(this,null,function*(){yield rn(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),TS=Aj;var Nj=(()=>{class n extends xd{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Py=Nj;function Rj(n){return Promise.all(n.map(e=>v(null,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var Pj=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return v(this,null,function*(){let r=t,{eventId:i,eventType:o,data:s}=r.data,a=this.handlersMap[o];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let c=Array.from(a).map(d=>v(this,null,function*(){return d(r.origin,s)})),l=yield Rj(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:l})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function My(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var ly=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return v(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((a,c)=>{let l=My("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(f){let g=f;if(g.data.eventId===l)switch(g.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(g.data.response);break;default:clearTimeout(d),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})})}};function pn(){return window}function Mj(n){pn().location.href=n}function DS(){return typeof pn().WorkerGlobalScope<"u"&&typeof pn().importScripts=="function"}function kj(){return v(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function xj(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Oj(){return DS()?self:null}var bS="firebaseLocalStorageDb",Fj=1,Od="firebaseLocalStorage",CS="fbase_key",Ci=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function jd(n,e){return n.transaction([Od],e?"readwrite":"readonly").objectStore(Od)}function Lj(){let n=indexedDB.deleteDatabase(bS);return new Ci(n).toPromise()}function dy(){let n=indexedDB.open(bS,Fj);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Od,{keyPath:CS})}catch(i){t(i)}}),n.addEventListener("success",()=>v(null,null,function*(){let r=n.result;r.objectStoreNames.contains(Od)?e(r):(r.close(),yield Lj(),e(yield dy()))}))})}function ZC(n,e,t){return v(this,null,function*(){let r=jd(n,!0).put({[CS]:e,value:t});return new Ci(r).toPromise()})}function Vj(n,e){return v(this,null,function*(){let t=jd(n,!1).get(e),r=yield new Ci(t).toPromise();return r===void 0?null:r.value})}function JC(n,e){let t=jd(n,!0).delete(e);return new Ci(t).toPromise()}var jj=800,Bj=3,Uj=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return v(this,null,function*(){return this.db?this.db:(this.db=yield dy(),this.db)})}_withRetries(t){return v(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>Bj)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return v(this,null,function*(){return DS()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return v(this,null,function*(){this.receiver=Pj._getInstance(Oj()),this.receiver._subscribe("keyChanged",(t,r)=>v(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>v(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return v(this,null,function*(){var t,r;if(this.activeServiceWorker=yield kj(),!this.activeServiceWorker)return;this.sender=new ly(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return v(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||xj()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return v(this,null,function*(){try{if(!indexedDB)return!1;let t=yield dy();return yield ZC(t,kd,"1"),yield JC(t,kd),!0}catch{}return!1})}_withPendingWrite(t){return v(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return v(this,null,function*(){return this._withPendingWrite(()=>v(this,null,function*(){return yield this._withRetries(i=>ZC(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return v(this,null,function*(){let r=yield this._withRetries(i=>Vj(i,t));return this.localCache[t]=r,r})}_remove(t){return v(this,null,function*(){return this._withPendingWrite(()=>v(this,null,function*(){return yield this._withRetries(r=>JC(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return v(this,null,function*(){let t=yield this._withRetries(o=>{let s=jd(o,!1).getAll();return new Ci(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>v(this,null,function*(){return this._poll()}),jj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),SS=Uj;var b7=IS("rcb"),C7=new bi(3e4,6e4);function AS(n,e){return e?jn(e):(G(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var za=class extends $a{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Uo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Uo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Uo(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function $j(n){return bj(n.auth,new za(n),n.bypassAuthState)}function Hj(n){let{auth:e,user:t}=n;return G(t,e,"internal-error"),Dj(t,new za(n),n.bypassAuthState)}function qj(n){return v(this,null,function*(){let{auth:e,user:t}=n;return G(t,e,"internal-error"),Tj(t,new za(n),n.bypassAuthState)})}var Fd=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>v(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return v(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $j;case"linkViaPopup":case"linkViaRedirect":return qj;case"reauthViaPopup":case"reauthViaRedirect":return Hj;default:gn(this.auth,"internal-error")}}resolve(e){Bn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var zj=new bi(2e3,1e4);function ky(n,e,t){return v(this,null,function*(){if(Mt(n.app))return Promise.reject(Jt(n,"operation-not-supported-in-this-environment"));let r=Vd(n);Z2(n,e,Ha);let i=AS(r,t);return new Wj(r,"signInViaPopup",e,i).executeNotNull()})}var Wj=(()=>{class n extends Fd{constructor(t,r,i,o,s){super(t,r,o,s),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return v(this,null,function*(){let t=yield this.execute();return G(t,this.auth,"internal-error"),t})}onExecution(){return v(this,null,function*(){Bn(this.filter.length===1,"Popup operations only handle one event");let t=My();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Jt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(Jt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Jt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,zj.get())};t()}}n.currentPopupAction=null;return n})(),Gj="pendingRedirect",Td=new Map,hy=class n extends Fd{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return v(this,null,function*(){let e=Td.get(this.auth._key());if(!e){try{let r=(yield Kj(this.resolver,this.auth))?yield rn(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Td.set(this.auth._key(),e)}return this.bypassAuthState||Td.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return v(this,null,function*(){if(e.type==="signInViaRedirect")return rn(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,rn(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return v(this,null,function*(){})}cleanUp(){}};function Kj(n,e){return v(this,null,function*(){let t=Zj(e),r=Yj(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function Qj(n,e){Td.set(n._key(),e)}function Yj(n){return jn(n._redirectPersistence)}function Zj(n){return wd(Gj,n.config.apiKey,n.name)}function Jj(n,e,t=!1){return v(this,null,function*(){if(Mt(n.app))return Promise.reject(Di(n));let r=Vd(n),i=AS(r,e),s=yield new hy(r,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,yield r._persistUserIfCurrent(s.user),yield r._setRedirectUser(null,e)),s})}var Xj=10*60*1e3,fy=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eB(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!NS(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Jt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Xj&&this.cachedEventUids.clear(),this.cachedEventUids.has(XC(e))}saveEventToCache(e){this.cachedEventUids.add(XC(e)),this.lastProcessedEventTime=Date.now()}};function XC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function NS({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function eB(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return NS(n);default:return!1}}function tB(t){return v(this,arguments,function*(n,e={}){return $o(n,"GET","/v1/projects",e)})}var nB=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rB=/^https?/;function iB(n){return v(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield tB(n);for(let t of e)try{if(oB(t))return}catch{}gn(n,"unauthorized-domain")})}function oB(n){let e=ny(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===r}if(!rB.test(t))return!1;if(nB.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var sB=new bi(3e4,6e4);function eS(){let n=pn().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function aB(n){return new Promise((e,t)=>{var r,i,o;function s(){eS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{eS(),t(Jt(n,"network-request-failed"))},timeout:sB.get()})}if(!((i=(r=pn().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=pn().gapi)===null||o===void 0)&&o.load)s();else{let a=IS("iframefcb");return pn()[a]=()=>{gapi.load?s():t(Jt(n,"network-request-failed"))},mj(`${yj()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Dd=null,e})}var Dd=null;function cB(n){return Dd=Dd||aB(n),Dd}var uB=new bi(5e3,15e3),lB="__/auth/iframe",dB="emulator/auth/iframe",hB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pB(n){let e=n.config;G(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?vy(e,dB):`https://${n.config.authDomain}/${lB}`,r={apiKey:e.apiKey,appName:n.name,v:pr},i=fB.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${Lo(r).slice(1)}`}function gB(n){return v(this,null,function*(){let e=yield cB(n),t=pn().gapi;return G(t,n,"internal-error"),e.open({where:document.body,url:pB(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hB,dontclear:!0},r=>new Promise((i,o)=>v(null,null,function*(){yield r.restyle({setHideOnLeave:!1});let s=Jt(n,"network-request-failed"),a=pn().setTimeout(()=>{o(s)},uB.get());function c(){pn().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{o(s)})})))})}var mB={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},yB=500,vB=600,_B="_blank",IB="http://localhost",Ld=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function EB(n,e,t,r=yB,i=vB){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},mB),{width:r.toString(),height:i.toString(),top:o,left:s}),l=Oe().toLowerCase();t&&(a=fS(l)?_B:t),dS(l)&&(e=e||IB,c.scrollbars="yes");let d=Object.entries(c).reduce((g,[m,w])=>`${g}${m}=${w},`,"");if(dj(l)&&a!=="_self")return wB(e||"",a),new Ld(null);let f=window.open(e||"",a,d);G(f,n,"popup-blocked");try{f.focus()}catch{}return new Ld(f)}function wB(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var TB="__/auth/handler",DB="emulator/auth/handler",bB=encodeURIComponent("fac");function tS(n,e,t,r,i,o){return v(this,null,function*(){G(n.config.authDomain,n,"auth-domain-config-required"),G(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:pr,eventId:i};if(e instanceof Ha){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",Yb(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,f]of Object.entries(o||{}))s[d]=f}if(e instanceof Md){let d=e.getScopes().filter(f=>f!=="");d.length>0&&(s.scopes=d.join(","))}n.tenantId&&(s.tid=n.tenantId);let a=s;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),l=c?`#${bB}=${encodeURIComponent(c)}`:"";return`${CB(n)}?${Lo(a).slice(1)}${l}`})}function CB({config:n}){return n.emulator?vy(n,DB):`https://${n.authDomain}/${TB}`}var ty="webStorageSupport",py=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Py,this._completeRedirectFn=Jj,this._overrideRedirectResult=Qj}_openPopup(e,t,r,i){return v(this,null,function*(){var o;Bn((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let s=yield tS(e,t,r,ny(),i);return EB(e,s,My())})}_openRedirect(e,t,r,i){return v(this,null,function*(){yield this._originValidation(e);let o=yield tS(e,t,r,ny(),i);return Mj(o),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Bn(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return v(this,null,function*(){let t=yield gB(e),r=new fy(e);return t.register("authEvent",i=>(G(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ty,{type:ty},i=>{var o;let s=(o=i?.[0])===null||o===void 0?void 0:o[ty];s!==void 0&&t(!!s),gn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=iB(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return vS()||hS()||Ty()}},RS=py;var nS="@firebase/auth",rS="1.10.8";var gy=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return v(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){G(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function SB(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function AB(n){Yt(new gt("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;G(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_S(n)},l=new cy(r,i,o,c);return vj(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Yt(new gt("auth-internal",e=>{let t=Vd(e.getProvider("auth").getImmediate());return(r=>new gy(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ne(nS,rS,SB(n)),Ne(nS,rS,"esm2017")}var NB=5*60,RB=wm("authIdTokenMaxAge")||NB,iS=null,PB=n=>e=>v(null,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>RB)return;let i=t?.token;iS!==i&&(iS=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function xy(n=gr()){let e=fr(n,"auth");if(e.isInitialized())return e.getImmediate();let t=by(n,{popupRedirectResolver:RS,persistence:[SS,TS,Py]}),r=wm("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let s=PB(o.toString());Ay(t,s,()=>s(t.currentUser)),Sy(t,a=>s(a))}}let i=Im("auth");return i&&Cy(t,`http://${i}`),t}function MB(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}gj({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=Jt("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",MB().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});AB("Browser");var PS="auth",Wa=class{constructor(e){return e}},Ga=class{constructor(){return wi(PS)}};var Oy=new oe("angularfire2.auth-instances");function wU(n,e){let t=xa(PS,n,e);return t&&new Wa(t)}function TU(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Wa(r)}}var DU={provide:Ga,deps:[[new At,Oy]]},bU={provide:Wa,useFactory:wU,deps:[[new At,Oy],Ln]};function fK(n,...e){return Ne("angularfire",Fn.full,"auth"),No([bU,DU,{provide:Oy,useFactory:TU(n),multi:!0,deps:[xe,Et,mr,Ti,[new At,Bo],...e]}])}var pK=j(xy,!0);var gK=j(Ny,!0);var mK=j(ky,!0,2);var yK=j(Ry,!0,2);var MS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},kS={};var Un,Fy;(function(){var n;function e(T,_){function E(){}E.prototype=_.prototype,T.D=_.prototype,T.prototype=new E,T.prototype.constructor=T,T.C=function(D,b,A){for(var I=Array(arguments.length-2),Cn=2;Cn<arguments.length;Cn++)I[Cn-2]=arguments[Cn];return _.prototype[b].apply(D,I)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,_,E){E||(E=0);var D=Array(16);if(typeof _=="string")for(var b=0;16>b;++b)D[b]=_.charCodeAt(E++)|_.charCodeAt(E++)<<8|_.charCodeAt(E++)<<16|_.charCodeAt(E++)<<24;else for(b=0;16>b;++b)D[b]=_[E++]|_[E++]<<8|_[E++]<<16|_[E++]<<24;_=T.g[0],E=T.g[1],b=T.g[2];var A=T.g[3],I=_+(A^E&(b^A))+D[0]+3614090360&4294967295;_=E+(I<<7&4294967295|I>>>25),I=A+(b^_&(E^b))+D[1]+3905402710&4294967295,A=_+(I<<12&4294967295|I>>>20),I=b+(E^A&(_^E))+D[2]+606105819&4294967295,b=A+(I<<17&4294967295|I>>>15),I=E+(_^b&(A^_))+D[3]+3250441966&4294967295,E=b+(I<<22&4294967295|I>>>10),I=_+(A^E&(b^A))+D[4]+4118548399&4294967295,_=E+(I<<7&4294967295|I>>>25),I=A+(b^_&(E^b))+D[5]+1200080426&4294967295,A=_+(I<<12&4294967295|I>>>20),I=b+(E^A&(_^E))+D[6]+2821735955&4294967295,b=A+(I<<17&4294967295|I>>>15),I=E+(_^b&(A^_))+D[7]+4249261313&4294967295,E=b+(I<<22&4294967295|I>>>10),I=_+(A^E&(b^A))+D[8]+1770035416&4294967295,_=E+(I<<7&4294967295|I>>>25),I=A+(b^_&(E^b))+D[9]+2336552879&4294967295,A=_+(I<<12&4294967295|I>>>20),I=b+(E^A&(_^E))+D[10]+4294925233&4294967295,b=A+(I<<17&4294967295|I>>>15),I=E+(_^b&(A^_))+D[11]+2304563134&4294967295,E=b+(I<<22&4294967295|I>>>10),I=_+(A^E&(b^A))+D[12]+1804603682&4294967295,_=E+(I<<7&4294967295|I>>>25),I=A+(b^_&(E^b))+D[13]+4254626195&4294967295,A=_+(I<<12&4294967295|I>>>20),I=b+(E^A&(_^E))+D[14]+2792965006&4294967295,b=A+(I<<17&4294967295|I>>>15),I=E+(_^b&(A^_))+D[15]+1236535329&4294967295,E=b+(I<<22&4294967295|I>>>10),I=_+(b^A&(E^b))+D[1]+4129170786&4294967295,_=E+(I<<5&4294967295|I>>>27),I=A+(E^b&(_^E))+D[6]+3225465664&4294967295,A=_+(I<<9&4294967295|I>>>23),I=b+(_^E&(A^_))+D[11]+643717713&4294967295,b=A+(I<<14&4294967295|I>>>18),I=E+(A^_&(b^A))+D[0]+3921069994&4294967295,E=b+(I<<20&4294967295|I>>>12),I=_+(b^A&(E^b))+D[5]+3593408605&4294967295,_=E+(I<<5&4294967295|I>>>27),I=A+(E^b&(_^E))+D[10]+38016083&4294967295,A=_+(I<<9&4294967295|I>>>23),I=b+(_^E&(A^_))+D[15]+3634488961&4294967295,b=A+(I<<14&4294967295|I>>>18),I=E+(A^_&(b^A))+D[4]+3889429448&4294967295,E=b+(I<<20&4294967295|I>>>12),I=_+(b^A&(E^b))+D[9]+568446438&4294967295,_=E+(I<<5&4294967295|I>>>27),I=A+(E^b&(_^E))+D[14]+3275163606&4294967295,A=_+(I<<9&4294967295|I>>>23),I=b+(_^E&(A^_))+D[3]+4107603335&4294967295,b=A+(I<<14&4294967295|I>>>18),I=E+(A^_&(b^A))+D[8]+1163531501&4294967295,E=b+(I<<20&4294967295|I>>>12),I=_+(b^A&(E^b))+D[13]+2850285829&4294967295,_=E+(I<<5&4294967295|I>>>27),I=A+(E^b&(_^E))+D[2]+4243563512&4294967295,A=_+(I<<9&4294967295|I>>>23),I=b+(_^E&(A^_))+D[7]+1735328473&4294967295,b=A+(I<<14&4294967295|I>>>18),I=E+(A^_&(b^A))+D[12]+2368359562&4294967295,E=b+(I<<20&4294967295|I>>>12),I=_+(E^b^A)+D[5]+4294588738&4294967295,_=E+(I<<4&4294967295|I>>>28),I=A+(_^E^b)+D[8]+2272392833&4294967295,A=_+(I<<11&4294967295|I>>>21),I=b+(A^_^E)+D[11]+1839030562&4294967295,b=A+(I<<16&4294967295|I>>>16),I=E+(b^A^_)+D[14]+4259657740&4294967295,E=b+(I<<23&4294967295|I>>>9),I=_+(E^b^A)+D[1]+2763975236&4294967295,_=E+(I<<4&4294967295|I>>>28),I=A+(_^E^b)+D[4]+1272893353&4294967295,A=_+(I<<11&4294967295|I>>>21),I=b+(A^_^E)+D[7]+4139469664&4294967295,b=A+(I<<16&4294967295|I>>>16),I=E+(b^A^_)+D[10]+3200236656&4294967295,E=b+(I<<23&4294967295|I>>>9),I=_+(E^b^A)+D[13]+681279174&4294967295,_=E+(I<<4&4294967295|I>>>28),I=A+(_^E^b)+D[0]+3936430074&4294967295,A=_+(I<<11&4294967295|I>>>21),I=b+(A^_^E)+D[3]+3572445317&4294967295,b=A+(I<<16&4294967295|I>>>16),I=E+(b^A^_)+D[6]+76029189&4294967295,E=b+(I<<23&4294967295|I>>>9),I=_+(E^b^A)+D[9]+3654602809&4294967295,_=E+(I<<4&4294967295|I>>>28),I=A+(_^E^b)+D[12]+3873151461&4294967295,A=_+(I<<11&4294967295|I>>>21),I=b+(A^_^E)+D[15]+530742520&4294967295,b=A+(I<<16&4294967295|I>>>16),I=E+(b^A^_)+D[2]+3299628645&4294967295,E=b+(I<<23&4294967295|I>>>9),I=_+(b^(E|~A))+D[0]+4096336452&4294967295,_=E+(I<<6&4294967295|I>>>26),I=A+(E^(_|~b))+D[7]+1126891415&4294967295,A=_+(I<<10&4294967295|I>>>22),I=b+(_^(A|~E))+D[14]+2878612391&4294967295,b=A+(I<<15&4294967295|I>>>17),I=E+(A^(b|~_))+D[5]+4237533241&4294967295,E=b+(I<<21&4294967295|I>>>11),I=_+(b^(E|~A))+D[12]+1700485571&4294967295,_=E+(I<<6&4294967295|I>>>26),I=A+(E^(_|~b))+D[3]+2399980690&4294967295,A=_+(I<<10&4294967295|I>>>22),I=b+(_^(A|~E))+D[10]+4293915773&4294967295,b=A+(I<<15&4294967295|I>>>17),I=E+(A^(b|~_))+D[1]+2240044497&4294967295,E=b+(I<<21&4294967295|I>>>11),I=_+(b^(E|~A))+D[8]+1873313359&4294967295,_=E+(I<<6&4294967295|I>>>26),I=A+(E^(_|~b))+D[15]+4264355552&4294967295,A=_+(I<<10&4294967295|I>>>22),I=b+(_^(A|~E))+D[6]+2734768916&4294967295,b=A+(I<<15&4294967295|I>>>17),I=E+(A^(b|~_))+D[13]+1309151649&4294967295,E=b+(I<<21&4294967295|I>>>11),I=_+(b^(E|~A))+D[4]+4149444226&4294967295,_=E+(I<<6&4294967295|I>>>26),I=A+(E^(_|~b))+D[11]+3174756917&4294967295,A=_+(I<<10&4294967295|I>>>22),I=b+(_^(A|~E))+D[2]+718787259&4294967295,b=A+(I<<15&4294967295|I>>>17),I=E+(A^(b|~_))+D[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(b+(I<<21&4294967295|I>>>11))&4294967295,T.g[2]=T.g[2]+b&4294967295,T.g[3]=T.g[3]+A&4294967295}r.prototype.u=function(T,_){_===void 0&&(_=T.length);for(var E=_-this.blockSize,D=this.B,b=this.h,A=0;A<_;){if(b==0)for(;A<=E;)i(this,T,A),A+=this.blockSize;if(typeof T=="string"){for(;A<_;)if(D[b++]=T.charCodeAt(A++),b==this.blockSize){i(this,D),b=0;break}}else for(;A<_;)if(D[b++]=T[A++],b==this.blockSize){i(this,D),b=0;break}}this.h=b,this.o+=_},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;var E=8*this.o;for(_=T.length-8;_<T.length;++_)T[_]=E&255,E/=256;for(this.u(T),T=Array(16),_=E=0;4>_;++_)for(var D=0;32>D;D+=8)T[E++]=this.g[_]>>>D&255;return T};function o(T,_){var E=a;return Object.prototype.hasOwnProperty.call(E,T)?E[T]:E[T]=_(T)}function s(T,_){this.h=_;for(var E=[],D=!0,b=T.length-1;0<=b;b--){var A=T[b]|0;D&&A==_||(E[b]=A,D=!1)}this.g=E}var a={};function c(T){return-128<=T&&128>T?o(T,function(_){return new s([_|0],0>_?-1:0)}):new s([T|0],0>T?-1:0)}function l(T){if(isNaN(T)||!isFinite(T))return f;if(0>T)return P(l(-T));for(var _=[],E=1,D=0;T>=E;D++)_[D]=T/E|0,E*=4294967296;return new s(_,0)}function d(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return P(d(T.substring(1),_));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=l(Math.pow(_,8)),D=f,b=0;b<T.length;b+=8){var A=Math.min(8,T.length-b),I=parseInt(T.substring(b,b+A),_);8>A?(A=l(Math.pow(_,A)),D=D.j(A).add(l(I))):(D=D.j(E),D=D.add(l(I)))}return D}var f=c(0),g=c(1),m=c(16777216);n=s.prototype,n.m=function(){if(R(this))return-P(this).m();for(var T=0,_=1,E=0;E<this.g.length;E++){var D=this.i(E);T+=(0<=D?D:4294967296+D)*_,_*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(w(this))return"0";if(R(this))return"-"+P(this).toString(T);for(var _=l(Math.pow(T,6)),E=this,D="";;){var b=W(E,_).g;E=O(E,b.j(_));var A=((0<E.g.length?E.g[0]:E.h)>>>0).toString(T);if(E=b,w(E))return A+D;for(;6>A.length;)A="0"+A;D=A+D}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function w(T){if(T.h!=0)return!1;for(var _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function R(T){return T.h==-1}n.l=function(T){return T=O(this,T),R(T)?-1:w(T)?0:1};function P(T){for(var _=T.g.length,E=[],D=0;D<_;D++)E[D]=~T.g[D];return new s(E,~T.h).add(g)}n.abs=function(){return R(this)?P(this):this},n.add=function(T){for(var _=Math.max(this.g.length,T.g.length),E=[],D=0,b=0;b<=_;b++){var A=D+(this.i(b)&65535)+(T.i(b)&65535),I=(A>>>16)+(this.i(b)>>>16)+(T.i(b)>>>16);D=I>>>16,A&=65535,I&=65535,E[b]=I<<16|A}return new s(E,E[E.length-1]&-2147483648?-1:0)};function O(T,_){return T.add(P(_))}n.j=function(T){if(w(this)||w(T))return f;if(R(this))return R(T)?P(this).j(P(T)):P(P(this).j(T));if(R(T))return P(this.j(P(T)));if(0>this.l(m)&&0>T.l(m))return l(this.m()*T.m());for(var _=this.g.length+T.g.length,E=[],D=0;D<2*_;D++)E[D]=0;for(D=0;D<this.g.length;D++)for(var b=0;b<T.g.length;b++){var A=this.i(D)>>>16,I=this.i(D)&65535,Cn=T.i(b)>>>16,Ls=T.i(b)&65535;E[2*D+2*b]+=I*Ls,B(E,2*D+2*b),E[2*D+2*b+1]+=A*Ls,B(E,2*D+2*b+1),E[2*D+2*b+1]+=I*Cn,B(E,2*D+2*b+1),E[2*D+2*b+2]+=A*Cn,B(E,2*D+2*b+2)}for(D=0;D<_;D++)E[D]=E[2*D+1]<<16|E[2*D];for(D=_;D<2*_;D++)E[D]=0;return new s(E,0)};function B(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function U(T,_){this.g=T,this.h=_}function W(T,_){if(w(_))throw Error("division by zero");if(w(T))return new U(f,f);if(R(T))return _=W(P(T),_),new U(P(_.g),P(_.h));if(R(_))return _=W(T,P(_)),new U(P(_.g),_.h);if(30<T.g.length){if(R(T)||R(_))throw Error("slowDivide_ only works with positive integers.");for(var E=g,D=_;0>=D.l(T);)E=de(E),D=de(D);var b=K(E,1),A=K(D,1);for(D=K(D,2),E=K(E,2);!w(D);){var I=A.add(D);0>=I.l(T)&&(b=b.add(E),A=I),D=K(D,1),E=K(E,1)}return _=O(T,b.j(_)),new U(b,_)}for(b=f;0<=T.l(_);){for(E=Math.max(1,Math.floor(T.m()/_.m())),D=Math.ceil(Math.log(E)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),A=l(E),I=A.j(_);R(I)||0<I.l(T);)E-=D,A=l(E),I=A.j(_);w(A)&&(A=g),b=b.add(A),T=O(T,I)}return new U(b,T)}n.A=function(T){return W(this,T).h},n.and=function(T){for(var _=Math.max(this.g.length,T.g.length),E=[],D=0;D<_;D++)E[D]=this.i(D)&T.i(D);return new s(E,this.h&T.h)},n.or=function(T){for(var _=Math.max(this.g.length,T.g.length),E=[],D=0;D<_;D++)E[D]=this.i(D)|T.i(D);return new s(E,this.h|T.h)},n.xor=function(T){for(var _=Math.max(this.g.length,T.g.length),E=[],D=0;D<_;D++)E[D]=this.i(D)^T.i(D);return new s(E,this.h^T.h)};function de(T){for(var _=T.g.length+1,E=[],D=0;D<_;D++)E[D]=T.i(D)<<1|T.i(D-1)>>>31;return new s(E,T.h)}function K(T,_){var E=_>>5;_%=32;for(var D=T.g.length-E,b=[],A=0;A<D;A++)b[A]=0<_?T.i(A+E)>>>_|T.i(A+E+1)<<32-_:T.i(A+E);return new s(b,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Fy=kS.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=d,Un=kS.Integer=s}).apply(typeof MS<"u"?MS:typeof self<"u"?self:typeof window<"u"?window:{});var Bd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$n={};var Ly,CU,Ho,Vy,Ka,Ud,jy,By,Uy;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,h,p){return u==Array.prototype||u==Object.prototype||(u[h]=p.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Bd=="object"&&Bd];for(var h=0;h<u.length;++h){var p=u[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(u,h){if(h)e:{var p=r;u=u.split(".");for(var y=0;y<u.length-1;y++){var C=u[y];if(!(C in p))break e;p=p[C]}u=u[u.length-1],y=p[u],h=h(y),h!=y&&h!=null&&e(p,u,{configurable:!0,writable:!0,value:h})}}function o(u,h){u instanceof String&&(u+="");var p=0,y=!1,C={next:function(){if(!y&&p<u.length){var M=p++;return{value:h(M,u[M]),done:!1}}return y=!0,{done:!0,value:void 0}}};return C[Symbol.iterator]=function(){return C},C}i("Array.prototype.values",function(u){return u||function(){return o(this,function(h,p){return p})}});var s=s||{},a=this||self;function c(u){var h=typeof u;return h=h!="object"?h:u?Array.isArray(u)?"array":h:"null",h=="array"||h=="object"&&typeof u.length=="number"}function l(u){var h=typeof u;return h=="object"&&u!=null||h=="function"}function d(u,h,p){return u.call.apply(u.bind,arguments)}function f(u,h,p){if(!u)throw Error();if(2<arguments.length){var y=Array.prototype.slice.call(arguments,2);return function(){var C=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(C,y),u.apply(h,C)}}return function(){return u.apply(h,arguments)}}function g(u,h,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,g.apply(null,arguments)}function m(u,h){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),u.apply(this,y)}}function w(u,h){function p(){}p.prototype=h.prototype,u.aa=h.prototype,u.prototype=new p,u.prototype.constructor=u,u.Qb=function(y,C,M){for(var L=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)L[_e-2]=arguments[_e];return h.prototype[C].apply(y,L)}}function R(u){let h=u.length;if(0<h){let p=Array(h);for(let y=0;y<h;y++)p[y]=u[y];return p}return[]}function P(u,h){for(let p=1;p<arguments.length;p++){let y=arguments[p];if(c(y)){let C=u.length||0,M=y.length||0;u.length=C+M;for(let L=0;L<M;L++)u[C+L]=y[L]}else u.push(y)}}class O{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function B(u){return/^[\s\xa0]*$/.test(u)}function U(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function W(u){return W[" "](u),u}W[" "]=function(){};var de=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function K(u,h,p){for(let y in u)h.call(p,u[y],y,u)}function T(u,h){for(let p in u)h.call(void 0,u[p],p,u)}function _(u){let h={};for(let p in u)h[p]=u[p];return h}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(u,h){let p,y;for(let C=1;C<arguments.length;C++){y=arguments[C];for(p in y)u[p]=y[p];for(let M=0;M<E.length;M++)p=E[M],Object.prototype.hasOwnProperty.call(y,p)&&(u[p]=y[p])}}function b(u){var h=1;u=u.split(":");let p=[];for(;0<h&&u.length;)p.push(u.shift()),h--;return u.length&&p.push(u.join(":")),p}function A(u){a.setTimeout(()=>{throw u},0)}function I(){var u=Af;let h=null;return u.g&&(h=u.g,u.g=u.g.next,u.g||(u.h=null),h.next=null),h}class Cn{constructor(){this.h=this.g=null}add(h,p){let y=Ls.get();y.set(h,p),this.h?this.h.next=y:this.g=y,this.h=y}}var Ls=new O(()=>new hP,u=>u.reset());class hP{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Vs,js=!1,Af=new Cn,XI=()=>{let u=a.Promise.resolve(void 0);Vs=()=>{u.then(fP)}};var fP=()=>{for(var u;u=I();){try{u.h.call(u.g)}catch(p){A(p)}var h=Ls;h.j(u),100>h.h&&(h.h++,u.next=h.g,h.g=u)}js=!1};function er(){this.s=this.s,this.C=this.C}er.prototype.s=!1,er.prototype.ma=function(){this.s||(this.s=!0,this.N())},er.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function et(u,h){this.type=u,this.g=this.target=h,this.defaultPrevented=!1}et.prototype.h=function(){this.defaultPrevented=!0};var pP=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,h=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return u}();function Bs(u,h){if(et.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var p=this.type=u.type,y=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=h,h=u.relatedTarget){if(de){e:{try{W(h.nodeName);var C=!0;break e}catch{}C=!1}C||(h=null)}}else p=="mouseover"?h=u.fromElement:p=="mouseout"&&(h=u.toElement);this.relatedTarget=h,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:gP[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Bs.aa.h.call(this)}}w(Bs,et);var gP={2:"touch",3:"pen",4:"mouse"};Bs.prototype.h=function(){Bs.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Us="closure_listenable_"+(1e6*Math.random()|0),mP=0;function yP(u,h,p,y,C){this.listener=u,this.proxy=null,this.src=h,this.type=p,this.capture=!!y,this.ha=C,this.key=++mP,this.da=this.fa=!1}function Zc(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Jc(u){this.src=u,this.g={},this.h=0}Jc.prototype.add=function(u,h,p,y,C){var M=u.toString();u=this.g[M],u||(u=this.g[M]=[],this.h++);var L=Rf(u,h,y,C);return-1<L?(h=u[L],p||(h.fa=!1)):(h=new yP(h,this.src,M,!!y,C),h.fa=p,u.push(h)),h};function Nf(u,h){var p=h.type;if(p in u.g){var y=u.g[p],C=Array.prototype.indexOf.call(y,h,void 0),M;(M=0<=C)&&Array.prototype.splice.call(y,C,1),M&&(Zc(h),u.g[p].length==0&&(delete u.g[p],u.h--))}}function Rf(u,h,p,y){for(var C=0;C<u.length;++C){var M=u[C];if(!M.da&&M.listener==h&&M.capture==!!p&&M.ha==y)return C}return-1}var Pf="closure_lm_"+(1e6*Math.random()|0),Mf={};function eE(u,h,p,y,C){if(y&&y.once)return nE(u,h,p,y,C);if(Array.isArray(h)){for(var M=0;M<h.length;M++)eE(u,h[M],p,y,C);return null}return p=Ff(p),u&&u[Us]?u.K(h,p,l(y)?!!y.capture:!!y,C):tE(u,h,p,!1,y,C)}function tE(u,h,p,y,C,M){if(!h)throw Error("Invalid event type");var L=l(C)?!!C.capture:!!C,_e=xf(u);if(_e||(u[Pf]=_e=new Jc(u)),p=_e.add(h,p,y,L,M),p.proxy)return p;if(y=vP(),p.proxy=y,y.src=u,y.listener=p,u.addEventListener)pP||(C=L),C===void 0&&(C=!1),u.addEventListener(h.toString(),y,C);else if(u.attachEvent)u.attachEvent(iE(h.toString()),y);else if(u.addListener&&u.removeListener)u.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function vP(){function u(p){return h.call(u.src,u.listener,p)}let h=_P;return u}function nE(u,h,p,y,C){if(Array.isArray(h)){for(var M=0;M<h.length;M++)nE(u,h[M],p,y,C);return null}return p=Ff(p),u&&u[Us]?u.L(h,p,l(y)?!!y.capture:!!y,C):tE(u,h,p,!0,y,C)}function rE(u,h,p,y,C){if(Array.isArray(h))for(var M=0;M<h.length;M++)rE(u,h[M],p,y,C);else y=l(y)?!!y.capture:!!y,p=Ff(p),u&&u[Us]?(u=u.i,h=String(h).toString(),h in u.g&&(M=u.g[h],p=Rf(M,p,y,C),-1<p&&(Zc(M[p]),Array.prototype.splice.call(M,p,1),M.length==0&&(delete u.g[h],u.h--)))):u&&(u=xf(u))&&(h=u.g[h.toString()],u=-1,h&&(u=Rf(h,p,y,C)),(p=-1<u?h[u]:null)&&kf(p))}function kf(u){if(typeof u!="number"&&u&&!u.da){var h=u.src;if(h&&h[Us])Nf(h.i,u);else{var p=u.type,y=u.proxy;h.removeEventListener?h.removeEventListener(p,y,u.capture):h.detachEvent?h.detachEvent(iE(p),y):h.addListener&&h.removeListener&&h.removeListener(y),(p=xf(h))?(Nf(p,u),p.h==0&&(p.src=null,h[Pf]=null)):Zc(u)}}}function iE(u){return u in Mf?Mf[u]:Mf[u]="on"+u}function _P(u,h){if(u.da)u=!0;else{h=new Bs(h,this);var p=u.listener,y=u.ha||u.src;u.fa&&kf(u),u=p.call(y,h)}return u}function xf(u){return u=u[Pf],u instanceof Jc?u:null}var Of="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ff(u){return typeof u=="function"?u:(u[Of]||(u[Of]=function(h){return u.handleEvent(h)}),u[Of])}function tt(){er.call(this),this.i=new Jc(this),this.M=this,this.F=null}w(tt,er),tt.prototype[Us]=!0,tt.prototype.removeEventListener=function(u,h,p,y){rE(this,u,h,p,y)};function ct(u,h){var p,y=u.F;if(y)for(p=[];y;y=y.F)p.push(y);if(u=u.M,y=h.type||h,typeof h=="string")h=new et(h,u);else if(h instanceof et)h.target=h.target||u;else{var C=h;h=new et(y,u),D(h,C)}if(C=!0,p)for(var M=p.length-1;0<=M;M--){var L=h.g=p[M];C=Xc(L,y,!0,h)&&C}if(L=h.g=u,C=Xc(L,y,!0,h)&&C,C=Xc(L,y,!1,h)&&C,p)for(M=0;M<p.length;M++)L=h.g=p[M],C=Xc(L,y,!1,h)&&C}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var u=this.i,h;for(h in u.g){for(var p=u.g[h],y=0;y<p.length;y++)Zc(p[y]);delete u.g[h],u.h--}}this.F=null},tt.prototype.K=function(u,h,p,y){return this.i.add(String(u),h,!1,p,y)},tt.prototype.L=function(u,h,p,y){return this.i.add(String(u),h,!0,p,y)};function Xc(u,h,p,y){if(h=u.i.g[String(h)],!h)return!0;h=h.concat();for(var C=!0,M=0;M<h.length;++M){var L=h[M];if(L&&!L.da&&L.capture==p){var _e=L.listener,Ye=L.ha||L.src;L.fa&&Nf(u.i,L),C=_e.call(Ye,y)!==!1&&C}}return C&&!y.defaultPrevented}function oE(u,h,p){if(typeof u=="function")p&&(u=g(u,p));else if(u&&typeof u.handleEvent=="function")u=g(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(u,h||0)}function sE(u){u.g=oE(()=>{u.g=null,u.i&&(u.i=!1,sE(u))},u.l);let h=u.h;u.h=null,u.m.apply(null,h)}class IP extends er{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:sE(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $s(u){er.call(this),this.h=u,this.g={}}w($s,er);var aE=[];function cE(u){K(u.g,function(h,p){this.g.hasOwnProperty(p)&&kf(h)},u),u.g={}}$s.prototype.N=function(){$s.aa.N.call(this),cE(this)},$s.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Lf=a.JSON.stringify,EP=a.JSON.parse,wP=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Vf(){}Vf.prototype.h=null;function uE(u){return u.h||(u.h=u.i())}function lE(){}var Hs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function jf(){et.call(this,"d")}w(jf,et);function Bf(){et.call(this,"c")}w(Bf,et);var Gr={},dE=null;function eu(){return dE=dE||new tt}Gr.La="serverreachability";function hE(u){et.call(this,Gr.La,u)}w(hE,et);function qs(u){let h=eu();ct(h,new hE(h))}Gr.STAT_EVENT="statevent";function fE(u,h){et.call(this,Gr.STAT_EVENT,u),this.stat=h}w(fE,et);function ut(u){let h=eu();ct(h,new fE(h,u))}Gr.Ma="timingevent";function pE(u,h){et.call(this,Gr.Ma,u),this.size=h}w(pE,et);function zs(u,h){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},h)}function Ws(){this.g=!0}Ws.prototype.xa=function(){this.g=!1};function TP(u,h,p,y,C,M){u.info(function(){if(u.g)if(M)for(var L="",_e=M.split("&"),Ye=0;Ye<_e.length;Ye++){var pe=_e[Ye].split("=");if(1<pe.length){var nt=pe[0];pe=pe[1];var rt=nt.split("_");L=2<=rt.length&&rt[1]=="type"?L+(nt+"="+pe+"&"):L+(nt+"=redacted&")}}else L=null;else L=M;return"XMLHTTP REQ ("+y+") [attempt "+C+"]: "+h+`
`+p+`
`+L})}function DP(u,h,p,y,C,M,L){u.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+C+"]: "+h+`
`+p+`
`+M+" "+L})}function eo(u,h,p,y){u.info(function(){return"XMLHTTP TEXT ("+h+"): "+CP(u,p)+(y?" "+y:"")})}function bP(u,h){u.info(function(){return"TIMEOUT: "+h})}Ws.prototype.info=function(){};function CP(u,h){if(!u.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(u=0;u<p.length;u++)if(Array.isArray(p[u])){var y=p[u];if(!(2>y.length)){var C=y[1];if(Array.isArray(C)&&!(1>C.length)){var M=C[0];if(M!="noop"&&M!="stop"&&M!="close")for(var L=1;L<C.length;L++)C[L]=""}}}}return Lf(p)}catch{return h}}var tu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gE={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Uf;function nu(){}w(nu,Vf),nu.prototype.g=function(){return new XMLHttpRequest},nu.prototype.i=function(){return{}},Uf=new nu;function tr(u,h,p,y){this.j=u,this.i=h,this.l=p,this.R=y||1,this.U=new $s(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new mE}function mE(){this.i=null,this.g="",this.h=!1}var yE={},$f={};function Hf(u,h,p){u.L=1,u.v=su(Sn(h)),u.m=p,u.P=!0,vE(u,null)}function vE(u,h){u.F=Date.now(),ru(u),u.A=Sn(u.v);var p=u.A,y=u.R;Array.isArray(y)||(y=[String(y)]),ME(p.i,"t",y),u.C=0,p=u.j.J,u.h=new mE,u.g=YE(u.j,p?h:null,!u.m),0<u.O&&(u.M=new IP(g(u.Y,u,u.g),u.O)),h=u.U,p=u.g,y=u.ca;var C="readystatechange";Array.isArray(C)||(C&&(aE[0]=C.toString()),C=aE);for(var M=0;M<C.length;M++){var L=eE(p,C[M],y||h.handleEvent,!1,h.h||h);if(!L)break;h.g[L.key]=L}h=u.H?_(u.H):{},u.m?(u.u||(u.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,h)):(u.u="GET",u.g.ea(u.A,u.u,null,h)),qs(),TP(u.i,u.u,u.A,u.l,u.R,u.m)}tr.prototype.ca=function(u){u=u.target;let h=this.M;h&&An(u)==3?h.j():this.Y(u)},tr.prototype.Y=function(u){try{if(u==this.g)e:{let rt=An(this.g);var h=this.g.Ba();let ro=this.g.Z();if(!(3>rt)&&(rt!=3||this.g&&(this.h.h||this.g.oa()||jE(this.g)))){this.J||rt!=4||h==7||(h==8||0>=ro?qs(3):qs(2)),qf(this);var p=this.g.Z();this.X=p;t:if(_E(this)){var y=jE(this.g);u="";var C=y.length,M=An(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Kr(this),Gs(this);var L="";break t}this.h.i=new a.TextDecoder}for(h=0;h<C;h++)this.h.h=!0,u+=this.h.i.decode(y[h],{stream:!(M&&h==C-1)});y.length=0,this.h.g+=u,this.C=0,L=this.h.g}else L=this.g.oa();if(this.o=p==200,DP(this.i,this.u,this.A,this.l,this.R,rt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var _e,Ye=this.g;if((_e=Ye.g?Ye.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(_e)){var pe=_e;break t}}pe=null}if(p=pe)eo(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zf(this,p);else{this.o=!1,this.s=3,ut(12),Kr(this),Gs(this);break e}}if(this.P){p=!0;let Ht;for(;!this.J&&this.C<L.length;)if(Ht=SP(this,L),Ht==$f){rt==4&&(this.s=4,ut(14),p=!1),eo(this.i,this.l,null,"[Incomplete Response]");break}else if(Ht==yE){this.s=4,ut(15),eo(this.i,this.l,L,"[Invalid Chunk]"),p=!1;break}else eo(this.i,this.l,Ht,null),zf(this,Ht);if(_E(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),rt!=4||L.length!=0||this.h.h||(this.s=1,ut(16),p=!1),this.o=this.o&&p,!p)eo(this.i,this.l,L,"[Invalid Chunked Response]"),Kr(this),Gs(this);else if(0<L.length&&!this.W){this.W=!0;var nt=this.j;nt.g==this&&nt.ba&&!nt.M&&(nt.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),Zf(nt),nt.M=!0,ut(11))}}else eo(this.i,this.l,L,null),zf(this,L);rt==4&&Kr(this),this.o&&!this.J&&(rt==4?WE(this.j,this):(this.o=!1,ru(this)))}else qP(this.g),p==400&&0<L.indexOf("Unknown SID")?(this.s=3,ut(12)):(this.s=0,ut(13)),Kr(this),Gs(this)}}}catch{}finally{}};function _E(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function SP(u,h){var p=u.C,y=h.indexOf(`
`,p);return y==-1?$f:(p=Number(h.substring(p,y)),isNaN(p)?yE:(y+=1,y+p>h.length?$f:(h=h.slice(y,y+p),u.C=y+p,h)))}tr.prototype.cancel=function(){this.J=!0,Kr(this)};function ru(u){u.S=Date.now()+u.I,IE(u,u.I)}function IE(u,h){if(u.B!=null)throw Error("WatchDog timer not null");u.B=zs(g(u.ba,u),h)}function qf(u){u.B&&(a.clearTimeout(u.B),u.B=null)}tr.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(bP(this.i,this.A),this.L!=2&&(qs(),ut(17)),Kr(this),this.s=2,Gs(this)):IE(this,this.S-u)};function Gs(u){u.j.G==0||u.J||WE(u.j,u)}function Kr(u){qf(u);var h=u.M;h&&typeof h.ma=="function"&&h.ma(),u.M=null,cE(u.U),u.g&&(h=u.g,u.g=null,h.abort(),h.ma())}function zf(u,h){try{var p=u.j;if(p.G!=0&&(p.g==u||Wf(p.h,u))){if(!u.K&&Wf(p.h,u)&&p.G==3){try{var y=p.Da.g.parse(h)}catch{y=null}if(Array.isArray(y)&&y.length==3){var C=y;if(C[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<u.F)du(p),uu(p);else break e;Yf(p),ut(18)}}else p.za=C[1],0<p.za-p.T&&37500>C[2]&&p.F&&p.v==0&&!p.C&&(p.C=zs(g(p.Za,p),6e3));if(1>=TE(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Yr(p,11)}else if((u.K||p.g==u)&&du(p),!B(h))for(C=p.Da.g.parse(h),h=0;h<C.length;h++){let pe=C[h];if(p.T=pe[0],pe=pe[1],p.G==2)if(pe[0]=="c"){p.K=pe[1],p.ia=pe[2];let nt=pe[3];nt!=null&&(p.la=nt,p.j.info("VER="+p.la));let rt=pe[4];rt!=null&&(p.Aa=rt,p.j.info("SVER="+p.Aa));let ro=pe[5];ro!=null&&typeof ro=="number"&&0<ro&&(y=1.5*ro,p.L=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;let Ht=u.g;if(Ht){let fu=Ht.g?Ht.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fu){var M=y.h;M.g||fu.indexOf("spdy")==-1&&fu.indexOf("quic")==-1&&fu.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Gf(M,M.h),M.h=null))}if(y.D){let Jf=Ht.g?Ht.g.getResponseHeader("X-HTTP-Session-Id"):null;Jf&&(y.ya=Jf,we(y.I,y.D,Jf))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-u.F,p.j.info("Handshake RTT: "+p.R+"ms")),y=p;var L=u;if(y.qa=QE(y,y.J?y.ia:null,y.W),L.K){DE(y.h,L);var _e=L,Ye=y.L;Ye&&(_e.I=Ye),_e.B&&(qf(_e),ru(_e)),y.g=L}else qE(y);0<p.i.length&&lu(p)}else pe[0]!="stop"&&pe[0]!="close"||Yr(p,7);else p.G==3&&(pe[0]=="stop"||pe[0]=="close"?pe[0]=="stop"?Yr(p,7):Qf(p):pe[0]!="noop"&&p.l&&p.l.ta(pe),p.v=0)}}qs(4)}catch{}}var AP=class{constructor(u,h){this.g=u,this.map=h}};function EE(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function wE(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function TE(u){return u.h?1:u.g?u.g.size:0}function Wf(u,h){return u.h?u.h==h:u.g?u.g.has(h):!1}function Gf(u,h){u.g?u.g.add(h):u.h=h}function DE(u,h){u.h&&u.h==h?u.h=null:u.g&&u.g.has(h)&&u.g.delete(h)}EE.prototype.cancel=function(){if(this.i=bE(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function bE(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let h=u.i;for(let p of u.g.values())h=h.concat(p.D);return h}return R(u.i)}function NP(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var h=[],p=u.length,y=0;y<p;y++)h.push(u[y]);return h}h=[],p=0;for(y in u)h[p++]=u[y];return h}function RP(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var h=[];u=u.length;for(var p=0;p<u;p++)h.push(p);return h}h=[],p=0;for(let y in u)h[p++]=y;return h}}}function CE(u,h){if(u.forEach&&typeof u.forEach=="function")u.forEach(h,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,h,void 0);else for(var p=RP(u),y=NP(u),C=y.length,M=0;M<C;M++)h.call(void 0,y[M],p&&p[M],u)}var SE=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function PP(u,h){if(u){u=u.split("&");for(var p=0;p<u.length;p++){var y=u[p].indexOf("="),C=null;if(0<=y){var M=u[p].substring(0,y);C=u[p].substring(y+1)}else M=u[p];h(M,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function Qr(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Qr){this.h=u.h,iu(this,u.j),this.o=u.o,this.g=u.g,ou(this,u.s),this.l=u.l;var h=u.i,p=new Ys;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),AE(this,p),this.m=u.m}else u&&(h=String(u).match(SE))?(this.h=!1,iu(this,h[1]||"",!0),this.o=Ks(h[2]||""),this.g=Ks(h[3]||"",!0),ou(this,h[4]),this.l=Ks(h[5]||"",!0),AE(this,h[6]||"",!0),this.m=Ks(h[7]||"")):(this.h=!1,this.i=new Ys(null,this.h))}Qr.prototype.toString=function(){var u=[],h=this.j;h&&u.push(Qs(h,NE,!0),":");var p=this.g;return(p||h=="file")&&(u.push("//"),(h=this.o)&&u.push(Qs(h,NE,!0),"@"),u.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&u.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&u.push("/"),u.push(Qs(p,p.charAt(0)=="/"?xP:kP,!0))),(p=this.i.toString())&&u.push("?",p),(p=this.m)&&u.push("#",Qs(p,FP)),u.join("")};function Sn(u){return new Qr(u)}function iu(u,h,p){u.j=p?Ks(h,!0):h,u.j&&(u.j=u.j.replace(/:$/,""))}function ou(u,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);u.s=h}else u.s=null}function AE(u,h,p){h instanceof Ys?(u.i=h,LP(u.i,u.h)):(p||(h=Qs(h,OP)),u.i=new Ys(h,u.h))}function we(u,h,p){u.i.set(h,p)}function su(u){return we(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Ks(u,h){return u?h?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Qs(u,h,p){return typeof u=="string"?(u=encodeURI(u).replace(h,MP),p&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function MP(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var NE=/[#\/\?@]/g,kP=/[#\?:]/g,xP=/[#\?]/g,OP=/[#\?@]/g,FP=/#/g;function Ys(u,h){this.h=this.g=null,this.i=u||null,this.j=!!h}function nr(u){u.g||(u.g=new Map,u.h=0,u.i&&PP(u.i,function(h,p){u.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=Ys.prototype,n.add=function(u,h){nr(this),this.i=null,u=to(this,u);var p=this.g.get(u);return p||this.g.set(u,p=[]),p.push(h),this.h+=1,this};function RE(u,h){nr(u),h=to(u,h),u.g.has(h)&&(u.i=null,u.h-=u.g.get(h).length,u.g.delete(h))}function PE(u,h){return nr(u),h=to(u,h),u.g.has(h)}n.forEach=function(u,h){nr(this),this.g.forEach(function(p,y){p.forEach(function(C){u.call(h,C,y,this)},this)},this)},n.na=function(){nr(this);let u=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let y=0;y<h.length;y++){let C=u[y];for(let M=0;M<C.length;M++)p.push(h[y])}return p},n.V=function(u){nr(this);let h=[];if(typeof u=="string")PE(this,u)&&(h=h.concat(this.g.get(to(this,u))));else{u=Array.from(this.g.values());for(let p=0;p<u.length;p++)h=h.concat(u[p])}return h},n.set=function(u,h){return nr(this),this.i=null,u=to(this,u),PE(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[h]),this.h+=1,this},n.get=function(u,h){return u?(u=this.V(u),0<u.length?String(u[0]):h):h};function ME(u,h,p){RE(u,h),0<p.length&&(u.i=null,u.g.set(to(u,h),R(p)),u.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var y=h[p];let M=encodeURIComponent(String(y)),L=this.V(y);for(y=0;y<L.length;y++){var C=M;L[y]!==""&&(C+="="+encodeURIComponent(String(L[y]))),u.push(C)}}return this.i=u.join("&")};function to(u,h){return h=String(h),u.j&&(h=h.toLowerCase()),h}function LP(u,h){h&&!u.j&&(nr(u),u.i=null,u.g.forEach(function(p,y){var C=y.toLowerCase();y!=C&&(RE(this,y),ME(this,C,p))},u)),u.j=h}function VP(u,h){let p=new Ws;if(a.Image){let y=new Image;y.onload=m(rr,p,"TestLoadImage: loaded",!0,h,y),y.onerror=m(rr,p,"TestLoadImage: error",!1,h,y),y.onabort=m(rr,p,"TestLoadImage: abort",!1,h,y),y.ontimeout=m(rr,p,"TestLoadImage: timeout",!1,h,y),a.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=u}else h(!1)}function jP(u,h){let p=new Ws,y=new AbortController,C=setTimeout(()=>{y.abort(),rr(p,"TestPingServer: timeout",!1,h)},1e4);fetch(u,{signal:y.signal}).then(M=>{clearTimeout(C),M.ok?rr(p,"TestPingServer: ok",!0,h):rr(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(C),rr(p,"TestPingServer: error",!1,h)})}function rr(u,h,p,y,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),y(p)}catch{}}function BP(){this.g=new wP}function UP(u,h,p){let y=p||"";try{CE(u,function(C,M){let L=C;l(C)&&(L=Lf(C)),h.push(y+M+"="+encodeURIComponent(L))})}catch(C){throw h.push(y+"type="+encodeURIComponent("_badmap")),C}}function Zs(u){this.l=u.Ub||null,this.j=u.eb||!1}w(Zs,Vf),Zs.prototype.g=function(){return new au(this.l,this.j)},Zs.prototype.i=function(u){return function(){return u}}({});function au(u,h){tt.call(this),this.D=u,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(au,tt),n=au.prototype,n.open=function(u,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=h,this.readyState=1,Xs(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(h.body=u),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Js(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Xs(this)),this.g&&(this.readyState=3,Xs(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;kE(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function kE(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var h=u.value?u.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!u.done}))&&(this.response=this.responseText+=h)}u.done?Js(this):Xs(this),this.readyState==3&&kE(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Js(this))},n.Qa=function(u){this.g&&(this.response=u,Js(this))},n.ga=function(){this.g&&Js(this)};function Js(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Xs(u)}n.setRequestHeader=function(u,h){this.u.append(u,h)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,u.push(p[0]+": "+p[1]),p=h.next();return u.join(`\r
`)};function Xs(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(au.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function xE(u){let h="";return K(u,function(p,y){h+=y,h+=":",h+=p,h+=`\r
`}),h}function Kf(u,h,p){e:{for(y in p){var y=!1;break e}y=!0}y||(p=xE(p),typeof u=="string"?p!=null&&encodeURIComponent(String(p)):we(u,h,p))}function Pe(u){tt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(Pe,tt);var $P=/^https?$/i,HP=["POST","PUT"];n=Pe.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,h,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);h=h?h.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Uf.g(),this.v=this.o?uE(this.o):uE(Uf),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(u),!0),this.B=!1}catch(M){OE(this,M);return}if(u=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var C in y)p.set(C,y[C]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(let M of y.keys())p.set(M,y.get(M));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(M=>M.toLowerCase()=="content-type"),C=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(HP,h,void 0))||y||C||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[M,L]of p)this.g.setRequestHeader(M,L);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{VE(this),this.u=!0,this.g.send(u),this.u=!1}catch(M){OE(this,M)}};function OE(u,h){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=h,u.m=5,FE(u),cu(u)}function FE(u){u.A||(u.A=!0,ct(u,"complete"),ct(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,ct(this,"complete"),ct(this,"abort"),cu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),cu(this,!0)),Pe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?LE(this):this.bb())},n.bb=function(){LE(this)};function LE(u){if(u.h&&typeof s<"u"&&(!u.v[1]||An(u)!=4||u.Z()!=2)){if(u.u&&An(u)==4)oE(u.Ea,0,u);else if(ct(u,"readystatechange"),An(u)==4){u.h=!1;try{let L=u.Z();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var y;if(y=L===0){var C=String(u.D).match(SE)[1]||null;!C&&a.self&&a.self.location&&(C=a.self.location.protocol.slice(0,-1)),y=!$P.test(C?C.toLowerCase():"")}p=y}if(p)ct(u,"complete"),ct(u,"success");else{u.m=6;try{var M=2<An(u)?u.g.statusText:""}catch{M=""}u.l=M+" ["+u.Z()+"]",FE(u)}}finally{cu(u)}}}}function cu(u,h){if(u.g){VE(u);let p=u.g,y=u.v[0]?()=>{}:null;u.g=null,u.v=null,h||ct(u,"ready");try{p.onreadystatechange=y}catch{}}}function VE(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function An(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<An(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var h=this.g.responseText;return u&&h.indexOf(u)==0&&(h=h.substring(u.length)),EP(h)}};function jE(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function qP(u){let h={};u=(u.g&&2<=An(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<u.length;y++){if(B(u[y]))continue;var p=b(u[y]);let C=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let M=h[C]||[];h[C]=M,M.push(p)}T(h,function(y){return y.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ea(u,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[u]||h}function BE(u){this.Aa=0,this.i=[],this.j=new Ws,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ea("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ea("baseRetryDelayMs",5e3,u),this.cb=ea("retryDelaySeedMs",1e4,u),this.Wa=ea("forwardChannelMaxRetries",2,u),this.wa=ea("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new EE(u&&u.concurrentRequestLimit),this.Da=new BP,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=BE.prototype,n.la=8,n.G=1,n.connect=function(u,h,p,y){ut(0),this.W=u,this.H=h||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.I=QE(this,null,this.W),lu(this)};function Qf(u){if(UE(u),u.G==3){var h=u.U++,p=Sn(u.I);if(we(p,"SID",u.K),we(p,"RID",h),we(p,"TYPE","terminate"),ta(u,p),h=new tr(u,u.j,h),h.L=2,h.v=su(Sn(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=YE(h.j,null),h.g.ea(h.v)),h.F=Date.now(),ru(h)}KE(u)}function uu(u){u.g&&(Zf(u),u.g.cancel(),u.g=null)}function UE(u){uu(u),u.u&&(a.clearTimeout(u.u),u.u=null),du(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function lu(u){if(!wE(u.h)&&!u.s){u.s=!0;var h=u.Ga;Vs||XI(),js||(Vs(),js=!0),Af.add(h,u),u.B=0}}function zP(u,h){return TE(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=h.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=zs(g(u.Ga,u,h),GE(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let C=new tr(this,this.j,u),M=this.o;if(this.S&&(M?(M=_(M),D(M,this.S)):M=this.S),this.m!==null||this.O||(C.H=M,M=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break t}y=void 0}if(y===void 0)break;if(h+=y,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=HE(this,C,h),p=Sn(this.I),we(p,"RID",u),we(p,"CVER",22),this.D&&we(p,"X-HTTP-Session-Id",this.D),ta(this,p),M&&(this.O?h="headers="+encodeURIComponent(String(xE(M)))+"&"+h:this.m&&Kf(p,this.m,M)),Gf(this.h,C),this.Ua&&we(p,"TYPE","init"),this.P?(we(p,"$req",h),we(p,"SID","null"),C.T=!0,Hf(C,p,null)):Hf(C,p,h),this.G=2}}else this.G==3&&(u?$E(this,u):this.i.length==0||wE(this.h)||$E(this))};function $E(u,h){var p;h?p=h.l:p=u.U++;let y=Sn(u.I);we(y,"SID",u.K),we(y,"RID",p),we(y,"AID",u.T),ta(u,y),u.m&&u.o&&Kf(y,u.m,u.o),p=new tr(u,u.j,p,u.B+1),u.m===null&&(p.H=u.o),h&&(u.i=h.D.concat(u.i)),h=HE(u,p,1e3),p.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Gf(u.h,p),Hf(p,y,h)}function ta(u,h){u.H&&K(u.H,function(p,y){we(h,y,p)}),u.l&&CE({},function(p,y){we(h,y,p)})}function HE(u,h,p){p=Math.min(u.i.length,p);var y=u.l?g(u.l.Na,u.l,u):null;e:{var C=u.i;let M=-1;for(;;){let L=["count="+p];M==-1?0<p?(M=C[0].g,L.push("ofs="+M)):M=0:L.push("ofs="+M);let _e=!0;for(let Ye=0;Ye<p;Ye++){let pe=C[Ye].g,nt=C[Ye].map;if(pe-=M,0>pe)M=Math.max(0,C[Ye].g-100),_e=!1;else try{UP(nt,L,"req"+pe+"_")}catch{y&&y(nt)}}if(_e){y=L.join("&");break e}}}return u=u.i.splice(0,p),h.D=u,y}function qE(u){if(!u.g&&!u.u){u.Y=1;var h=u.Fa;Vs||XI(),js||(Vs(),js=!0),Af.add(h,u),u.v=0}}function Yf(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=zs(g(u.Fa,u),GE(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,zE(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=zs(g(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ut(10),uu(this),zE(this))};function Zf(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function zE(u){u.g=new tr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var h=Sn(u.qa);we(h,"RID","rpc"),we(h,"SID",u.K),we(h,"AID",u.T),we(h,"CI",u.F?"0":"1"),!u.F&&u.ja&&we(h,"TO",u.ja),we(h,"TYPE","xmlhttp"),ta(u,h),u.m&&u.o&&Kf(h,u.m,u.o),u.L&&(u.g.I=u.L);var p=u.g;u=u.ia,p.L=1,p.v=su(Sn(h)),p.m=null,p.P=!0,vE(p,u)}n.Za=function(){this.C!=null&&(this.C=null,uu(this),Yf(this),ut(19))};function du(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function WE(u,h){var p=null;if(u.g==h){du(u),Zf(u),u.g=null;var y=2}else if(Wf(u.h,h))p=h.D,DE(u.h,h),y=1;else return;if(u.G!=0){if(h.o)if(y==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var C=u.B;y=eu(),ct(y,new pE(y,p)),lu(u)}else qE(u);else if(C=h.s,C==3||C==0&&0<h.X||!(y==1&&zP(u,h)||y==2&&Yf(u)))switch(p&&0<p.length&&(h=u.h,h.i=h.i.concat(p)),C){case 1:Yr(u,5);break;case 4:Yr(u,10);break;case 3:Yr(u,6);break;default:Yr(u,2)}}}function GE(u,h){let p=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(p*=2),p*h}function Yr(u,h){if(u.j.info("Error code "+h),h==2){var p=g(u.fb,u),y=u.Xa;let C=!y;y=new Qr(y||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||iu(y,"https"),su(y),C?VP(y.toString(),p):jP(y.toString(),p)}else ut(2);u.G=0,u.l&&u.l.sa(h),KE(u),UE(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))};function KE(u){if(u.G=0,u.ka=[],u.l){let h=bE(u.h);(h.length!=0||u.i.length!=0)&&(P(u.ka,h),P(u.ka,u.i),u.h.i.length=0,R(u.i),u.i.length=0),u.l.ra()}}function QE(u,h,p){var y=p instanceof Qr?Sn(p):new Qr(p);if(y.g!="")h&&(y.g=h+"."+y.g),ou(y,y.s);else{var C=a.location;y=C.protocol,h=h?h+"."+C.hostname:C.hostname,C=+C.port;var M=new Qr(null);y&&iu(M,y),h&&(M.g=h),C&&ou(M,C),p&&(M.l=p),y=M}return p=u.D,h=u.ya,p&&h&&we(y,p,h),we(y,"VER",u.la),ta(u,y),y}function YE(u,h,p){if(h&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=u.Ca&&!u.pa?new Pe(new Zs({eb:p})):new Pe(u.pa),h.Ha(u.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ZE(){}n=ZE.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function hu(){}hu.prototype.g=function(u,h){return new Ct(u,h)};function Ct(u,h){tt.call(this),this.g=new BE(h),this.l=u,this.h=h&&h.messageUrlParams||null,u=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(u?u["X-WebChannel-Content-Type"]=h.messageContentType:u={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(u?u["X-WebChannel-Client-Profile"]=h.va:u={"X-WebChannel-Client-Profile":h.va}),this.g.S=u,(u=h&&h.Sb)&&!B(u)&&(this.g.m=u),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!B(h)&&(this.g.D=h,u=this.h,u!==null&&h in u&&(u=this.h,h in u&&delete u[h])),this.j=new no(this)}w(Ct,tt),Ct.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ct.prototype.close=function(){Qf(this.g)},Ct.prototype.o=function(u){var h=this.g;if(typeof u=="string"){var p={};p.__data__=u,u=p}else this.u&&(p={},p.__data__=Lf(u),u=p);h.i.push(new AP(h.Ya++,u)),h.G==3&&lu(h)},Ct.prototype.N=function(){this.g.l=null,delete this.j,Qf(this.g),delete this.g,Ct.aa.N.call(this)};function JE(u){jf.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var h=u.__sm__;if(h){e:{for(let p in h){u=p;break e}u=void 0}(this.i=u)&&(u=this.i,h=h!==null&&u in h?h[u]:void 0),this.data=h}else this.data=u}w(JE,jf);function XE(){Bf.call(this),this.status=1}w(XE,Bf);function no(u){this.g=u}w(no,ZE),no.prototype.ua=function(){ct(this.g,"a")},no.prototype.ta=function(u){ct(this.g,new JE(u))},no.prototype.sa=function(u){ct(this.g,new XE)},no.prototype.ra=function(){ct(this.g,"b")},hu.prototype.createWebChannel=hu.prototype.g,Ct.prototype.send=Ct.prototype.o,Ct.prototype.open=Ct.prototype.m,Ct.prototype.close=Ct.prototype.close,Uy=$n.createWebChannelTransport=function(){return new hu},By=$n.getStatEventTarget=function(){return eu()},jy=$n.Event=Gr,Ud=$n.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},tu.NO_ERROR=0,tu.TIMEOUT=8,tu.HTTP_ERROR=6,Ka=$n.ErrorCode=tu,gE.COMPLETE="complete",Vy=$n.EventType=gE,lE.EventType=Hs,Hs.OPEN="a",Hs.CLOSE="b",Hs.ERROR="c",Hs.MESSAGE="d",tt.prototype.listen=tt.prototype.K,Ho=$n.WebChannel=lE,CU=$n.FetchXmlHttpFactory=Zs,Pe.prototype.listenOnce=Pe.prototype.L,Pe.prototype.getLastError=Pe.prototype.Ka,Pe.prototype.getLastErrorCode=Pe.prototype.Ba,Pe.prototype.getStatus=Pe.prototype.Z,Pe.prototype.getResponseJson=Pe.prototype.Oa,Pe.prototype.getResponseText=Pe.prototype.oa,Pe.prototype.send=Pe.prototype.ea,Pe.prototype.setWithCredentials=Pe.prototype.Ha,Ly=$n.XhrIo=Pe}).apply(typeof Bd<"u"?Bd:typeof self<"u"?self:typeof window<"u"?window:{});var xS="@firebase/firestore",OS="4.8.0";var $e=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};$e.UNAUTHENTICATED=new $e(null),$e.GOOGLE_CREDENTIALS=new $e("google-credentials-uid"),$e.FIRST_PARTY=new $e("first-party-uid"),$e.MOCK_USER=new $e("mock-user");var Ns="11.10.0";var Rr=new dn("@firebase/firestore");function Yo(){return Rr.logLevel}function J0(n){Rr.setLogLevel(n)}function x(n,...e){if(Rr.logLevel<=se.DEBUG){let t=e.map(iI);Rr.debug(`Firestore (${Ns}): ${n}`,...t)}}function Fe(n,...e){if(Rr.logLevel<=se.ERROR){let t=e.map(iI);Rr.error(`Firestore (${Ns}): ${n}`,...t)}}function mt(n,...e){if(Rr.logLevel<=se.WARN){let t=e.map(iI);Rr.warn(`Firestore (${Ns}): ${n}`,...t)}}function iI(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function $(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,X0(n,r,t)}function X0(n,e,t){let r=`FIRESTORE (${Ns}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Fe(r),new Error(r)}function H(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||X0(e,i,r)}function RK(n,e){n||$(57014,e)}function F(n,e){return n}var S={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},k=class extends Pt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var qe=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var nh=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Qy=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t($e.UNAUTHENTICATED))}shutdown(){}},Yy=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Zy=class{constructor(e){this.t=e,this.currentUser=$e.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){H(this.o===void 0,42304);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),o=new qe;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new qe,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let c=o;e.enqueueRetryable(()=>v(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{x("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(x("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new qe)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(x("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(H(typeof r.accessToken=="string",31837,{l:r}),new nh(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return H(e===null||typeof e=="string",2055,{h:e}),new $e(e)}},Jy=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=$e.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},Xy=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Jy(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t($e.FIRST_PARTY))}shutdown(){}invalidateToken(){}},uc=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},ev=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){H(this.o===void 0,3512);let r=o=>{o.error!=null&&x("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,x("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{x("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):x("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new uc(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(H(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new uc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}},FS=class{getToken(){return Promise.resolve(new uc(""))}invalidateToken(){}start(e,t){}shutdown(){}};function SU(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function oI(){return new TextEncoder}var lc=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=SU(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function z(n,e){return n<e?-1:n>e?1:0}function tv(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return z(r,i);{let o=oI(),s=AU(o.encode(LS(n,t)),o.encode(LS(e,t)));return s!==0?s:z(r,i)}}t+=r>65535?2:1}return z(n.length,e.length)}function LS(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function AU(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return z(n[t],e[t]);return z(n.length,e.length)}function os(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function eA(n){return n+"\0"}var nv="__name__",rh=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&$(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&$(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return z(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):tv(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Un.fromString(e.substring(4,e.length-2))}},ue=class n extends rh{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new k(S.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},NU=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ze=class n extends rh{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return NU.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nv}static keyField(){return new n([nv])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new k(S.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new k(S.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new k(S.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new k(S.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var V=class n{constructor(e){this.path=e}static fromPath(e){return new n(ue.fromString(e))}static fromName(e){return new n(ue.fromString(e).popFirst(5))}static empty(){return new n(ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ue.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ue(e.slice()))}};function sI(n,e,t){if(!t)throw new k(S.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function RU(n,e,t,r){if(e===!0&&r===!0)throw new k(S.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function VS(n){if(!V.isDocumentKey(n))throw new k(S.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function jS(n){if(V.isDocumentKey(n))throw new k(S.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function tA(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function of(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":$(12329,{type:typeof n})}function ae(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new k(S.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=of(n);throw new k(S.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function nA(n,e){if(e<=0)throw new k(S.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function He(n,e){let t={typeString:n};return e&&(t.value=e),t}function Yi(n,e){if(!tA(n))throw new k(S.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let s=n[r];if(i&&typeof s!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new k(S.INVALID_ARGUMENT,t);return!0}var BS=-62135596800,US=1e6,Ae=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*US);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new k(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new k(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<BS)throw new k(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/US}_compareTo(e){return this.seconds===e.seconds?z(this.nanoseconds,e.nanoseconds):z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yi(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-BS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Ae._jsonSchemaVersion="firestore/timestamp/1.0",Ae._jsonSchema={type:He("string",Ae._jsonSchemaVersion),seconds:He("number"),nanoseconds:He("number")};var q=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Ae(0,0))}static max(){return new n(new Ae(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var ss=-1,Pr=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function rv(n){return n.fields.find(e=>e.kind===2)}function Ai(n){return n.fields.filter(e=>e.kind!==2)}function PU(n,e){let t=z(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=MU(n.fields[r],e.fields[r]),t!==0)return t;return z(n.fields.length,e.fields.length)}Pr.UNKNOWN_ID=-1;var qn=class{constructor(e,t){this.fieldPath=e,this.kind=t}};function MU(n,e){let t=ze.comparator(n.fieldPath,e.fieldPath);return t!==0?t:z(n.kind,e.kind)}var as=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,$t.min())}};function rA(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=q.fromTimestamp(r===1e9?new Ae(t+1,0):new Ae(t,r));return new $t(i,V.empty(),e)}function iA(n){return new $t(n.readTime,n.key,ss)}var $t=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(q.min(),V.empty(),ss)}static max(){return new n(q.max(),V.empty(),ss)}};function aI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=V.comparator(n.documentKey,e.documentKey),t!==0?t:z(n.largestBatchId,e.largestBatchId))}var oA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ih=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ur(n){return v(this,null,function*(){if(n.code!==S.FAILED_PRECONDITION||n.message!==oA)throw n;x("LocalStore","Unexpectedly lost primary lease")})}var N=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>r(c))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let c=0;c<o;c++){let l=c;t(e[l]).next(d=>{s[l]=d,++a,a===o&&r(s)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};var kt="SimpleDb",oh=class n{static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(o){throw new Fi(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new qe,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Fi(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{let i=cI(r.target.error);this.S.reject(new Fi(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(x(kt,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new ov(t)}},Mr=class n{static delete(e){return x(kt,"Removing database:",e),Ri(od().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!Fo())return!1;if(n.F())return!0;let e=Oe(),t=n.M(e),r=0<t&&t<10,i=sA(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,n.M(Oe())===12.2&&Fe("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}k(e){return v(this,null,function*(){return this.db||(x(kt,"Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{r(new Fi(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?r(new k(S.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new k(S.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new Fi(e,s))},i.onupgradeneeded=o=>{x(kt,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;if(this.L!==null&&this.L!==o.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${o.oldVersion}, event.newVersion=${o.newVersion}, db.version=${s.version}`);this.B.q(s,i.transaction,o.oldVersion,this.version).next(()=>{x(kt,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{let r=t.target;this.L=r.version},{passive:!0})),this.db.addEventListener("versionchange",t=>{var r;t.newVersion===null&&(mt('Received "versionchange" event with newVersion===null; notifying the registered DatabaseDeletedListener, if any'),(r=this.databaseDeletedListener)===null||r===void 0||r.call(this))},{passive:!0}),this.db})}setDatabaseDeletedListener(e){if(this.databaseDeletedListener)throw new Error("setDatabaseDeletedListener() may only be called once, and it has already been called");this.databaseDeletedListener=e}runTransaction(e,t,r,i){return v(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.k(e);let a=oh.open(this.db,e,o?"readonly":"readwrite",r),c=i(a).next(l=>(a.v(),l)).catch(l=>(a.abort(l),N.reject(l))).toPromise();return c.catch(()=>{}),yield a.D,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&s<3;if(x(kt,"Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function sA(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var iv=class{constructor(e){this.$=e,this.U=!1,this.K=null}get isDone(){return this.U}get W(){return this.K}set cursor(e){this.$=e}done(){this.U=!0}G(e){this.K=e}delete(){return Ri(this.$.delete())}},Fi=class extends k{constructor(e,t){super(S.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function $r(n){return n.name==="IndexedDbTransactionError"}var ov=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(x(kt,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(x(kt,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ri(r)}add(e){return x(kt,"ADD",this.store.name,e,e),Ri(this.store.add(e))}get(e){return Ri(this.store.get(e)).next(t=>(t===void 0&&(t=null),x(kt,"GET",this.store.name,e,t),t))}delete(e){return x(kt,"DELETE",this.store.name,e),Ri(this.store.delete(e))}count(){return x(kt,"COUNT",this.store.name),Ri(this.store.count())}j(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(r.range);return new N((s,a)=>{o.onerror=c=>{a(c.target.error)},o.onsuccess=c=>{s(c.target.result)}})}{let o=this.cursor(r),s=[];return this.J(o,(a,c)=>{s.push(c)}).next(()=>s)}}H(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new N((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}Y(e,t){x(kt,"DELETE ALL",this.store.name);let r=this.options(e,t);r.Z=!1;let i=this.cursor(r);return this.J(i,(o,s,a)=>a.delete())}X(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.J(i,t)}ee(e){let t=this.cursor({});return new N((r,i)=>{t.onerror=o=>{let s=cI(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}J(e,t){let r=[];return new N((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let a=s.target.result;if(!a)return void i();let c=new iv(a),l=t(a.primaryKey,a.value,c);if(l instanceof N){let d=l.catch(f=>(c.done(),N.reject(f)));r.push(d)}c.isDone?i():c.W===null?a.continue():a.continue(c.W)}}).next(()=>N.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.Z?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Ri(n){return new N((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=cI(r.target.error);t(i)}})}var $S=!1;function cI(n){let e=Mr.M(Oe());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return $S||($S=!0,setTimeout(()=>{throw r},0)),r}}return n}var tc="IndexBackfiller",sv=class{constructor(e,t){this.asyncQueue=e,this.te=t,this.task=null}start(){this.ne(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ne(e){x(tc,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>v(this,null,function*(){this.task=null;try{let t=yield this.te.re();x(tc,`Documents written: ${t}`)}catch(t){$r(t)?x(tc,"Ignoring IndexedDB error during index backfill: ",t):yield Ur(t)}yield this.ne(6e4)}))}},av=class{constructor(e,t){this.localStore=e,this.persistence=t}re(e=50){return v(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.ie(t,e))})}ie(e,t){let r=new Set,i=t,o=!0;return N.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return x(tc,`Processing collection: ${s}`),this.se(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}se(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.oe(i,o)).next(a=>(x(tc,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}oe(e,t){let r=e;return t.changes.forEach((i,o)=>{let s=iA(o);aI(s,r)>0&&(r=s)}),new $t(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var xt=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),Ar=-1;function $c(n){return n==null}function dc(n){return n===0&&1/n==-1/0}function aA(n){return typeof n=="number"&&Number.isInteger(n)&&!dc(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var sh="";function st(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=HS(e)),e=kU(n.get(t),e);return HS(e)}function kU(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case sh:t+="";break;default:t+=o}}return t}function HS(n){return n+sh+""}function yn(n){let e=n.length;if(H(e>=2,64408,{path:n}),e===2)return H(n.charAt(0)===sh&&n.charAt(1)==="",56145,{path:n}),ue.emptyPath();let t=e-2,r=[],i="";for(let o=0;o<e;){let s=n.indexOf(sh,o);switch((s<0||s>t)&&$(50515,{path:n}),n.charAt(s+1)){case"":let a=n.substring(o,s),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:$(61167,{path:n})}o=s+2}return new ue(r)}var Ni="remoteDocuments",Hc="owner",qo="owner",hc="mutationQueues",xU="userId",Xt="mutations",qS="batchId",xi="userMutationsIndex",zS=["userId","batchId"];function Kd(n,e){return[n,st(e)]}function cA(n,e,t){return[n,st(e),t]}var OU={},cs="documentMutations",ah="remoteDocumentsV14",FU=["prefixPath","collectionGroup","readTime","documentId"],Qd="documentKeyIndex",LU=["prefixPath","collectionGroup","documentId"],uA="collectionGroupIndex",VU=["collectionGroup","readTime","prefixPath","documentId"],fc="remoteDocumentGlobal",cv="remoteDocumentGlobalKey",us="targets",lA="queryTargetsIndex",jU=["canonicalId","targetId"],ls="targetDocuments",BU=["targetId","path"],uI="documentTargetsIndex",UU=["path","targetId"],ch="targetGlobalKey",Li="targetGlobal",pc="collectionParents",$U=["collectionId","parent"],ds="clientMetadata",HU="clientId",sf="bundles",qU="bundleId",af="namedQueries",zU="name",lI="indexConfiguration",WU="indexId",uv="collectionGroupIndex",GU="collectionGroup",nc="indexState",KU=["indexId","uid"],dA="sequenceNumberIndex",QU=["uid","sequenceNumber"],rc="indexEntries",YU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],hA="documentKeyIndex",ZU=["indexId","uid","orderedDocumentKey"],cf="documentOverlays",JU=["userId","collectionPath","documentId"],lv="collectionPathOverlayIndex",XU=["userId","collectionPath","largestBatchId"],fA="collectionGroupOverlayIndex",e$=["userId","collectionGroup","largestBatchId"],dI="globals",t$="name",pA=[hc,Xt,cs,Ni,us,Hc,Li,ls,ds,fc,pc,sf,af],n$=[...pA,cf],gA=[hc,Xt,cs,ah,us,Hc,Li,ls,ds,fc,pc,sf,af,cf],mA=gA,hI=[...mA,lI,nc,rc],r$=hI,yA=[...hI,dI],i$=yA;var gc=class extends ih{constructor(e,t){super(),this.ce=e,this.currentSequenceNumber=t}};function Ke(n,e){let t=F(n);return Mr.N(t.ce,e)}function WS(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Hr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function vA(n,e){let t=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function _A(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var be=class n{constructor(e,t){this.comparator=e,this.root=t||In.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,In.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,In.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new es(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new es(this.root,e,this.comparator,!1)}getReverseIterator(){return new es(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new es(this.root,e,this.comparator,!0)}},es=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},In=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw $(43730,{key:this.key,value:this.value});if(this.right.isRed())throw $(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw $(27949);return e+(this.isRed()?0:1)}};In.EMPTY=null,In.RED=!0,In.BLACK=!1;In.EMPTY=new class{constructor(){this.size=0}get key(){throw $(57766)}get value(){throw $(16141)}get color(){throw $(16727)}get left(){throw $(29726)}get right(){throw $(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new In(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ve=class n{constructor(e){this.comparator=e,this.data=new be(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new uh(this.data.getIterator())}getIteratorFrom(e){return new uh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},uh=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function zo(n){return n.hasNext()?n.getNext():void 0}var Ot=class n{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new n([])}unionWith(e){let t=new ve(ze.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return os(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var lh=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function MK(){return typeof atob<"u"}var Ve=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new lh("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ve.EMPTY_BYTE_STRING=new Ve("");var o$=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gn(n){if(H(!!n,39018),typeof n=="string"){let e=0,t=o$.exec(n);if(H(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Se(n.seconds),nanos:Se(n.nanos)}}function Se(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Kn(n){return typeof n=="string"?Ve.fromBase64String(n):Ve.fromUint8Array(n)}var IA="server_timestamp",EA="__type__",wA="__previous_value__",TA="__local_write_time__";function uf(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[EA])===null||t===void 0?void 0:t.stringValue)===IA}function lf(n){let e=n.mapValue.fields[wA];return uf(e)?lf(e):e}function mc(n){let e=Gn(n.mapValue.fields[TA].timestampValue);return new Ae(e.seconds,e.nanos)}var dv=class{constructor(e,t,r,i,o,s,a,c,l,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=d}},yc="(default)",hs=class n{constructor(e,t){this.projectId=e,this.database=t||yc}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===yc}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var fI="__type__",DA="__max__",Cr={mapValue:{fields:{__type__:{stringValue:DA}}}},pI="__vector__",fs="value",Yd={nullValue:"NULL_VALUE"};function kr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?uf(n)?4:bA(n)?9007199254740991:df(n)?10:11:$(28295,{value:n})}function Tn(n,e){if(n===e)return!0;let t=kr(n);if(t!==kr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return mc(n).isEqual(mc(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=Gn(i.timestampValue),a=Gn(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Kn(i.bytesValue).isEqual(Kn(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return Se(i.geoPointValue.latitude)===Se(o.geoPointValue.latitude)&&Se(i.geoPointValue.longitude)===Se(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Se(i.integerValue)===Se(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=Se(i.doubleValue),a=Se(o.doubleValue);return s===a?dc(s)===dc(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return os(n.arrayValue.values||[],e.arrayValue.values||[],Tn);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(WS(s)!==WS(a))return!1;for(let c in s)if(s.hasOwnProperty(c)&&(a[c]===void 0||!Tn(s[c],a[c])))return!1;return!0}(n,e);default:return $(52216,{left:n})}}function vc(n,e){return(n.values||[]).find(t=>Tn(t,e))!==void 0}function xr(n,e){if(n===e)return 0;let t=kr(n),r=kr(e);if(t!==r)return z(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return z(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=Se(o.integerValue||o.doubleValue),c=Se(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return GS(n.timestampValue,e.timestampValue);case 4:return GS(mc(n),mc(e));case 5:return tv(n.stringValue,e.stringValue);case 6:return function(o,s){let a=Kn(o),c=Kn(s);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),c=s.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=z(a[l],c[l]);if(d!==0)return d}return z(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=z(Se(o.latitude),Se(s.latitude));return a!==0?a:z(Se(o.longitude),Se(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return KS(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,c,l,d;let f=o.fields||{},g=s.fields||{},m=(a=f[fs])===null||a===void 0?void 0:a.arrayValue,w=(c=g[fs])===null||c===void 0?void 0:c.arrayValue,R=z(((l=m?.values)===null||l===void 0?void 0:l.length)||0,((d=w?.values)===null||d===void 0?void 0:d.length)||0);return R!==0?R:KS(m,w)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===Cr.mapValue&&s===Cr.mapValue)return 0;if(o===Cr.mapValue)return 1;if(s===Cr.mapValue)return-1;let a=o.fields||{},c=Object.keys(a),l=s.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){let g=tv(c[f],d[f]);if(g!==0)return g;let m=xr(a[c[f]],l[d[f]]);if(m!==0)return m}return z(c.length,d.length)}(n.mapValue,e.mapValue);default:throw $(23264,{le:t})}}function GS(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return z(n,e);let t=Gn(n),r=Gn(e),i=z(t.seconds,r.seconds);return i!==0?i:z(t.nanos,r.nanos)}function KS(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=xr(t[i],r[i]);if(o)return o}return z(t.length,r.length)}function ps(n){return hv(n)}function hv(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Gn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Kn(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return V.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=hv(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${hv(t.fields[s])}`;return i+"}"}(n.mapValue):$(61005,{value:n})}function Zd(n){switch(kr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=lf(n);return e?16+Zd(e):16;case 5:return 2*n.stringValue.length;case 6:return Kn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,o)=>i+Zd(o),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Hr(r.fields,(o,s)=>{i+=o.length+Zd(s)}),i}(n.mapValue);default:throw $(13486,{value:n})}}function Vi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function fv(n){return!!n&&"integerValue"in n}function _c(n){return!!n&&"arrayValue"in n}function QS(n){return!!n&&"nullValue"in n}function YS(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Jd(n){return!!n&&"mapValue"in n}function df(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[fI])===null||t===void 0?void 0:t.stringValue)===pI}function ic(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Hr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ic(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ic(n.arrayValue.values[t]);return e}return Object.assign({},n)}function bA(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===DA}var CA={mapValue:{fields:{[fI]:{stringValue:pI},[fs]:{arrayValue:{}}}}};function s$(n){return"nullValue"in n?Yd:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Vi(hs.empty(),V.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?df(n)?CA:{mapValue:{}}:$(35942,{value:n})}function a$(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Vi(hs.empty(),V.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?CA:"mapValue"in n?df(n)?{mapValue:{}}:Cr:$(61959,{value:n})}function ZS(n,e){let t=xr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function JS(n,e){let t=xr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var ot=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Jd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ic(t)}setAll(e){let t=ze.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=ic(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());Jd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Tn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Jd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Hr(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(ic(this.value))}};function SA(n){let e=[];return Hr(n.fields,(t,r)=>{let i=new ze([t]);if(Jd(r)){let o=SA(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new Ot(e)}var We=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,q.min(),q.min(),q.min(),ot.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,q.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,q.min(),q.min(),ot.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,q.min(),q.min(),ot.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(q.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ot.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ot.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Dn=class{constructor(e,t){this.position=e,this.inclusive=t}};function XS(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=V.comparator(V.fromName(s.referenceValue),t.key):r=xr(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function e0(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Tn(n.position[t],e.position[t]))return!1;return!0}var ji=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function c$(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var dh=class{},le=class n extends dh{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new mv(e,t,r):t==="array-contains"?new _v(e,r):t==="in"?new hh(e,r):t==="not-in"?new Iv(e,r):t==="array-contains-any"?new Ev(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new yv(e,r):new vv(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(xr(t,this.value)):t!==null&&kr(this.value)===kr(t)&&this.matchesComparison(xr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},me=class n extends dh{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return gs(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function gs(n){return n.op==="and"}function pv(n){return n.op==="or"}function gI(n){return AA(n)&&gs(n)}function AA(n){for(let e of n.filters)if(e instanceof me)return!1;return!0}function gv(n){if(n instanceof le)return n.field.canonicalString()+n.op.toString()+ps(n.value);if(gI(n))return n.filters.map(e=>gv(e)).join(",");{let e=n.filters.map(t=>gv(t)).join(",");return`${n.op}(${e})`}}function NA(n,e){return n instanceof le?function(r,i){return i instanceof le&&r.op===i.op&&r.field.isEqual(i.field)&&Tn(r.value,i.value)}(n,e):n instanceof me?function(r,i){return i instanceof me&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&NA(s,i.filters[a]),!0):!1}(n,e):void $(19439)}function RA(n,e){let t=n.filters.concat(e);return me.create(t,n.op)}function PA(n){return n instanceof le?function(t){return`${t.field.canonicalString()} ${t.op} ${ps(t.value)}`}(n):n instanceof me?function(t){return t.op.toString()+" {"+t.getFilters().map(PA).join(" ,")+"}"}(n):"Filter"}var mv=class extends le{constructor(e,t,r){super(e,t,r),this.key=V.fromName(r.referenceValue)}matches(e){let t=V.comparator(e.key,this.key);return this.matchesComparison(t)}},yv=class extends le{constructor(e,t){super(e,"in",t),this.keys=MA("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},vv=class extends le{constructor(e,t){super(e,"not-in",t),this.keys=MA("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function MA(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>V.fromName(r.referenceValue))}var _v=class extends le{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return _c(t)&&vc(t.arrayValue,this.value)}},hh=class extends le{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&vc(this.value.arrayValue,t)}},Iv=class extends le{constructor(e,t){super(e,"not-in",t)}matches(e){if(vc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!vc(this.value.arrayValue,t)}},Ev=class extends le{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!_c(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>vc(this.value.arrayValue,r))}};var wv=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.Pe=null}};function Tv(n,e=null,t=[],r=[],i=null,o=null,s=null){return new wv(n,e,t,r,i,o,s)}function Bi(n){let e=F(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>gv(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),$c(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ps(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ps(r)).join(",")),e.Pe=t}return e.Pe}function qc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!c$(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!NA(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!e0(n.startAt,e.startAt)&&e0(n.endAt,e.endAt)}function fh(n){return V.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function ph(n,e){return n.filters.filter(t=>t instanceof le&&t.field.isEqual(e))}function t0(n,e,t){let r=Yd,i=!0;for(let o of ph(n,e)){let s=Yd,a=!0;switch(o.op){case"<":case"<=":s=s$(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=Yd}ZS({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];ZS({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function n0(n,e,t){let r=Cr,i=!0;for(let o of ph(n,e)){let s=Cr,a=!0;switch(o.op){case">=":case">":s=a$(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=Cr}JS({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];JS({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}var en=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function kA(n,e,t,r,i,o,s,a){return new en(n,e,t,r,i,o,s,a)}function Rs(n){return new en(n)}function r0(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function mI(n){return n.collectionGroup!==null}function ts(n){let e=F(n);if(e.Te===null){e.Te=[];let t=new Set;for(let o of e.explicitOrderBy)e.Te.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new ve(ze.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Te.push(new ji(o,r))}),t.has(ze.keyField().canonicalString())||e.Te.push(new ji(ze.keyField(),r))}return e.Te}function at(n){let e=F(n);return e.Ie||(e.Ie=OA(e,ts(n))),e.Ie}function xA(n){let e=F(n);return e.de||(e.de=OA(e,n.explicitOrderBy)),e.de}function OA(n,e){if(n.limitType==="F")return Tv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new ji(i.field,o)});let t=n.endAt?new Dn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Dn(n.startAt.position,n.startAt.inclusive):null;return Tv(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Dv(n,e){let t=n.filters.concat([e]);return new en(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function gh(n,e,t){return new en(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function zc(n,e){return qc(at(n),at(e))&&n.limitType===e.limitType}function FA(n){return`${Bi(at(n))}|lt:${n.limitType}`}function Zo(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>PA(i)).join(", ")}]`),$c(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ps(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ps(i)).join(",")),`Target(${r})`}(at(n))}; limitType=${n.limitType})`}function Wc(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):V.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of ts(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,c){let l=XS(s,a,c);return s.inclusive?l<=0:l<0}(r.startAt,ts(r),i)||r.endAt&&!function(s,a,c){let l=XS(s,a,c);return s.inclusive?l>=0:l>0}(r.endAt,ts(r),i))}(n,e)}function LA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function VA(n){return(e,t)=>{let r=!1;for(let i of ts(n)){let o=u$(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function u$(n,e,t){let r=n.field.isKeyField()?V.comparator(e.key,t.key):function(o,s,a){let c=s.data.field(o),l=a.data.field(o);return c!==null&&l!==null?xr(c,l):$(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return $(19790,{direction:n.dir})}}var tn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Hr(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return _A(this.inner)}size(){return this.innerSize}};var l$=new be(V.comparator);function bt(){return l$}var jA=new be(V.comparator);function Xa(...n){let e=jA;for(let t of n)e=e.insert(t.key,t);return e}function BA(n){let e=jA;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function vn(){return oc()}function UA(){return oc()}function oc(){return new tn(n=>n.toString(),(n,e)=>n.isEqual(e))}var d$=new be(V.comparator),h$=new ve(V.comparator);function X(...n){let e=h$;for(let t of n)e=e.add(t);return e}var f$=new ve(z);function yI(){return f$}function vI(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:dc(e)?"-0":e}}function $A(n){return{integerValue:""+n}}function HA(n,e){return aA(e)?$A(e):vI(n,e)}var ms=class{constructor(){this._=void 0}};function p$(n,e,t){return n instanceof Or?function(i,o){let s={fields:{[EA]:{stringValue:IA},[TA]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&uf(o)&&(o=lf(o)),o&&(s.fields[wA]=o),{mapValue:s}}(t,e):n instanceof Qn?zA(n,e):n instanceof Yn?WA(n,e):function(i,o){let s=qA(i,o),a=i0(s)+i0(i.Ee);return fv(s)&&fv(i.Ee)?$A(a):vI(i.serializer,a)}(n,e)}function g$(n,e,t){return n instanceof Qn?zA(n,e):n instanceof Yn?WA(n,e):t}function qA(n,e){return n instanceof Fr?function(r){return fv(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var Or=class extends ms{},Qn=class extends ms{constructor(e){super(),this.elements=e}};function zA(n,e){let t=GA(e);for(let r of n.elements)t.some(i=>Tn(i,r))||t.push(r);return{arrayValue:{values:t}}}var Yn=class extends ms{constructor(e){super(),this.elements=e}};function WA(n,e){let t=GA(e);for(let r of n.elements)t=t.filter(i=>!Tn(i,r));return{arrayValue:{values:t}}}var Fr=class extends ms{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function i0(n){return Se(n.integerValue||n.doubleValue)}function GA(n){return _c(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Ui=class{constructor(e,t){this.field=e,this.transform=t}};function m$(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Qn&&i instanceof Qn||r instanceof Yn&&i instanceof Yn?os(r.elements,i.elements,Tn):r instanceof Fr&&i instanceof Fr?Tn(r.Ee,i.Ee):r instanceof Or&&i instanceof Or}(n.transform,e.transform)}var bv=class{constructor(e,t){this.version=e,this.transformResults=t}},ke=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Xd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var ys=class{};function KA(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Vr(n.key,ke.none()):new Lr(n.key,n.data,ke.none());{let t=n.data,r=ot.empty(),i=new ve(ze.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new nn(n.key,r,new Ot(i.toArray()),ke.none())}}function y$(n,e,t){n instanceof Lr?function(i,o,s){let a=i.value.clone(),c=s0(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof nn?function(i,o,s){if(!Xd(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=s0(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(QA(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function sc(n,e,t,r){return n instanceof Lr?function(o,s,a,c){if(!Xd(o.precondition,s))return a;let l=o.value.clone(),d=a0(o.fieldTransforms,c,s);return l.setAll(d),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof nn?function(o,s,a,c){if(!Xd(o.precondition,s))return a;let l=a0(o.fieldTransforms,c,s),d=s.data;return d.setAll(QA(o)),d.setAll(l),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(o,s,a){return Xd(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function v$(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=qA(r.transform,i||null);o!=null&&(t===null&&(t=ot.empty()),t.set(r.field,o))}return t||null}function o0(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&os(r,i,(o,s)=>m$(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Lr=class extends ys{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},nn=class extends ys{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function QA(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function s0(n,e,t){let r=new Map;H(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,g$(s,a,t[i]))}return r}function a0(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,p$(o,s,e))}return r}var Vr=class extends ys{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ic=class extends ys{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Ec=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&y$(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=sc(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=sc(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=UA();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let c=KA(s,a);c!==null&&r.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(q.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),X())}isEqual(e){return this.batchId===e.batchId&&os(this.mutations,e.mutations,(t,r)=>o0(t,r))&&os(this.baseMutations,e.baseMutations,(t,r)=>o0(t,r))}},Cv=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){H(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=function(){return d$}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var wc=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var mh=class{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}};var Sv=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Be,fe;function YA(n){switch(n){case S.OK:return $(64938);case S.CANCELLED:case S.UNKNOWN:case S.DEADLINE_EXCEEDED:case S.RESOURCE_EXHAUSTED:case S.INTERNAL:case S.UNAVAILABLE:case S.UNAUTHENTICATED:return!1;case S.INVALID_ARGUMENT:case S.NOT_FOUND:case S.ALREADY_EXISTS:case S.PERMISSION_DENIED:case S.FAILED_PRECONDITION:case S.ABORTED:case S.OUT_OF_RANGE:case S.UNIMPLEMENTED:case S.DATA_LOSS:return!0;default:return $(15467,{code:n})}}function ZA(n){if(n===void 0)return Fe("GRPC error has no .code"),S.UNKNOWN;switch(n){case Be.OK:return S.OK;case Be.CANCELLED:return S.CANCELLED;case Be.UNKNOWN:return S.UNKNOWN;case Be.DEADLINE_EXCEEDED:return S.DEADLINE_EXCEEDED;case Be.RESOURCE_EXHAUSTED:return S.RESOURCE_EXHAUSTED;case Be.INTERNAL:return S.INTERNAL;case Be.UNAVAILABLE:return S.UNAVAILABLE;case Be.UNAUTHENTICATED:return S.UNAUTHENTICATED;case Be.INVALID_ARGUMENT:return S.INVALID_ARGUMENT;case Be.NOT_FOUND:return S.NOT_FOUND;case Be.ALREADY_EXISTS:return S.ALREADY_EXISTS;case Be.PERMISSION_DENIED:return S.PERMISSION_DENIED;case Be.FAILED_PRECONDITION:return S.FAILED_PRECONDITION;case Be.ABORTED:return S.ABORTED;case Be.OUT_OF_RANGE:return S.OUT_OF_RANGE;case Be.UNIMPLEMENTED:return S.UNIMPLEMENTED;case Be.DATA_LOSS:return S.DATA_LOSS;default:return $(39323,{code:n})}}(fe=Be||(Be={}))[fe.OK=0]="OK",fe[fe.CANCELLED=1]="CANCELLED",fe[fe.UNKNOWN=2]="UNKNOWN",fe[fe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",fe[fe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",fe[fe.NOT_FOUND=5]="NOT_FOUND",fe[fe.ALREADY_EXISTS=6]="ALREADY_EXISTS",fe[fe.PERMISSION_DENIED=7]="PERMISSION_DENIED",fe[fe.UNAUTHENTICATED=16]="UNAUTHENTICATED",fe[fe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",fe[fe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",fe[fe.ABORTED=10]="ABORTED",fe[fe.OUT_OF_RANGE=11]="OUT_OF_RANGE",fe[fe.UNIMPLEMENTED=12]="UNIMPLEMENTED",fe[fe.INTERNAL=13]="INTERNAL",fe[fe.UNAVAILABLE=14]="UNAVAILABLE",fe[fe.DATA_LOSS=15]="DATA_LOSS";var yh=null;var _$=new Un([4294967295,4294967295],0);function c0(n){let e=oI().encode(n),t=new Fy;return t.update(e),new Uint8Array(t.digest())}function u0(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Un([t,r],0),new Un([i,o],0)]}var Av=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Oi(`Invalid padding: ${t}`);if(r<0)throw new Oi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Oi(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Oi(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Un.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(Un.fromNumber(r)));return i.compare(_$)===1&&(i=new Un([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let t=c0(e),[r,i]=u0(t);for(let o=0;o<this.hashCount;o++){let s=this.pe(r,i,o);if(!this.ye(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.fe===0)return;let t=c0(e),[r,i]=u0(t);for(let o=0;o<this.hashCount;o++){let s=this.pe(r,i,o);this.we(s)}}we(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Oi=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Tc=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Dc.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(q.min(),i,new be(z),bt(),X())}},Dc=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,X(),X(),X())}};var ns=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}},vh=class{constructor(e,t){this.targetId=e,this.De=t}},_h=class{constructor(e,t,r=Ve.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ih=class{constructor(){this.ve=0,this.Ce=l0(),this.Fe=Ve.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=X(),t=X(),r=X();return this.Ce.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:$(38017,{changeType:o})}}),new Dc(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=l0()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,H(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},Nv=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=bt(),this.je=$d(),this.Je=$d(),this.He=new be(z)}Ye(e){for(let t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(let t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{let r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:$(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,i)=>{this.nt(i)&&t(i)})}it(e){let t=e.targetId,r=e.De.count,i=this.st(t);if(i){let o=i.target;if(fh(o))if(r===0){let s=new V(o.path);this.Xe(t,s,We.newNoDocument(s,q.min()))}else H(r===1,20013,{expectedCount:r});else{let s=this.ot(t);if(s!==r){let a=this._t(e),c=a?this.ut(a,e,s):1;if(c!==0){this.rt(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,l)}yh?.ct(function(d,f,g,m,w){var R,P,O,B,U,W;let de={localCacheCount:d,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},K=f.unchangedNames;return K&&(de.bloomFilter={applied:w===0,hashCount:(R=K?.hashCount)!==null&&R!==void 0?R:0,bitmapLength:(B=(O=(P=K?.bits)===null||P===void 0?void 0:P.bitmap)===null||O===void 0?void 0:O.length)!==null&&B!==void 0?B:0,padding:(W=(U=K?.bits)===null||U===void 0?void 0:U.padding)!==null&&W!==void 0?W:0,mightContain:T=>{var _;return(_=m?.mightContain(T))!==null&&_!==void 0&&_}}),de}(s,e.De,this.We.lt(),a,c))}}}}_t(e){let t=e.De.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=Kn(r).toUint8Array()}catch(c){if(c instanceof lh)return mt("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Av(s,i,o)}catch(c){return mt(c instanceof Oi?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.fe===0?null:a}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){let r=this.We.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.We.lt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Xe(t,o,null),i++)}),i}Pt(e){let t=new Map;this.Ge.forEach((o,s)=>{let a=this.st(s);if(a){if(o.current&&fh(a.target)){let c=new V(a.target.path);this.Tt(c).has(s)||this.It(s,c)||this.Xe(s,c,We.newNoDocument(c,e))}o.Ne&&(t.set(s,o.Le()),o.ke())}});let r=X();this.Je.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{let l=this.st(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ze.forEach((o,s)=>s.setReadTime(e));let i=new Tc(e,t,this.He,this.ze,r);return this.ze=bt(),this.je=$d(),this.Je=$d(),this.He=new be(z),i}Ze(e,t){if(!this.nt(e))return;let r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;let i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){let t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Ih,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new ve(z),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new ve(z),this.je=this.je.insert(e,t)),t}nt(e){let t=this.st(e)!==null;return t||x("WatchChangeAggregator","Detected inactive target",e),t}st(e){let t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Ih),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}};function $d(){return new be(V.comparator)}function l0(){return new be(V.comparator)}var I$={asc:"ASCENDING",desc:"DESCENDING"},E$={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},w$={and:"AND",or:"OR"},Rv=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Pv(n,e){return n.useProto3Json||$c(e)?e:{value:e}}function vs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function JA(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function T$(n,e){return vs(n,e.toTimestamp())}function Le(n){return H(!!n,49232),q.fromTimestamp(function(t){let r=Gn(t);return new Ae(r.seconds,r.nanos)}(n))}function _I(n,e){return Mv(n,e).canonicalString()}function Mv(n,e){let t=function(i){return new ue(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function XA(n){let e=ue.fromString(n);return H(cN(e),10190,{key:e.toString()}),e}function bc(n,e){return _I(n.databaseId,e.path)}function En(n,e){let t=XA(e);if(t.get(1)!==n.databaseId.projectId)throw new k(S.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new k(S.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new V(nN(t))}function eN(n,e){return _I(n.databaseId,e)}function tN(n){let e=XA(n);return e.length===4?ue.emptyPath():nN(e)}function kv(n){return new ue(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function nN(n){return H(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function d0(n,e,t){return{name:bc(n,e),fields:t.value.mapValue.fields}}function hf(n,e,t){let r=En(n,e.name),i=Le(e.updateTime),o=e.createTime?Le(e.createTime):q.min(),s=new ot({mapValue:{fields:e.fields}}),a=We.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function D$(n,e){return"found"in e?function(r,i){H(!!i.found,43571),i.found.name,i.found.updateTime;let o=En(r,i.found.name),s=Le(i.found.updateTime),a=i.found.createTime?Le(i.found.createTime):q.min(),c=new ot({mapValue:{fields:i.found.fields}});return We.newFoundDocument(o,s,a,c)}(n,e):"missing"in e?function(r,i){H(!!i.missing,3894),H(!!i.readTime,22933);let o=En(r,i.missing),s=Le(i.readTime);return We.newNoDocument(o,s)}(n,e):$(7234,{result:e})}function b$(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:$(39313,{state:l})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(l,d){return l.useProto3Json?(H(d===void 0||typeof d=="string",58123),Ve.fromBase64String(d||"")):(H(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ve.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(l){let d=l.code===void 0?S.UNKNOWN:ZA(l.code);return new k(d,l.message||"")}(s);t=new _h(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=En(n,r.document.name),o=Le(r.document.updateTime),s=r.document.createTime?Le(r.document.createTime):q.min(),a=new ot({mapValue:{fields:r.document.fields}}),c=We.newFoundDocument(i,o,s,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new ns(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=En(n,r.document),o=r.readTime?Le(r.readTime):q.min(),s=We.newNoDocument(i,o),a=r.removedTargetIds||[];t=new ns([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=En(n,r.document),o=r.removedTargetIds||[];t=new ns([],o,i,null)}else{if(!("filter"in e))return $(11601,{At:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new Sv(i,o),a=r.targetId;t=new vh(a,s)}}return t}function Cc(n,e){let t;if(e instanceof Lr)t={update:d0(n,e.key,e.value)};else if(e instanceof Vr)t={delete:bc(n,e.key)};else if(e instanceof nn)t={update:d0(n,e.key,e.data),updateMask:P$(e.fieldMask)};else{if(!(e instanceof Ic))return $(16599,{Rt:e.type});t={verify:bc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof Or)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Qn)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Yn)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Fr)return{fieldPath:s.field.canonicalString(),increment:a.Ee};throw $(20930,{transform:s.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:T$(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:$(27497)}(n,e.precondition)),t}function xv(n,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?ke.updateTime(Le(o.updateTime)):o.exists!==void 0?ke.exists(o.exists):ke.none()}(e.currentDocument):ke.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let c=null;if("setToServerValue"in a)H(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new Or;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new Qn(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new Yn(d)}else"increment"in a?c=new Fr(s,a.increment):$(16584,{proto:a});let l=ze.fromServerFormat(a.fieldPath);return new Ui(l,c)}(n,i)):[];if(e.update){e.update.name;let i=En(n,e.update.name),o=new ot({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(c){let l=c.fieldPaths||[];return new Ot(l.map(d=>ze.fromServerFormat(d)))}(e.updateMask);return new nn(i,o,s,t,r)}return new Lr(i,o,t,r)}if(e.delete){let i=En(n,e.delete);return new Vr(i,t)}if(e.verify){let i=En(n,e.verify);return new Ic(i,t)}return $(1463,{proto:e})}function C$(n,e){return n&&n.length>0?(H(e!==void 0,14353),n.map(t=>function(i,o){let s=i.updateTime?Le(i.updateTime):Le(o);return s.isEqual(q.min())&&(s=Le(o)),new bv(s,i.transformResults||[])}(t,e))):[]}function rN(n,e){return{documents:[eN(n,e.path)]}}function ff(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=eN(n,i);let o=function(l){if(l.length!==0)return aN(me.create(l,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(l){if(l.length!==0)return l.map(d=>function(g){return{field:Dr(g.field),direction:A$(g.dir)}}(d))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=Pv(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{Vt:t,parent:i}}function iN(n,e,t,r){let{Vt:i,parent:o}=ff(n,e),s={},a=[],c=0;return t.forEach(l=>{let d=r?l.alias:"aggregate_"+c++;s[d]=l.alias,l.aggregateType==="count"?a.push({alias:d,count:{}}):l.aggregateType==="avg"?a.push({alias:d,avg:{field:Dr(l.fieldPath)}}):l.aggregateType==="sum"&&a.push({alias:d,sum:{field:Dr(l.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},ft:s,parent:o}}function oN(n){let e=tN(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){H(r===1,65062);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=function(f){let g=sN(f);return g instanceof me&&gI(g)?g.getFilters():[g]}(t.where));let s=[];t.orderBy&&(s=function(f){return f.map(g=>function(w){return new ji(Jo(w.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(f){let g;return g=typeof f=="object"?f.value:f,$c(g)?null:g}(t.limit));let c=null;t.startAt&&(c=function(f){let g=!!f.before,m=f.values||[];return new Dn(m,g)}(t.startAt));let l=null;return t.endAt&&(l=function(f){let g=!f.before,m=f.values||[];return new Dn(m,g)}(t.endAt)),kA(e,i,s,o,a,"F",c,l)}function S$(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function sN(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Jo(t.unaryFilter.field);return le.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Jo(t.unaryFilter.field);return le.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Jo(t.unaryFilter.field);return le.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=Jo(t.unaryFilter.field);return le.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return $(61313);default:return $(60726)}}(n):n.fieldFilter!==void 0?function(t){return le.create(Jo(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return $(58110);default:return $(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return me.create(t.compositeFilter.filters.map(r=>sN(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return $(1026)}}(t.compositeFilter.op))}(n):$(30097,{filter:n})}function A$(n){return I$[n]}function N$(n){return E$[n]}function R$(n){return w$[n]}function Dr(n){return{fieldPath:n.canonicalString()}}function Jo(n){return ze.fromServerFormat(n.fieldPath)}function aN(n){return n instanceof le?function(t){if(t.op==="=="){if(YS(t.value))return{unaryFilter:{field:Dr(t.field),op:"IS_NAN"}};if(QS(t.value))return{unaryFilter:{field:Dr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(YS(t.value))return{unaryFilter:{field:Dr(t.field),op:"IS_NOT_NAN"}};if(QS(t.value))return{unaryFilter:{field:Dr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Dr(t.field),op:N$(t.op),value:t.value}}}(n):n instanceof me?function(t){let r=t.getFilters().map(i=>aN(i));return r.length===1?r[0]:{compositeFilter:{op:R$(t.op),filters:r}}}(n):$(54877,{filter:n})}function P$(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function cN(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var _s=class n{constructor(e,t,r,i,o=q.min(),s=q.min(),a=Ve.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Eh=class{constructor(e){this.gt=e}};function M$(n,e){let t;if(e.document)t=hf(n.gt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=V.fromSegments(e.noDocument.path),i=Hi(e.noDocument.readTime);t=We.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return $(56709);{let r=V.fromSegments(e.unknownDocument.path),i=Hi(e.unknownDocument.version);t=We.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let o=new Ae(i[0],i[1]);return q.fromTimestamp(o)}(e.readTime)),t}function h0(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:wh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:bc(o,s.key),fields:s.data.value.mapValue.fields,updateTime:vs(o,s.version.toTimestamp()),createTime:vs(o,s.createTime.toTimestamp())}}(n.gt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:$i(e.version)};else{if(!e.isUnknownDocument())return $(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:$i(e.version)}}return r}function wh(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function $i(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Hi(n){let e=new Ae(n.seconds,n.nanoseconds);return q.fromTimestamp(e)}function Pi(n,e){let t=(e.baseMutations||[]).map(o=>xv(n.gt,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let r=e.mutations.map(o=>xv(n.gt,o)),i=Ae.fromMillis(e.localWriteTimeMs);return new Ec(e.batchId,i,t,r)}function ec(n){let e=Hi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Hi(n.lastLimboFreeSnapshotVersion):q.min(),r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){let s=o.documents.length;return H(s===1,1966,{count:s}),at(Rs(tN(o.documents[0])))}(n.query):function(o){return at(oN(o))}(n.query),new _s(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ve.fromBase64String(n.resumeToken))}function uN(n,e){let t=$i(e.snapshotVersion),r=$i(e.lastLimboFreeSnapshotVersion),i;i=fh(e.target)?rN(n.gt,e.target):ff(n.gt,e.target).Vt;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Bi(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function pf(n){let e=oN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?gh(e,e.limit,"L"):e}function $y(n,e){return new wc(e.largestBatchId,xv(n.gt,e.overlayMutation))}function f0(n,e){let t=e.path.lastSegment();return[n,st(e.path.popLast()),t]}function p0(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:$i(r.readTime),documentKey:st(r.documentKey.path),largestBatchId:r.largestBatchId}}var Ov=class{getBundleMetadata(e,t){return g0(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:Hi(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return g0(e).put(function(i){return{bundleId:i.id,createTime:$i(Le(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return m0(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:pf(o.bundledQuery),readTime:Hi(o.readTime)}}(r)})}saveNamedQuery(e,t){return m0(e).put(function(i){return{name:i.name,readTime:$i(Le(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function g0(n){return Ke(n,sf)}function m0(n){return Ke(n,af)}var Th=class n{constructor(e,t){this.serializer=e,this.userId=t}static yt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Qa(e).get(f0(this.userId,t)).next(r=>r?$y(this.serializer,r):null)}getOverlays(e,t){let r=vn();return N.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((o,s)=>{let a=new wc(t,s);i.push(this.wt(e,a))}),N.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(s=>i.add(st(s.getCollectionPath())));let o=[];return i.forEach(s=>{let a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(Qa(e).Y(lv,a))}),N.waitFor(o)}getOverlaysForCollection(e,t,r){let i=vn(),o=st(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Qa(e).j(lv,s).next(a=>{for(let c of a){let l=$y(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let o=vn(),s,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Qa(e).X({index:fA,range:a},(c,l,d)=>{let f=$y(this.serializer,l);o.size()<i||f.largestBatchId===s?(o.set(f.getKey(),f),s=f.largestBatchId):d.done()}).next(()=>o)}wt(e,t){return Qa(e).put(function(i,o,s){let[a,c,l]=f0(o,s.mutation.key);return{userId:o,collectionPath:c,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Cc(i.gt,s.mutation)}}(this.serializer,this.userId,t))}};function Qa(n){return Ke(n,cf)}var Fv=class{St(e){return Ke(e,dI)}getSessionToken(e){return this.St(e).get("sessionToken").next(t=>{let r=t?.value;return r?Ve.fromUint8Array(r):Ve.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}};var Hn=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(Se(e.integerValue));else if("doubleValue"in e){let r=Se(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),dc(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=Gn(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(Kn(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?bA(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):df(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):$(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let i of Object.keys(r))this.xt(i,t),this.Dt(r[i],t)}Lt(e,t){var r,i;let o=e.fields||{};this.Ct(t,53);let s=fs,a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(t,15),t.Ft(Se(a)),this.xt(s,t),this.Dt(o[s],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let i of r)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),V.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};Hn.Ut=new Hn;var Wo=255;function k$(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function y0(n){let e=64-function(r){let i=0;for(let o=0;o<8;++o){let s=k$(255&r[o]);if(i+=s,s!==8)break}return i}(n);return Math.ceil(e/8)}var Lv=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Kt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Wt(r.value),r=t.next();this.Gt()}zt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.jt(r.value),r=t.next();this.Jt()}Ht(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Wt(r);else if(r<2048)this.Wt(960|r>>>6),this.Wt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Wt(480|r>>>12),this.Wt(128|63&r>>>6),this.Wt(128|63&r);else{let i=t.codePointAt(0);this.Wt(240|i>>>18),this.Wt(128|63&i>>>12),this.Wt(128|63&i>>>6),this.Wt(128|63&i)}}this.Gt()}Yt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.jt(r);else if(r<2048)this.jt(960|r>>>6),this.jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.jt(480|r>>>12),this.jt(128|63&r>>>6),this.jt(128|63&r);else{let i=t.codePointAt(0);this.jt(240|i>>>18),this.jt(128|63&i>>>12),this.jt(128|63&i>>>6),this.jt(128|63&i)}}this.Jt()}Zt(e){let t=this.Xt(e),r=y0(t);this.en(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}tn(e){let t=this.Xt(e),r=y0(t);this.en(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}nn(){this.rn(Wo),this.rn(255)}sn(){this._n(Wo),this._n(255)}reset(){this.position=0}seed(e){this.en(e.length),this.buffer.set(e,this.position),this.position+=e.length}an(){return this.buffer.slice(0,this.position)}Xt(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Wt(e){let t=255&e;t===0?(this.rn(0),this.rn(255)):t===Wo?(this.rn(Wo),this.rn(0)):this.rn(t)}jt(e){let t=255&e;t===0?(this._n(0),this._n(255)):t===Wo?(this._n(Wo),this._n(0)):this._n(e)}Gt(){this.rn(0),this.rn(1)}Jt(){this._n(0),this._n(1)}rn(e){this.en(1),this.buffer[this.position++]=e}_n(e){this.en(1),this.buffer[this.position++]=~e}en(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},Vv=class{constructor(e){this.un=e}Nt(e){this.un.Kt(e)}Mt(e){this.un.Ht(e)}Ft(e){this.un.Zt(e)}vt(){this.un.nn()}},jv=class{constructor(e){this.un=e}Nt(e){this.un.zt(e)}Mt(e){this.un.Yt(e)}Ft(e){this.un.tn(e)}vt(){this.un.sn()}},Mi=class{constructor(){this.un=new Lv,this.cn=new Vv(this.un),this.ln=new jv(this.un)}seed(e){this.un.seed(e)}hn(e){return e===0?this.cn:this.ln}an(){return this.un.an()}reset(){this.un.reset()}};var ki=class n{constructor(e,t,r,i){this.Pn=e,this.Tn=t,this.In=r,this.dn=i}En(){let e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new n(this.Pn,this.Tn,this.In,r)}An(e,t,r){return{indexId:this.Pn,uid:e,arrayValue:eh(this.In),directionalValue:eh(this.dn),orderedDocumentKey:eh(t),documentKey:r.path.toArray()}}Rn(e,t,r){let i=this.An(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}};function Er(n,e){let t=n.Pn-e.Pn;return t!==0?t:(t=v0(n.In,e.In),t!==0?t:(t=v0(n.dn,e.dn),t!==0?t:V.comparator(n.Tn,e.Tn)))}function v0(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function eh(n){return Dm()?function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r}(n):n}function _0(n){return typeof n!="string"?n:function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(n)}var Dh=class{constructor(e){this.Vn=new ve((t,r)=>ze.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.mn=e.orderBy,this.fn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.fn.push(r)}}get gn(){return this.Vn.size>1}pn(e){if(H(e.collectionGroup===this.collectionId,49279),this.gn)return!1;let t=rv(e);if(t!==void 0&&!this.yn(t))return!1;let r=Ai(e),i=new Set,o=0,s=0;for(;o<r.length&&this.yn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Vn.size>0){let a=this.Vn.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[o];if(!this.wn(a,c)||!this.Sn(this.mn[s++],c))return!1}++o}for(;o<r.length;++o){let a=r[o];if(s>=this.mn.length||!this.Sn(this.mn[s++],a))return!1}return!0}bn(){if(this.gn)return null;let e=new ve(ze.comparator),t=[];for(let r of this.fn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new qn(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new qn(r.field,0))}for(let r of this.mn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new qn(r.field,r.dir==="asc"?0:1)));return new Pr(Pr.UNKNOWN_ID,this.collectionId,t,as.empty())}yn(e){for(let t of this.fn)if(this.wn(t,e))return!0;return!1}wn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}Sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function lN(n){var e,t;if(H(n instanceof le||n instanceof me,20012),n instanceof le){if(n instanceof hh){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>le.create(n.field,"==",o)))||[];return me.create(i,"or")}return n}let r=n.filters.map(i=>lN(i));return me.create(r,n.op)}function x$(n){if(n.getFilters().length===0)return[];let e=$v(lN(n));return H(dN(e),7391),Bv(e)||Uv(e)?[e]:e.getFilters()}function Bv(n){return n instanceof le}function Uv(n){return n instanceof me&&gI(n)}function dN(n){return Bv(n)||Uv(n)||function(t){if(t instanceof me&&pv(t)){for(let r of t.getFilters())if(!Bv(r)&&!Uv(r))return!1;return!0}return!1}(n)}function $v(n){if(H(n instanceof le||n instanceof me,34018),n instanceof le)return n;if(n.filters.length===1)return $v(n.filters[0]);let e=n.filters.map(r=>$v(r)),t=me.create(e,n.op);return t=bh(t),dN(t)?t:(H(t instanceof me,64498),H(gs(t),40251),H(t.filters.length>1,57927),t.filters.reduce((r,i)=>II(r,i)))}function II(n,e){let t;return H(n instanceof le||n instanceof me,38388),H(e instanceof le||e instanceof me,25473),t=n instanceof le?e instanceof le?function(i,o){return me.create([i,o],"and")}(n,e):I0(n,e):e instanceof le?I0(e,n):function(i,o){if(H(i.filters.length>0&&o.filters.length>0,48005),gs(i)&&gs(o))return RA(i,o.getFilters());let s=pv(i)?i:o,a=pv(i)?o:i,c=s.filters.map(l=>II(l,a));return me.create(c,"or")}(n,e),bh(t)}function I0(n,e){if(gs(e))return RA(e,n.getFilters());{let t=e.filters.map(r=>II(n,r));return me.create(t,"or")}}function bh(n){if(H(n instanceof le||n instanceof me,11850),n instanceof le)return n;let e=n.getFilters();if(e.length===1)return bh(e[0]);if(AA(n))return n;let t=e.map(i=>bh(i)),r=[];return t.forEach(i=>{i instanceof le?r.push(i):i instanceof me&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:me.create(r,n.op)}var Hv=class{constructor(){this.Dn=new Sc}addToCollectionParentIndex(e,t){return this.Dn.add(t),N.resolve()}getCollectionParents(e,t){return N.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return N.resolve()}deleteFieldIndex(e,t){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,t){return N.resolve()}getDocumentsMatchingTarget(e,t){return N.resolve(null)}getIndexType(e,t){return N.resolve(0)}getFieldIndexes(e,t){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,t){return N.resolve($t.min())}getMinOffsetFromCollectionGroup(e,t){return N.resolve($t.min())}updateCollectionGroup(e,t,r){return N.resolve()}updateIndexEntries(e,t){return N.resolve()}},Sc=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new ve(ue.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ve(ue.comparator)).toArray()}};var E0="IndexedDbIndexManager",Hd=new Uint8Array(0),qv=class{constructor(e,t){this.databaseId=t,this.vn=new Sc,this.Cn=new tn(r=>Bi(r),(r,i)=>qc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});let o={collectionId:r,parent:st(i)};return w0(e).put(o)}return N.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[eA(t),""],!1,!0);return w0(e).j(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;r.push(yn(s.parent))}return r})}addFieldIndex(e,t){let r=Ya(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let o=r.add(i);if(t.indexState){let s=Ko(e);return o.next(a=>{s.put(p0(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let r=Ya(e),i=Ko(e),o=Go(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Ya(e),r=Go(e),i=Ko(e);return t.Y().next(()=>r.Y()).next(()=>i.Y())}createTargetIndexes(e,t){return N.forEach(this.Fn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let o=new Dh(r).bn();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let r=Go(e),i=!0,o=new Map;return N.forEach(this.Fn(t),s=>this.Mn(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=X(),a=[];return N.forEach(o,(c,l)=>{x(E0,`Using index ${function(U){return`id=${U.indexId}|cg=${U.collectionGroup}|f=${U.fields.map(W=>`${W.fieldPath}:${W.kind}`).join(",")}`}(c)} to execute ${Bi(t)}`);let d=function(U,W){let de=rv(W);if(de===void 0)return null;for(let K of ph(U,de.fieldPath))switch(K.op){case"array-contains-any":return K.value.arrayValue.values||[];case"array-contains":return[K.value]}return null}(l,c),f=function(U,W){let de=new Map;for(let K of Ai(W))for(let T of ph(U,K.fieldPath))switch(T.op){case"==":case"in":de.set(K.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return de.set(K.fieldPath.canonicalString(),T.value),Array.from(de.values())}return null}(l,c),g=function(U,W){let de=[],K=!0;for(let T of Ai(W)){let _=T.kind===0?t0(U,T.fieldPath,U.startAt):n0(U,T.fieldPath,U.startAt);de.push(_.value),K&&(K=_.inclusive)}return new Dn(de,K)}(l,c),m=function(U,W){let de=[],K=!0;for(let T of Ai(W)){let _=T.kind===0?n0(U,T.fieldPath,U.endAt):t0(U,T.fieldPath,U.endAt);de.push(_.value),K&&(K=_.inclusive)}return new Dn(de,K)}(l,c),w=this.xn(c,l,g),R=this.xn(c,l,m),P=this.On(c,l,f),O=this.Nn(c.indexId,d,w,g.inclusive,R,m.inclusive,P);return N.forEach(O,B=>r.H(B,t.limit).next(U=>{U.forEach(W=>{let de=V.fromSegments(W.documentKey);s.has(de)||(s=s.add(de),a.push(de))})}))}).next(()=>a)}return N.resolve(null)})}Fn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=x$(me.create(e.filters,"and")).map(r=>Tv(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,t),t)}Nn(e,t,r,i,o,s,a){let c=(t!=null?t.length:1)*Math.max(r.length,o.length),l=c/(t!=null?t.length:1),d=[];for(let f=0;f<c;++f){let g=t?this.Bn(t[f/l]):Hd,m=this.Ln(e,g,r[f%l],i),w=this.kn(e,g,o[f%l],s),R=a.map(P=>this.Ln(e,g,P,!0));d.push(...this.createRange(m,w,R))}return d}Ln(e,t,r,i){let o=new ki(e,V.empty(),t,r);return i?o:o.En()}kn(e,t,r,i){let o=new ki(e,V.empty(),t,r);return i?o.En():o}Mn(e,t){let r=new Dh(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let a of o)r.pn(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2,i=this.Fn(t);return N.forEach(i,o=>this.Mn(e,o).next(s=>{s?r!==0&&s.fields.length<function(c){let l=new ve(ze.comparator),d=!1;for(let f of c.filters)for(let g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:l=l.add(g.field));for(let f of c.orderBy)f.field.isKeyField()||(l=l.add(f.field));return l.size+(d?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}qn(e,t){let r=new Mi;for(let i of Ai(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=r.hn(i.kind);Hn.Ut.bt(o,s)}return r.an()}Bn(e){let t=new Mi;return Hn.Ut.bt(e,t.hn(0)),t.an()}Qn(e,t){let r=new Mi;return Hn.Ut.bt(Vi(this.databaseId,t),r.hn(function(o){let s=Ai(o);return s.length===0?0:s[s.length-1].kind}(e))),r.an()}On(e,t,r){if(r===null)return[];let i=[];i.push(new Mi);let o=0;for(let s of Ai(e)){let a=r[o++];for(let c of i)if(this.$n(t,s.fieldPath)&&_c(a))i=this.Un(i,s,a);else{let l=c.hn(s.kind);Hn.Ut.bt(a,l)}}return this.Kn(i)}xn(e,t,r){return this.On(e,t,r.position)}Kn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].an();return t}Un(e,t,r){let i=[...e],o=[];for(let s of r.arrayValue.values||[])for(let a of i){let c=new Mi;c.seed(a.an()),Hn.Ut.bt(s,c.hn(t.kind)),o.push(c)}return o}$n(e,t){return!!e.filters.find(r=>r instanceof le&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Ya(e),i=Ko(e);return(t?r.j(uv,IDBKeyRange.bound(t,t)):r.j()).next(o=>{let s=[];return N.forEach(o,a=>i.get([a.indexId,this.uid]).next(c=>{s.push(function(d,f){let g=f?new as(f.sequenceNumber,new $t(Hi(f.readTime),new V(yn(f.documentKey)),f.largestBatchId)):as.empty(),m=d.fields.map(([w,R])=>new qn(ze.fromServerFormat(w),R));return new Pr(d.indexId,d.collectionGroup,m,g)}(a,c))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:z(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Ya(e),o=Ko(e);return this.Wn(e).next(s=>i.j(uv,IDBKeyRange.bound(t,t)).next(a=>N.forEach(a,c=>o.put(p0(c.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){let r=new Map;return N.forEach(t,(i,o)=>{let s=r.get(i.collectionGroup);return(s?N.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),N.forEach(a,c=>this.Gn(e,i,c).next(l=>{let d=this.zn(o,c);return l.isEqual(d)?N.resolve():this.jn(e,o,c,l,d)}))))})}Jn(e,t,r,i){return Go(e).put(i.An(this.uid,this.Qn(r,t.key),t.key))}Hn(e,t,r,i){return Go(e).delete(i.Rn(this.uid,this.Qn(r,t.key),t.key))}Gn(e,t,r){let i=Go(e),o=new ve(Er);return i.X({index:hA,range:IDBKeyRange.only([r.indexId,this.uid,eh(this.Qn(r,t))])},(s,a)=>{o=o.add(new ki(r.indexId,t,_0(a.arrayValue),_0(a.directionalValue)))}).next(()=>o)}zn(e,t){let r=new ve(Er),i=this.qn(t,e);if(i==null)return r;let o=rv(t);if(o!=null){let s=e.data.field(o.fieldPath);if(_c(s))for(let a of s.arrayValue.values||[])r=r.add(new ki(t.indexId,e.key,this.Bn(a),i))}else r=r.add(new ki(t.indexId,e.key,Hd,i));return r}jn(e,t,r,i,o){x(E0,"Updating index entries for document '%s'",t.key);let s=[];return function(c,l,d,f,g){let m=c.getIterator(),w=l.getIterator(),R=zo(m),P=zo(w);for(;R||P;){let O=!1,B=!1;if(R&&P){let U=d(R,P);U<0?B=!0:U>0&&(O=!0)}else R!=null?B=!0:O=!0;O?(f(P),P=zo(w)):B?(g(R),R=zo(m)):(R=zo(m),P=zo(w))}}(i,o,Er,a=>{s.push(this.Jn(e,t,r,a))},a=>{s.push(this.Hn(e,t,r,a))}),N.waitFor(s)}Wn(e){let t=1;return Ko(e).X({index:dA,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>Er(s,a)).filter((s,a,c)=>!a||Er(s,c[a-1])!==0);let i=[];i.push(e);for(let s of r){let a=Er(s,e),c=Er(s,t);if(a===0)i[0]=e.En();else if(a>0&&c<0)i.push(s),i.push(s.En());else if(c>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.Yn(i[s],i[s+1]))return[];let a=i[s].Rn(this.uid,Hd,V.empty()),c=i[s+1].Rn(this.uid,Hd,V.empty());o.push(IDBKeyRange.bound(a,c))}return o}Yn(e,t){return Er(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(T0)}getMinOffset(e,t){return N.mapArray(this.Fn(t),r=>this.Mn(e,r).next(i=>i||$(44426))).next(T0)}};function w0(n){return Ke(n,pc)}function Go(n){return Ke(n,rc)}function Ya(n){return Ke(n,lI)}function Ko(n){return Ke(n,nc)}function T0(n){H(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;aI(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new $t(e.readTime,e.documentKey,t)}var D0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},hN=41943040,Dt=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};function fN(n,e,t){let r=n.store(Xt),i=n.store(cs),o=[],s=IDBKeyRange.only(t.batchId),a=0,c=r.X({range:s},(d,f,g)=>(a++,g.delete()));o.push(c.next(()=>{H(a===1,47070,{batchId:t.batchId})}));let l=[];for(let d of t.mutations){let f=cA(e,d.key.path,t.batchId);o.push(i.delete(f)),l.push(d.key)}return N.waitFor(o).next(()=>l)}function Ch(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw $(14731);e=n.noDocument}return JSON.stringify(e).length}Dt.DEFAULT_COLLECTION_PERCENTILE=10,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dt.DEFAULT=new Dt(hN,Dt.DEFAULT_COLLECTION_PERCENTILE,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dt.DISABLED=new Dt(-1,0,0);var Sh=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Zn={}}static yt(e,t,r,i){H(e.uid!=="",64387);let o=e.isAuthenticated()?e.uid:"";return new n(o,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return wr(e).X({index:xi,range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let o=Xo(e),s=wr(e);return s.add({}).next(a=>{H(typeof a=="number",49019);let c=new Ec(a,t,r,i),l=function(m,w,R){let P=R.baseMutations.map(B=>Cc(m.gt,B)),O=R.mutations.map(B=>Cc(m.gt,B));return{userId:w,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:P,mutations:O}}(this.serializer,this.userId,c),d=[],f=new ve((g,m)=>z(g.canonicalString(),m.canonicalString()));for(let g of i){let m=cA(this.userId,g.key.path,a);f=f.add(g.key.path.popLast()),d.push(s.put(l)),d.push(o.put(m,OU))}return f.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Zn[a]=c.keys()}),N.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return wr(e).get(t).next(r=>r?(H(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Pi(this.serializer,r)):null)}Xn(e,t){return this.Zn[t]?N.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Zn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return wr(e).X({index:xi,range:i},(s,a,c)=>{a.userId===this.userId&&(H(a.batchId>=r,47524,{er:r}),o=Pi(this.serializer,a)),c.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=Ar;return wr(e).X({index:xi,range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,Ar],[this.userId,Number.POSITIVE_INFINITY]);return wr(e).j(xi,t).next(r=>r.map(i=>Pi(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Kd(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Xo(e).X({range:i},(s,a,c)=>{let[l,d,f]=s,g=yn(d);if(l===this.userId&&t.path.isEqual(g))return wr(e).get(f).next(m=>{if(!m)throw $(61480,{tr:s,batchId:f});H(m.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:m.userId,batchId:f}),o.push(Pi(this.serializer,m))});c.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ve(z),i=[];return t.forEach(o=>{let s=Kd(this.userId,o.path),a=IDBKeyRange.lowerBound(s),c=Xo(e).X({range:a},(l,d,f)=>{let[g,m,w]=l,R=yn(m);g===this.userId&&o.path.isEqual(R)?r=r.add(w):f.done()});i.push(c)}),N.waitFor(i).next(()=>this.nr(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=Kd(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new ve(z);return Xo(e).X({range:s},(c,l,d)=>{let[f,g,m]=c,w=yn(g);f===this.userId&&r.isPrefixOf(w)?w.length===i&&(a=a.add(m)):d.done()}).next(()=>this.nr(e,a))}nr(e,t){let r=[],i=[];return t.forEach(o=>{i.push(wr(e).get(o).next(s=>{if(s===null)throw $(35274,{batchId:o});H(s.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:s.userId,batchId:o}),r.push(Pi(this.serializer,s))}))}),N.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return fN(e.ce,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.rr(t.batchId)}),N.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}rr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return N.resolve();let r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return Xo(e).X({range:r},(o,s,a)=>{if(o[0]===this.userId){let c=yn(o[1]);i.push(c)}else a.done()}).next(()=>{H(i.length===0,56720,{ir:i.map(o=>o.canonicalString())})})})}containsKey(e,t){return pN(e,this.userId,t)}sr(e){return gN(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ar,lastStreamToken:""})}};function pN(n,e,t){let r=Kd(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Xo(n).X({range:o,Z:!0},(a,c,l)=>{let[d,f,g]=a;d===e&&f===i&&(s=!0),l.done()}).next(()=>s)}function wr(n){return Ke(n,Xt)}function Xo(n){return Ke(n,cs)}function gN(n){return Ke(n,hc)}var Is=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var zv=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.cr(e).next(t=>{let r=new Is(t.highestTargetId);return t.highestTargetId=r.next(),this.lr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.cr(e).next(t=>q.fromTimestamp(new Ae(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.cr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.cr(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.lr(e,i)))}addTargetData(e,t){return this.hr(e,t).next(()=>this.cr(e).next(r=>(r.targetCount+=1,this.Pr(t,r),this.lr(e,r))))}updateTargetData(e,t){return this.hr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Qo(e).delete(t.targetId)).next(()=>this.cr(e)).next(r=>(H(r.targetCount>0,8065),r.targetCount-=1,this.lr(e,r)))}removeTargets(e,t,r){let i=0,o=[];return Qo(e).X((s,a)=>{let c=ec(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,o.push(this.removeTargetData(e,c)))}).next(()=>N.waitFor(o)).next(()=>i)}forEachTarget(e,t){return Qo(e).X((r,i)=>{let o=ec(i);t(o)})}cr(e){return b0(e).get(ch).next(t=>(H(t!==null,2888),t))}lr(e,t){return b0(e).put(ch,t)}hr(e,t){return Qo(e).put(uN(this.serializer,t))}Pr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.cr(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Bi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Qo(e).X({range:i,index:lA},(s,a,c)=>{let l=ec(a);qc(t,l.target)&&(o=l,c.done())}).next(()=>o)}addMatchingKeys(e,t,r){let i=[],o=br(e);return t.forEach(s=>{let a=st(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),N.waitFor(i)}removeMatchingKeys(e,t,r){let i=br(e);return N.forEach(t,o=>{let s=st(o.path);return N.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){let r=br(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=br(e),o=X();return i.X({range:r,Z:!0},(s,a,c)=>{let l=yn(s[1]),d=new V(l);o=o.add(d)}).next(()=>o)}containsKey(e,t){let r=st(t.path),i=IDBKeyRange.bound([r],[eA(r)],!1,!0),o=0;return br(e).X({index:uI,Z:!0,range:i},([s,a],c,l)=>{s!==0&&(o++,l.done())}).next(()=>o>0)}Et(e,t){return Qo(e).get(t).next(r=>r?ec(r):null)}};function Qo(n){return Ke(n,us)}function b0(n){return Ke(n,Li)}function br(n){return Ke(n,ls)}var C0="LruGarbageCollector",mN=1048576;function S0([n,e],[t,r]){let i=z(n,t);return i===0?z(e,r):i}var Wv=class{constructor(e){this.Tr=e,this.buffer=new ve(S0),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();S0(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Ah=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){x(C0,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>v(this,null,function*(){this.Ar=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){$r(t)?x(C0,"Ignoring IndexedDB error during garbage collection: ",t):yield Ur(t)}yield this.Rr(3e5)}))}},Gv=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return N.resolve(xt.ue);let r=new Wv(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(x("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(D0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(x("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),D0):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,o,s,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(x("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,s=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(o=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(l=Date.now(),Yo()<=se.DEBUG&&x("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:f})))}};function yN(n,e){return new Gv(n,e)}var Kv=class{constructor(e,t){this.db=e,this.garbageCollector=yN(this,t)}mr(e){let t=this.yr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}gr(e,t){return this.wr(e,(r,i)=>t(i))}addReference(e,t,r){return qd(e,r)}removeReference(e,t,r){return qd(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return qd(e,t)}Sr(e,t){return function(i,o){let s=!1;return gN(i).ee(a=>pN(i,a,o).next(c=>(c&&(s=!0),N.resolve(!c)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.wr(e,(s,a)=>{if(a<=t){let c=this.Sr(e,s).next(l=>{if(!l)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,q.min()),br(e).delete(function(f){return[0,st(f.path)]}(s))))});i.push(c)}}).next(()=>N.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return qd(e,t)}wr(e,t){let r=br(e),i,o=xt.ue;return r.X({index:uI},([s,a],{path:c,sequenceNumber:l})=>{s===0?(o!==xt.ue&&t(new V(yn(i)),o),o=l,i=c):o=xt.ue}).next(()=>{o!==xt.ue&&t(new V(yn(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function qd(n,e){return br(n).put(function(r,i){return{targetId:0,path:st(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var Nh=class{constructor(){this.changes=new tn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,We.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?N.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Qv=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Si(e).put(r)}removeEntry(e,t,r){return Si(e).delete(function(o,s){let a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],wh(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.br(e,r)))}getEntry(e,t){let r=We.newInvalidDocument(t);return Si(e).X({index:Qd,range:IDBKeyRange.only(Za(t))},(i,o)=>{r=this.Dr(t,o)}).next(()=>r)}vr(e,t){let r={size:0,document:We.newInvalidDocument(t)};return Si(e).X({index:Qd,range:IDBKeyRange.only(Za(t))},(i,o)=>{r={document:this.Dr(t,o),size:Ch(o)}}).next(()=>r)}getEntries(e,t){let r=bt();return this.Cr(e,t,(i,o)=>{let s=this.Dr(i,o);r=r.insert(i,s)}).next(()=>r)}Fr(e,t){let r=bt(),i=new be(V.comparator);return this.Cr(e,t,(o,s)=>{let a=this.Dr(o,s);r=r.insert(o,a),i=i.insert(o,Ch(s))}).next(()=>({documents:r,Mr:i}))}Cr(e,t,r){if(t.isEmpty())return N.resolve();let i=new ve(R0);t.forEach(c=>i=i.add(c));let o=IDBKeyRange.bound(Za(i.first()),Za(i.last())),s=i.getIterator(),a=s.getNext();return Si(e).X({index:Qd,range:o},(c,l,d)=>{let f=V.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&R0(a,f)<0;)r(a,null),a=s.getNext();a&&a.isEqual(f)&&(r(a,l),a=s.hasNext()?s.getNext():null),a?d.G(Za(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),wh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Si(e).j(IDBKeyRange.bound(a,c,!0)).next(l=>{o?.incrementDocumentReadCount(l.length);let d=bt();for(let f of l){let g=this.Dr(V.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(Wc(t,g)||i.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,i){let o=bt(),s=N0(t,r),a=N0(t,$t.max());return Si(e).X({index:uA,range:IDBKeyRange.bound(s,a,!0)},(c,l,d)=>{let f=this.Dr(V.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);o=o.insert(f.key,f),o.size===i&&d.done()}).next(()=>o)}newChangeBuffer(e){return new Yv(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return A0(e).get(cv).next(t=>(H(!!t,20021),t))}br(e,t){return A0(e).put(cv,t)}Dr(e,t){if(t){let r=M$(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(q.min())))return r}return We.newInvalidDocument(e)}};function vN(n){return new Qv(n)}var Yv=class extends Nh{constructor(e,t){super(),this.Or=e,this.trackRemovals=t,this.Nr=new tn(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new ve((o,s)=>z(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let a=this.Nr.get(o);if(t.push(this.Or.removeEntry(e,o,a.readTime)),s.isValidDocument()){let c=h0(this.Or.serializer,s);i=i.add(o.path.popLast());let l=Ch(c);r+=l-a.size,t.push(this.Or.addEntry(e,o,c))}else if(r-=a.size,this.trackRemovals){let c=h0(this.Or.serializer,s.convertToNoDocument(q.min()));t.push(this.Or.addEntry(e,o,c))}}),i.forEach(o=>{t.push(this.Or.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.Or.updateMetadata(e,r)),N.waitFor(t)}getFromCache(e,t){return this.Or.vr(e,t).next(r=>(this.Nr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Or.Fr(e,t).next(({documents:r,Mr:i})=>(i.forEach((o,s)=>{this.Nr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}};function A0(n){return Ke(n,fc)}function Si(n){return Ke(n,ah)}function Za(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function N0(n,e){let t=e.documentKey.path.toArray();return[n,wh(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function R0(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=z(t[o],r[o]),i)return i;return i=z(t.length,r.length),i||(i=z(t[t.length-2],r[r.length-2]),i||z(t[t.length-1],r[r.length-1]))}var Zv=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Rh=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&sc(r.mutation,i,Ot.empty(),Ae.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,X()).next(()=>r))}getLocalViewOfDocuments(e,t,r=X()){let i=vn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=Xa();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=vn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,X()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=bt(),s=oc(),a=function(){return oc()}();return t.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof nn)?o=o.insert(l.key,l):d!==void 0?(s.set(l.key,d.mutation.getFieldMask()),sc(d.mutation,l,d.mutation.getFieldMask(),Ae.now())):s.set(l.key,Ot.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((l,d)=>s.set(l,d)),t.forEach((l,d)=>{var f;return a.set(l,new Zv(d,(f=s.get(l))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){let r=oc(),i=new be((s,a)=>s-a),o=X();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=r.get(c)||Ot.empty();d=a.applyToLocalView(l,d),r.set(c,d);let f=(i.get(a.batchId)||X()).add(c);i=i.insert(a.batchId,f)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,f=UA();d.forEach(g=>{if(!o.has(g)){let m=KA(t.get(g),r.get(g));m!==null&&f.set(g,m),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,f))}return N.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return V.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):mI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):N.resolve(vn()),a=ss,c=o;return s.next(l=>N.forEach(l,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),o.get(d)?N.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{c=c.insert(d,g)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,c,l,X())).next(d=>({batchId:a,changes:BA(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new V(t)).next(r=>{let i=Xa();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=Xa();return this.indexManager.getCollectionParents(e,o).next(a=>N.forEach(a,c=>{let l=function(f,g){return new en(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((f,g)=>{s=s.insert(f,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((c,l)=>{let d=l.getKey();s.get(d)===null&&(s=s.insert(d,We.newInvalidDocument(d)))});let a=Xa();return s.forEach((c,l)=>{let d=o.get(c);d!==void 0&&sc(d.mutation,l,Ot.empty(),Ae.now()),Wc(t,l)&&(a=a.insert(c,l))}),a})}};var Jv=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return N.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Le(i.createTime)}}(t)),N.resolve()}getNamedQuery(e,t){return N.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(i){return{name:i.name,query:pf(i.bundledQuery),readTime:Le(i.readTime)}}(t)),N.resolve()}};var Xv=class{constructor(){this.overlays=new be(V.comparator),this.kr=new Map}getOverlay(e,t){return N.resolve(this.overlays.get(t))}getOverlays(e,t){let r=vn();return N.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.wt(e,t,o)}),N.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(r)),N.resolve()}getOverlaysForCollection(e,t,r){let i=vn(),o=t.length+1,s=new V(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&c.largestBatchId>r&&i.set(c.getKey(),c)}return N.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new be((l,d)=>l-d),s=this.overlays.getIterator();for(;s.hasNext();){let l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=o.get(l.largestBatchId);d===null&&(d=vn(),o=o.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=vn(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return N.resolve(a)}wt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new wc(t,r));let o=this.kr.get(t);o===void 0&&(o=X(),this.kr.set(t,o)),this.kr.set(t,o.add(r.key))}};var e_=class{constructor(){this.sessionToken=Ve.EMPTY_BYTE_STRING}getSessionToken(e){return N.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,N.resolve()}};var Ac=class{constructor(){this.qr=new ve(Ue.Qr),this.$r=new ve(Ue.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new Ue(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new Ue(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new V(new ue([])),r=new Ue(t,e),i=new Ue(t,e+1),o=[];return this.$r.forEachInRange([r,i],s=>{this.Wr(s),o.push(s.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new V(new ue([])),r=new Ue(t,e),i=new Ue(t,e+1),o=X();return this.$r.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new Ue(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ue=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return V.comparator(e.key,t.key)||z(e.Hr,t.Hr)}static Ur(e,t){return z(e.Hr,t.Hr)||V.comparator(e.key,t.key)}};var t_=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new ve(Ue.Qr)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Ec(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.Yr=this.Yr.add(new Ue(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return N.resolve(s)}lookupMutationBatch(e,t){return N.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),o=i<0?0:i;return N.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?Ar:this.er-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ue(t,0),i=new Ue(t,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([r,i],s=>{let a=this.Zr(s.Hr);o.push(a)}),N.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ve(z);return t.forEach(i=>{let o=new Ue(i,0),s=new Ue(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,s],a=>{r=r.add(a.Hr)})}),N.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;V.isDocumentKey(o)||(o=o.child(""));let s=new Ue(new V(o),0),a=new ve(z);return this.Yr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.Hr)),!0)},s),N.resolve(this.ei(a))}ei(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){H(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return N.forEach(t.mutations,i=>{let o=new Ue(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new Ue(t,0),i=this.Yr.firstAfterOrEqual(r);return N.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var n_=class{constructor(e){this.ni=e,this.docs=function(){return new be(V.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return N.resolve(r?r.document.mutableCopy():We.newInvalidDocument(t))}getEntries(e,t){let r=bt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():We.newInvalidDocument(i))}),N.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=bt(),s=t.path,a=new V(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||aI(iA(d),r)<=0||(i.has(d.key)||Wc(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return N.resolve(o)}getAllFromCollectionGroup(e,t,r,i){$(9500)}ri(e,t){return N.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new r_(this)}getSize(e){return N.resolve(this.size)}},r_=class extends Nh{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),N.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var i_=class{constructor(e){this.persistence=e,this.ii=new tn(t=>Bi(t),qc),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.si=0,this.oi=new Ac,this.targetCount=0,this._i=Is.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),N.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new Is(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,N.resolve()}updateTargetData(e,t){return this.hr(t),N.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.ii.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ii.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),N.waitFor(o).next(()=>i)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return N.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),N.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),N.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),N.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return N.resolve(r)}containsKey(e,t){return N.resolve(this.oi.containsKey(t))}};var Nc=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new xt(0),this.ci=!1,this.ci=!0,this.li=new e_,this.referenceDelegate=e(this),this.hi=new i_(this),this.indexManager=new Hv,this.remoteDocumentCache=function(i){return new n_(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new Eh(t),this.Ti=new Jv(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Xv,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new t_(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){x("MemoryPersistence","Starting transaction:",e);let i=new o_(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ei(e,t){return N.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},o_=class extends ih{constructor(e){super(),this.currentSequenceNumber=e}},Ph=class n{constructor(e){this.persistence=e,this.Ai=new Ac,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw $(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),N.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),N.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.mi.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.mi,r=>{let i=V.fromPath(r);return this.fi(e,i).next(o=>{o||t.removeEntry(i,q.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return N.or([()=>N.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Mh=class n{constructor(e,t){this.persistence=e,this.gi=new tn(r=>st(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=yN(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return N.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return N.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(o=>o?N.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ri(e,s=>this.Sr(e,s,t).next(a=>{a||(r++,o.removeEntry(s,q.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),N.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),N.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),N.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),N.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Zd(e.data.value)),t}Sr(e,t,r){return N.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.gi.get(t);return N.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var s_=class{constructor(e){this.serializer=e}q(e,t,r,i){let o=new oh("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore(Hc)}(e),function(c){c.createObjectStore(hc,{keyPath:xU}),c.createObjectStore(Xt,{keyPath:qS,autoIncrement:!0}).createIndex(xi,zS,{unique:!0}),c.createObjectStore(cs)}(e),P0(e),function(c){c.createObjectStore(Ni)}(e));let s=N.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore(ls),c.deleteObjectStore(us),c.deleteObjectStore(Li)}(e),P0(e)),s=s.next(()=>function(c){let l=c.store(Li),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:q.min().toTimestamp(),targetCount:0};return l.put(ch,d)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(c,l){return l.store(Xt).j().next(f=>{c.deleteObjectStore(Xt),c.createObjectStore(Xt,{keyPath:qS,autoIncrement:!0}).createIndex(xi,zS,{unique:!0});let g=l.store(Xt),m=f.map(w=>g.put(w));return N.waitFor(m)})}(e,o))),s=s.next(()=>{(function(c){c.createObjectStore(ds,{keyPath:HU})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.pi(o))),r<6&&i>=6&&(s=s.next(()=>(function(c){c.createObjectStore(fc)}(e),this.yi(o)))),r<7&&i>=7&&(s=s.next(()=>this.wi(o))),r<8&&i>=8&&(s=s.next(()=>this.Si(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.bi(o))),r<11&&i>=11&&(s=s.next(()=>{(function(c){c.createObjectStore(sf,{keyPath:qU})})(e),function(c){c.createObjectStore(af,{keyPath:zU})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(c){let l=c.createObjectStore(cf,{keyPath:JU});l.createIndex(lv,XU,{unique:!1}),l.createIndex(fA,e$,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(c){let l=c.createObjectStore(ah,{keyPath:FU});l.createIndex(Qd,LU),l.createIndex(uA,VU)}(e)).next(()=>this.Di(e,o)).next(()=>e.deleteObjectStore(Ni))),r<14&&i>=14&&(s=s.next(()=>this.Ci(e,o))),r<15&&i>=15&&(s=s.next(()=>function(c){c.createObjectStore(lI,{keyPath:WU,autoIncrement:!0}).createIndex(uv,GU,{unique:!1}),c.createObjectStore(nc,{keyPath:KU}).createIndex(dA,QU,{unique:!1}),c.createObjectStore(rc,{keyPath:YU}).createIndex(hA,ZU,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore(nc).clear()}).next(()=>{t.objectStore(rc).clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(c){c.createObjectStore(dI,{keyPath:t$})})(e)})),r<18&&i>=18&&Dm()&&(s=s.next(()=>{t.objectStore(nc).clear()}).next(()=>{t.objectStore(rc).clear()})),s}yi(e){let t=0;return e.store(Ni).X((r,i)=>{t+=Ch(i)}).next(()=>{let r={byteSize:t};return e.store(fc).put(cv,r)})}pi(e){let t=e.store(hc),r=e.store(Xt);return t.j().next(i=>N.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,Ar],[o.userId,o.lastAcknowledgedBatchId]);return r.j(xi,s).next(a=>N.forEach(a,c=>{H(c.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});let l=Pi(this.serializer,c);return fN(e,o.userId,l).next(()=>{})}))}))}wi(e){let t=e.store(ls),r=e.store(Ni);return e.store(Li).get(ch).next(i=>{let o=[];return r.X((s,a)=>{let c=new ue(s),l=function(f){return[0,st(f)]}(c);o.push(t.get(l).next(d=>d?N.resolve():(f=>t.put({targetId:0,path:st(f),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>N.waitFor(o))})}Si(e,t){e.createObjectStore(pc,{keyPath:$U});let r=t.store(pc),i=new Sc,o=s=>{if(i.add(s)){let a=s.lastSegment(),c=s.popLast();return r.put({collectionId:a,parent:st(c)})}};return t.store(Ni).X({Z:!0},(s,a)=>{let c=new ue(s);return o(c.popLast())}).next(()=>t.store(cs).X({Z:!0},([s,a,c],l)=>{let d=yn(a);return o(d.popLast())}))}bi(e){let t=e.store(us);return t.X((r,i)=>{let o=ec(i),s=uN(this.serializer,o);return t.put(s)})}Di(e,t){let r=t.store(Ni),i=[];return r.X((o,s)=>{let a=t.store(ah),c=function(f){return f.document?new V(ue.fromString(f.document.name).popFirst(5)):f.noDocument?V.fromSegments(f.noDocument.path):f.unknownDocument?V.fromSegments(f.unknownDocument.path):$(36783)}(s).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(l))}).next(()=>N.waitFor(i))}Ci(e,t){let r=t.store(Xt),i=vN(this.serializer),o=new Nc(Ph.Vi,this.serializer.gt);return r.j().next(s=>{let a=new Map;return s.forEach(c=>{var l;let d=(l=a.get(c.userId))!==null&&l!==void 0?l:X();Pi(this.serializer,c).keys().forEach(f=>d=d.add(f)),a.set(c.userId,d)}),N.forEach(a,(c,l)=>{let d=new $e(l),f=Th.yt(this.serializer,d),g=o.getIndexManager(d),m=Sh.yt(d,this.serializer,g,o.referenceDelegate);return new Rh(i,m,f,g).recalculateAndSaveOverlaysForDocumentKeys(new gc(t,xt.ue),c).next()})})}};function P0(n){n.createObjectStore(ls,{keyPath:BU}).createIndex(uI,UU,{unique:!0}),n.createObjectStore(us,{keyPath:"targetId"}).createIndex(lA,jU,{unique:!0}),n.createObjectStore(Li)}var Tr="IndexedDbPersistence",Hy=18e5,qy=5e3,zy="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",_N="main",a_=class n{constructor(e,t,r,i,o,s,a,c,l,d,f=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Fi=o,this.window=s,this.document=a,this.Mi=l,this.xi=d,this.Oi=f,this.ui=null,this.ci=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.Bi=null,this.Li=null,this.ki=Number.NEGATIVE_INFINITY,this.qi=g=>Promise.resolve(),!n.C())throw new k(S.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Kv(this,i),this.Qi=t+_N,this.serializer=new Eh(c),this.$i=new Mr(this.Qi,this.Oi,new s_(this.serializer)),this.li=new Fv,this.hi=new zv(this.referenceDelegate,this.serializer),this.remoteDocumentCache=vN(this.serializer),this.Ti=new Ov,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,d===!1&&Fe(Tr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ki().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(S.FAILED_PRECONDITION,zy);return this.Wi(),this.Gi(),this.zi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.hi.getHighestSequenceNumber(e))}).then(e=>{this.ui=new xt(e,this.Mi)}).then(()=>{this.ci=!0}).catch(e=>(this.$i&&this.$i.close(),Promise.reject(e)))}ji(e){return this.qi=t=>v(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.$i.setDatabaseDeletedListener(e)}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Fi.enqueueAndForget(()=>v(this,null,function*(){this.started&&(yield this.Ki())})))}Ki(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>zd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ji(e).next(t=>{t||(this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)))})}).next(()=>this.Hi(e)).next(t=>this.isPrimary&&!t?this.Yi(e).next(()=>!1):!!t&&this.Zi(e).next(()=>!0))).catch(e=>{if($r(e))return x(Tr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return x(Tr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Fi.enqueueRetryable(()=>this.qi(e)),this.isPrimary=e})}Ji(e){return Ja(e).get(qo).next(t=>N.resolve(this.Xi(t)))}es(e){return zd(e).delete(this.clientId)}ts(){return v(this,null,function*(){if(this.isPrimary&&!this.ns(this.ki,Hy)){this.ki=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Ke(t,ds);return r.j().next(i=>{let o=this.rs(i,Hy),s=i.filter(a=>o.indexOf(a)===-1);return N.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Ui)for(let t of e)this.Ui.removeItem(this.ss(t.clientId))}})}zi(){this.Li=this.Fi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ki().then(()=>this.ts()).then(()=>this.zi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.xi?N.resolve(!0):Ja(e).get(qo).next(t=>{if(t!==null&&this.ns(t.leaseTimestampMs,qy)&&!this._s(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new k(S.FAILED_PRECONDITION,zy);return!1}}return!(!this.networkEnabled||!this.inForeground)||zd(e).j().next(r=>this.rs(r,qy).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&x(Tr,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return v(this,null,function*(){this.ci=!1,this.us(),this.Li&&(this.Li.cancel(),this.Li=null),this.cs(),this.ls(),yield this.$i.runTransaction("shutdown","readwrite",[Hc,ds],e=>{let t=new gc(e,xt.ue);return this.Yi(t).next(()=>this.es(t))}),this.$i.close(),this.hs()})}rs(e,t){return e.filter(r=>this.ns(r.updateTimeMs,t)&&!this._s(r.clientId))}Ps(){return this.runTransaction("getActiveClients","readonly",e=>zd(e).j().next(t=>this.rs(t,Hy).map(r=>r.clientId)))}get started(){return this.ci}getGlobalsCache(){return this.li}getMutationQueue(e,t){return Sh.yt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new qv(e,this.serializer.gt.databaseId)}getDocumentOverlayCache(e){return Th.yt(this.serializer,e)}getBundleCache(){return this.Ti}runTransaction(e,t,r){x(Tr,"Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=function(c){return c===18?i$:c===17?yA:c===16?r$:c===15?hI:c===14?mA:c===13?gA:c===12?n$:c===11?pA:void $(60245)}(this.Oi),s;return this.$i.runTransaction(e,i,o,a=>(s=new gc(a,this.ui?this.ui.next():xt.ue),t==="readwrite-primary"?this.Ji(s).next(c=>!!c||this.Hi(s)).next(c=>{if(!c)throw Fe(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Fi.enqueueRetryable(()=>this.qi(!1)),new k(S.FAILED_PRECONDITION,oA);return r(s)}).next(c=>this.Zi(s).next(()=>c)):this.Ts(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}Ts(e){return Ja(e).get(qo).next(t=>{if(t!==null&&this.ns(t.leaseTimestampMs,qy)&&!this._s(t.ownerId)&&!this.Xi(t)&&!(this.xi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new k(S.FAILED_PRECONDITION,zy)})}Zi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ja(e).put(qo,t)}static C(){return Mr.C()}Yi(e){let t=Ja(e);return t.get(qo).next(r=>this.Xi(r)?(x(Tr,"Releasing primary lease."),t.delete(qo)):N.resolve())}ns(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(Fe(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Bi=()=>{this.Fi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ki()))},this.document.addEventListener("visibilitychange",this.Bi),this.inForeground=this.document.visibilityState==="visible")}cs(){this.Bi&&(this.document.removeEventListener("visibilitychange",this.Bi),this.Bi=null)}Gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ni=()=>{this.us();let t=/(?:Version|Mobile)\/1[456]/;Tm()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Fi.enterRestrictedMode(!0),this.Fi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ni))}ls(){this.Ni&&(this.window.removeEventListener("pagehide",this.Ni),this.Ni=null)}_s(e){var t;try{let r=((t=this.Ui)===null||t===void 0?void 0:t.getItem(this.ss(e)))!==null;return x(Tr,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Fe(Tr,"Failed to get zombied client id.",r),!1}}us(){if(this.Ui)try{this.Ui.setItem(this.ss(this.clientId),String(Date.now()))}catch(e){Fe("Failed to set zombie client id.",e)}}hs(){if(this.Ui)try{this.Ui.removeItem(this.ss(this.clientId))}catch{}}ss(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Ja(n){return Ke(n,Hc)}function zd(n){return Ke(n,ds)}function EI(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var c_=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=X(),i=X();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var u_=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var kh=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return Tm()?8:sA(Oe())>0?6:4}()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.ps(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ys(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new u_;return this.ws(e,t,s).next(a=>{if(o.result=a,this.Rs)return this.Ss(e,t,s,a.size)})}).next(()=>o.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(Yo()<=se.DEBUG&&x("QueryEngine","SDK will not create cache indexes for query:",Zo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),N.resolve()):(Yo()<=se.DEBUG&&x("QueryEngine","Query:",Zo(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Yo()<=se.DEBUG&&x("QueryEngine","The SDK decides to create cache indexes for query:",Zo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,at(t))):N.resolve())}ps(e,t){if(r0(t))return N.resolve(null);let r=at(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=gh(t,null,"F"),r=at(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=X(...o);return this.gs.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.bs(t,a);return this.Ds(t,l,s,c.readTime)?this.ps(e,gh(t,null,"F")):this.vs(e,l,t,c)}))})))}ys(e,t,r,i){return r0(t)||i.isEqual(q.min())?N.resolve(null):this.gs.getDocuments(e,r).next(o=>{let s=this.bs(t,o);return this.Ds(t,s,r,i)?N.resolve(null):(Yo()<=se.DEBUG&&x("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Zo(t)),this.vs(e,s,t,rA(i,ss)).next(a=>a))})}bs(e,t){let r=new ve(VA(e));return t.forEach((i,o)=>{Wc(e,o)&&(r=r.add(o))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ws(e,t,r){return Yo()<=se.DEBUG&&x("QueryEngine","Using full collection scan to execute query:",Zo(t)),this.gs.getDocumentsMatchingQuery(e,t,$t.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var wI="LocalStore",O$=3e8,l_=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new be(z),this.Ms=new tn(o=>Bi(o),qc),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Rh(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function IN(n,e,t,r){return new l_(n,e,t,r)}function EN(n,e){return v(this,null,function*(){let t=F(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],c=X();for(let l of i){s.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of o){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(l=>({Bs:l,removedBatchIds:s,addedBatchIds:a}))})})})}function F$(n,e){let t=F(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.Os.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let f=l.batch,g=f.keys(),m=N.resolve();return g.forEach(w=>{m=m.next(()=>d.getEntry(c,w)).next(R=>{let P=l.docVersions.get(w);H(P!==null,48541),R.version.compareTo(P)<0&&(f.applyToRemoteDocument(R,l),R.isValidDocument()&&(R.setReadTime(l.commitVersion),d.addEntry(R)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=X();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function wN(n){let e=F(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function L$(n,e){let t=F(n),r=e.snapshotVersion,i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;let a=[];e.targetChanges.forEach((d,f)=>{let g=i.get(f);if(!g)return;a.push(t.hi.removeMatchingKeys(o,d.removedDocuments,f).next(()=>t.hi.addMatchingKeys(o,d.addedDocuments,f)));let m=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(f)!==null?m=m.withResumeToken(Ve.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),i=i.insert(f,m),function(R,P,O){return R.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=O$?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0}(g,m,d)&&a.push(t.hi.updateTargetData(o,m))});let c=bt(),l=X();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(TN(o,s,e.documentUpdates).next(d=>{c=d.Ls,l=d.ks})),!r.isEqual(q.min())){let d=t.hi.getLastRemoteSnapshotVersion(o).next(f=>t.hi.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(d)}return N.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,l)).next(()=>c)}).then(o=>(t.Fs=i,o))}function TN(n,e,t){let r=X(),i=X();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=bt();return t.forEach((a,c)=>{let l=o.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(q.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):x(wI,"Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ls:s,ks:i}})}function V$(n,e){let t=F(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Ar),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Es(n,e){let t=F(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.hi.getTargetData(r,e).next(o=>o?(i=o,N.resolve(i)):t.hi.allocateTargetId(r).next(s=>(i=new _s(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}function ws(n,e,t){return v(this,null,function*(){let r=F(n),i=r.Fs.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!$r(s))throw s;x(wI,`Failed to update sequence numbers for target ${e}: ${s}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)})}function xh(n,e,t){let r=F(n),i=q.min(),o=X();return r.persistence.runTransaction("Execute query","readwrite",s=>function(c,l,d){let f=F(c),g=f.Ms.get(d);return g!==void 0?N.resolve(f.Fs.get(g)):f.hi.getTargetData(l,d)}(r,s,at(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(s,e,t?i:q.min(),t?o:X())).next(a=>(CN(r,LA(e),a),{documents:a,qs:o})))}function DN(n,e){let t=F(n),r=F(t.hi),i=t.Fs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.Et(o,e).next(s=>s?s.target:null))}function bN(n,e){let t=F(n),r=t.xs.get(e)||q.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Os.getAllFromCollectionGroup(i,e,rA(r,ss),Number.MAX_SAFE_INTEGER)).then(i=>(CN(t,e,i),i))}function CN(n,e,t){let r=n.xs.get(e)||q.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.xs.set(e,r)}function j$(n,e,t,r){return v(this,null,function*(){let i=F(n),o=X(),s=bt();for(let l of t){let d=e.Qs(l.metadata.name);l.document&&(o=o.add(d));let f=e.$s(l);f.setReadTime(e.Us(l.metadata.readTime)),s=s.insert(d,f)}let a=i.Os.newChangeBuffer({trackRemovals:!0}),c=yield Es(i,function(d){return at(Rs(ue.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>TN(l,a,s).next(d=>(a.apply(l),d)).next(d=>i.hi.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.hi.addMatchingKeys(l,o,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.Ls,d.ks)).next(()=>d.Ls)))})}function B$(r,i){return v(this,arguments,function*(n,e,t=X()){let o=yield Es(n,at(pf(e.bundledQuery))),s=F(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{let c=Le(e.readTime);if(o.snapshotVersion.compareTo(c)>=0)return s.Ti.saveNamedQuery(a,e);let l=o.withResumeToken(Ve.EMPTY_BYTE_STRING,c);return s.Fs=s.Fs.insert(l.targetId,l),s.hi.updateTargetData(a,l).next(()=>s.hi.removeMatchingKeysForTargetId(a,o.targetId)).next(()=>s.hi.addMatchingKeys(a,t,o.targetId)).next(()=>s.Ti.saveNamedQuery(a,e))})})}var SN="firestore_clients";function M0(n,e){return`${SN}_${n}_${e}`}var AN="firestore_mutations";function k0(n,e,t){let r=`${AN}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}var NN="firestore_targets";function Wy(n,e){return`${NN}_${n}_${e}`}var mn="SharedClientState",Oh=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ks(e,t,r){let i=JSON.parse(r),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new k(i.error.code,i.error.message))),s?new n(e,t,i.state,o):(Fe(mn,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},ac=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ks(e,t){let r=JSON.parse(t),i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new k(r.error.code,r.error.message))),o?new n(e,r.state,i):(Fe(mn,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Fh=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ks(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=yI();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=aA(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new n(e,o):(Fe(mn,`Failed to parse client data for instance '${e}': ${t}`),null)}},d_=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Ks(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(Fe(mn,`Failed to parse online state: ${e}`),null)}},Rc=class{constructor(){this.activeTargetIds=yI()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},cc=class{constructor(e,t,r,i,o){this.window=e,this.Fi=t,this.persistenceKey=r,this.js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Js=this.Hs.bind(this),this.Ys=new be(z),this.started=!1,this.Zs=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Xs=M0(this.persistenceKey,this.js),this.eo=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ys=this.Ys.insert(this.js,new Rc),this.no=new RegExp(`^${SN}_${s}_([^_]*)$`),this.ro=new RegExp(`^${AN}_${s}_(\\d+)(?:_(.*))?$`),this.io=new RegExp(`^${NN}_${s}_(\\d+)$`),this.so=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.oo=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.Js)}static C(e){return!(!e||!e.localStorage)}start(){return v(this,null,function*(){let e=yield this.syncEngine.Ps();for(let r of e){if(r===this.js)continue;let i=this.getItem(M0(this.persistenceKey,r));if(i){let o=Fh.Ks(r,i);o&&(this.Ys=this.Ys.insert(o.clientId,o))}}this._o();let t=this.storage.getItem(this.so);if(t){let r=this.ao(t);r&&this.uo(r)}for(let r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.eo,JSON.stringify(e))}getAllActiveQueryTargets(){return this.co(this.Ys)}isActiveQueryTarget(e){let t=!1;return this.Ys.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.lo(e,"pending")}updateMutationState(e,t,r){this.lo(e,t,r),this.ho(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(Wy(this.persistenceKey,e));if(i){let o=ac.Ks(e,i);o&&(r=o.state)}}return t&&this.Po.Gs(e),this._o(),r}removeLocalQueryTarget(e){this.Po.zs(e),this._o()}isLocalQueryTarget(e){return this.Po.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Wy(this.persistenceKey,e))}updateQueryState(e,t,r){this.To(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.ho(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Io(e)}notifyBundleLoaded(e){this.Eo(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Js),this.removeItem(this.Xs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return x(mn,"READ",e,t),t}setItem(e,t){x(mn,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){x(mn,"REMOVE",e),this.storage.removeItem(e)}Hs(e){let t=e;if(t.storageArea===this.storage){if(x(mn,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Fe("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Fi.enqueueRetryable(()=>v(this,null,function*(){if(this.started){if(t.key!==null){if(this.no.test(t.key)){if(t.newValue==null){let r=this.Ao(t.key);return this.Ro(r,null)}{let r=this.Vo(t.key,t.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.ro.test(t.key)){if(t.newValue!==null){let r=this.mo(t.key,t.newValue);if(r)return this.fo(r)}}else if(this.io.test(t.key)){if(t.newValue!==null){let r=this.po(t.key,t.newValue);if(r)return this.yo(r)}}else if(t.key===this.so){if(t.newValue!==null){let r=this.ao(t.newValue);if(r)return this.uo(r)}}else if(t.key===this.eo){let r=function(o){let s=xt.ue;if(o!=null)try{let a=JSON.parse(o);H(typeof a=="number",30636,{wo:o}),s=a}catch(a){Fe(mn,"Failed to read sequence number from WebStorage",a)}return s}(t.newValue);r!==xt.ue&&this.sequenceNumberHandler(r)}else if(t.key===this.oo){let r=this.So(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.bo(i)))}}}else this.Zs.push(t)}))}}get Po(){return this.Ys.get(this.js)}_o(){this.setItem(this.Xs,this.Po.Ws())}lo(e,t,r){let i=new Oh(this.currentUser,e,t,r),o=k0(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Ws())}ho(e){let t=k0(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Io(e){let t={clientId:this.js,onlineState:e};this.storage.setItem(this.so,JSON.stringify(t))}To(e,t,r){let i=Wy(this.persistenceKey,e),o=new ac(e,t,r);this.setItem(i,o.Ws())}Eo(e){let t=JSON.stringify(Array.from(e));this.setItem(this.oo,t)}Ao(e){let t=this.no.exec(e);return t?t[1]:null}Vo(e,t){let r=this.Ao(e);return Fh.Ks(r,t)}mo(e,t){let r=this.ro.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Oh.Ks(new $e(o),i,t)}po(e,t){let r=this.io.exec(e),i=Number(r[1]);return ac.Ks(i,t)}ao(e){return d_.Ks(e)}So(e){return JSON.parse(e)}fo(e){return v(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Do(e.batchId,e.state,e.error);x(mn,`Ignoring mutation for non-active user ${e.user.uid}`)})}yo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Ro(e,t){let r=t?this.Ys.insert(e,t):this.Ys.remove(e),i=this.co(this.Ys),o=this.co(r),s=[],a=[];return o.forEach(c=>{i.has(c)||s.push(c)}),i.forEach(c=>{o.has(c)||a.push(c)}),this.syncEngine.Co(s,a).then(()=>{this.Ys=r})}uo(e){this.Ys.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}co(e){let t=yI();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Lh=class{constructor(){this.Fo=new Rc,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Rc,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var h_=class{xo(e){}shutdown(){}};var x0="ConnectivityMonitor",Vh=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){x(x0,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){x(x0,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Wd=null;function f_(){return Wd===null?Wd=function(){return 268435456+Math.round(2147483648*Math.random())}():Wd++,"0x"+Wd.toString(16)}var Gy="RestConnection",U$={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},p_=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===yc?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,o){let s=f_(),a=this.Go(e,t.toUriEncodedString());x(Gy,`Sending RPC '${e}' ${s}:`,a,r);let c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,i,o);let{host:l}=new URL(a),d=xn(l);return this.jo(e,a,c,r,d).then(f=>(x(Gy,`Received RPC '${e}' ${s}: `,f),f),f=>{throw mt(Gy,`RPC '${e}' ${s} failed with error: `,f,"url: ",a,"request:",r),f})}Jo(e,t,r,i,o,s){return this.Wo(e,t,r,i,o)}zo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ns}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}Go(e,t){let r=U$[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var g_=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var it="WebChannelConnection",m_=class extends p_{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,o){let s=f_();return new Promise((a,c)=>{let l=new Ly;l.setWithCredentials(!0),l.listenOnce(Vy.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Ka.NO_ERROR:let f=l.getResponseJson();x(it,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case Ka.TIMEOUT:x(it,`RPC '${e}' ${s} timed out`),c(new k(S.DEADLINE_EXCEEDED,"Request time out"));break;case Ka.HTTP_ERROR:let g=l.getStatus();if(x(it,`RPC '${e}' ${s} failed with status:`,g,"response text:",l.getResponseText()),g>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);let w=m?.error;if(w&&w.status&&w.message){let R=function(O){let B=O.toLowerCase().replace(/_/g,"-");return Object.values(S).indexOf(B)>=0?B:S.UNKNOWN}(w.status);c(new k(R,w.message))}else c(new k(S.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new k(S.UNAVAILABLE,"Connection failed."));break;default:$(9055,{c_:e,streamId:s,l_:l.getLastErrorCode(),h_:l.getLastError()})}}finally{x(it,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(i);x(it,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",d,r,15)})}P_(e,t,r){let i=f_(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Uy(),a=By(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=o.join("");x(it,`Creating RPC '${e}' stream ${i}: ${d}`,c);let f=s.createWebChannel(d,c);this.T_(f);let g=!1,m=!1,w=new g_({Ho:P=>{m?x(it,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(g||(x(it,`Opening RPC '${e}' stream ${i} transport.`),f.open(),g=!0),x(it,`RPC '${e}' stream ${i} sending:`,P),f.send(P))},Yo:()=>f.close()}),R=(P,O,B)=>{P.listen(O,U=>{try{B(U)}catch(W){setTimeout(()=>{throw W},0)}})};return R(f,Ho.EventType.OPEN,()=>{m||(x(it,`RPC '${e}' stream ${i} transport opened.`),w.s_())}),R(f,Ho.EventType.CLOSE,()=>{m||(m=!0,x(it,`RPC '${e}' stream ${i} transport closed`),w.__(),this.I_(f))}),R(f,Ho.EventType.ERROR,P=>{m||(m=!0,mt(it,`RPC '${e}' stream ${i} transport errored. Name:`,P.name,"Message:",P.message),w.__(new k(S.UNAVAILABLE,"The operation could not be completed")))}),R(f,Ho.EventType.MESSAGE,P=>{var O;if(!m){let B=P.data[0];H(!!B,16349);let U=B,W=U?.error||((O=U[0])===null||O===void 0?void 0:O.error);if(W){x(it,`RPC '${e}' stream ${i} received error:`,W);let de=W.status,K=function(E){let D=Be[E];if(D!==void 0)return ZA(D)}(de),T=W.message;K===void 0&&(K=S.INTERNAL,T="Unknown error status: "+de+" with message "+W.message),m=!0,w.__(new k(K,T)),f.close()}else x(it,`RPC '${e}' stream ${i} received:`,B),w.a_(B)}}),R(a,jy.STAT_EVENT,P=>{P.stat===Ud.PROXY?x(it,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===Ud.NOPROXY&&x(it,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.o_()},0),w}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function RN(){return typeof window<"u"?window:null}function th(){return typeof document<"u"?document:null}function Zi(n){return new Rv(n,!0)}var Pc=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&x("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var O0="PersistentStream",jh=class{constructor(e,t,r,i,o,s,a,c){this.Fi=e,this.w_=r,this.S_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Pc(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}stop(){return v(this,null,function*(){this.M_()&&(yield this.close(0))})}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}L_(){return v(this,null,function*(){if(this.x_())return this.close(0)})}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,t){return v(this,null,function*(){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===S.RESOURCE_EXHAUSTED?(Fe(t.toString()),Fe("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===S.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.n_(t)})}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{let i=new k(S.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(()=>v(this,null,function*(){this.state=0,this.start()}))}G_(e){return x(O0,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(x(O0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},y_=class extends jh{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let t=b$(this.serializer,e),r=function(o){if(!("targetChange"in o))return q.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?q.min():s.readTime?Le(s.readTime):q.min()}(e);return this.listener.J_(t,r)}H_(e){let t={};t.database=kv(this.serializer),t.addTarget=function(o,s){let a,c=s.target;if(a=fh(c)?{documents:rN(o,c)}:{query:ff(o,c).Vt},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=JA(o,s.resumeToken);let l=Pv(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(q.min())>0){a.readTime=vs(o,s.snapshotVersion.toTimestamp());let l=Pv(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=S$(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){let t={};t.database=kv(this.serializer),t.removeTarget=e,this.k_(t)}},v_=class extends jh{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return H(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,H(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){H(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=C$(e.writeResults,e.commitTime),r=Le(e.commitTime);return this.listener.ta(r,t)}na(){let e={};e.database=kv(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Cc(this.serializer,r))};this.k_(t)}};var __=class{},I_=class extends __{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new k(S.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Wo(e,Mv(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new k(S.UNKNOWN,o.toString())})}Jo(e,t,r,i,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Jo(e,Mv(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new k(S.UNKNOWN,s.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},E_=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Fe(t),this._a=!1):x("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var qi="RemoteStore",w_=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(s=>{r.enqueueAndForget(()=>v(this,null,function*(){qr(this)&&(x(qi,"Restarting streams for network reachability change."),yield function(c){return v(this,null,function*(){let l=F(c);l.Ia.add(4),yield Ps(l),l.Aa.set("Unknown"),l.Ia.delete(4),yield Gc(l)})}(this))}))}),this.Aa=new E_(r,i)}};function Gc(n){return v(this,null,function*(){if(qr(n))for(let e of n.da)yield e(!0)})}function Ps(n){return v(this,null,function*(){for(let e of n.da)yield e(!1)})}function gf(n,e){let t=F(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),bI(t)?DI(t):ks(t).x_()&&TI(t,e))}function Ts(n,e){let t=F(n),r=ks(t);t.Ta.delete(e),r.x_()&&PN(t,e),t.Ta.size===0&&(r.x_()?r.B_():qr(t)&&t.Aa.set("Unknown"))}function TI(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(q.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ks(n).H_(e)}function PN(n,e){n.Ra.$e(e),ks(n).Y_(e)}function DI(n){n.Ra=new Nv({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),ks(n).start(),n.Aa.aa()}function bI(n){return qr(n)&&!ks(n).M_()&&n.Ta.size>0}function qr(n){return F(n).Ia.size===0}function MN(n){n.Ra=void 0}function $$(n){return v(this,null,function*(){n.Aa.set("Online")})}function H$(n){return v(this,null,function*(){n.Ta.forEach((e,t)=>{TI(n,e)})})}function q$(n,e){return v(this,null,function*(){MN(n),bI(n)?(n.Aa.la(e),DI(n)):n.Aa.set("Unknown")})}function z$(n,e,t){return v(this,null,function*(){if(n.Aa.set("Online"),e instanceof _h&&e.state===2&&e.cause)try{yield function(i,o){return v(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.Ta.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.Ta.delete(a),i.Ra.removeTarget(a))})}(n,e)}catch(r){x(qi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Bh(n,r)}else if(e instanceof ns?n.Ra.Ye(e):e instanceof vh?n.Ra.it(e):n.Ra.et(e),!t.isEqual(q.min()))try{let r=yield wN(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.Ra.Pt(s);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=o.Ta.get(l);d&&o.Ta.set(l,d.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,l)=>{let d=o.Ta.get(c);if(!d)return;o.Ta.set(c,d.withResumeToken(Ve.EMPTY_BYTE_STRING,d.snapshotVersion)),PN(o,c);let f=new _s(d.target,c,l,d.sequenceNumber);TI(o,f)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){x(qi,"Failed to raise snapshot:",r),yield Bh(n,r)}})}function Bh(n,e,t){return v(this,null,function*(){if(!$r(e))throw e;n.Ia.add(1),yield Ps(n),n.Aa.set("Offline"),t||(t=()=>wN(n.localStore)),n.asyncQueue.enqueueRetryable(()=>v(null,null,function*(){x(qi,"Retrying IndexedDB access"),yield t(),n.Ia.delete(1),yield Gc(n)}))})}function kN(n,e){return e().catch(t=>Bh(n,t,e))}function Ms(n){return v(this,null,function*(){let e=F(n),t=jr(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Ar;for(;W$(e);)try{let i=yield V$(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,G$(e,i)}catch(i){yield Bh(e,i)}xN(e)&&ON(e)})}function W$(n){return qr(n)&&n.Pa.length<10}function G$(n,e){n.Pa.push(e);let t=jr(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function xN(n){return qr(n)&&!jr(n).M_()&&n.Pa.length>0}function ON(n){jr(n).start()}function K$(n){return v(this,null,function*(){jr(n).na()})}function Q$(n){return v(this,null,function*(){let e=jr(n);for(let t of n.Pa)e.X_(t.mutations)})}function Y$(n,e,t){return v(this,null,function*(){let r=n.Pa.shift(),i=Cv.from(r,e,t);yield kN(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Ms(n)})}function Z$(n,e){return v(this,null,function*(){e&&jr(n).Z_&&(yield function(r,i){return v(this,null,function*(){if(function(s){return YA(s)&&s!==S.ABORTED}(i.code)){let o=r.Pa.shift();jr(r).N_(),yield kN(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Ms(r)}})}(n,e)),xN(n)&&ON(n)})}function F0(n,e){return v(this,null,function*(){let t=F(n);t.asyncQueue.verifyOperationInProgress(),x(qi,"RemoteStore received new credentials");let r=qr(t);t.Ia.add(3),yield Ps(t),r&&t.Aa.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),yield Gc(t)})}function T_(n,e){return v(this,null,function*(){let t=F(n);e?(t.Ia.delete(2),yield Gc(t)):e||(t.Ia.add(2),yield Ps(t),t.Aa.set("Unknown"))})}function ks(n){return n.Va||(n.Va=function(t,r,i){let o=F(t);return o.ia(),new y_(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Zo:$$.bind(null,n),e_:H$.bind(null,n),n_:q$.bind(null,n),J_:z$.bind(null,n)}),n.da.push(e=>v(null,null,function*(){e?(n.Va.N_(),bI(n)?DI(n):n.Aa.set("Unknown")):(yield n.Va.stop(),MN(n))}))),n.Va}function jr(n){return n.ma||(n.ma=function(t,r,i){let o=F(t);return o.ia(),new v_(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:K$.bind(null,n),n_:Z$.bind(null,n),ea:Q$.bind(null,n),ta:Y$.bind(null,n)}),n.da.push(e=>v(null,null,function*(){e?(n.ma.N_(),yield Ms(n)):(yield n.ma.stop(),n.Pa.length>0&&(x(qi,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}var D_=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new qe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(S.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function xs(n,e){if(Fe("AsyncQueue",`${e}: ${n}`),$r(n))return new k(S.UNAVAILABLE,`${e}: ${n}`);throw n}var Mc=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||V.comparator(t.key,r.key):(t,r)=>V.comparator(t.key,r.key),this.keyedMap=Xa(),this.sortedSet=new be(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Uh=class{constructor(){this.fa=new be(V.comparator)}track(e){let t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):$(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){let e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}},zi=class n{constructor(e,t,r,i,o,s,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Mc.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&zc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var b_=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},C_=class{constructor(){this.queries=L0(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let i=F(t),o=i.queries;i.queries=L0(),o.forEach((s,a)=>{for(let c of a.wa)c.onError(r)})})(this,new k(S.ABORTED,"Firestore shutting down"))}};function L0(){return new tn(n=>FA(n),zc)}function CI(n,e){return v(this,null,function*(){let t=F(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Sa()&&e.ba()&&(r=2):(o=new b_,r=e.ba()?0:1);try{switch(r){case 0:o.ya=yield t.onListen(i,!0);break;case 1:o.ya=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=xs(s,`Initialization of query '${Zo(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.wa.push(e),e.va(t.onlineState),o.ya&&e.Ca(o.ya)&&AI(t)})}function SI(n,e){return v(this,null,function*(){let t=F(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.wa.indexOf(e);s>=0&&(o.wa.splice(s,1),o.wa.length===0?i=e.ba()?0:1:!o.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function J$(n,e){let t=F(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.wa)a.Ca(i)&&(r=!0);s.ya=i}}r&&AI(t)}function X$(n,e,t){let r=F(n),i=r.queries.get(e);if(i)for(let o of i.wa)o.onError(t);r.queries.delete(e)}function AI(n){n.Da.forEach(e=>{e.next()})}var S_,V0;(V0=S_||(S_={})).Fa="default",V0.Cache="cache";var kc=class{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new zi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;let r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=zi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==S_.Cache}};var $h=class{constructor(e,t){this.qa=e,this.byteLength=t}Qa(){return"metadata"in this.qa}};var Hh=class{constructor(e){this.serializer=e}Qs(e){return En(this.serializer,e)}$s(e){return e.metadata.exists?hf(this.serializer,e.document,!1):We.newNoDocument(this.Qs(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return Le(e)}},xc=class{constructor(e,t){this.$a=e,this.serializer=t,this.Ua=[],this.Ka=[],this.collectionGroups=new Set,this.progress=FN(e)}get queries(){return this.Ua}get documents(){return this.Ka}Wa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Ua.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Ka.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;let r=ue.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Ka[this.Ka.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ga(e){let t=new Map,r=new Hh(this.serializer);for(let i of e)if(i.metadata.queries){let o=r.Qs(i.metadata.name);for(let s of i.metadata.queries){let a=(t.get(s)||X()).add(o);t.set(s,a)}}return t}za(e){return v(this,null,function*(){let t=yield j$(e,new Hh(this.serializer),this.Ka,this.$a.id),r=this.Ga(this.documents);for(let i of this.Ua)yield B$(e,i,r.get(i.name));return this.progress.taskState="Success",{progress:this.progress,ja:this.collectionGroups,Ja:t}})}};function FN(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var qh=class{constructor(e){this.key=e}},zh=class{constructor(e){this.key=e}},Wh=class{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=X(),this.mutatedKeys=X(),this.Xa=VA(e),this.eu=new Mc(this.Xa)}get tu(){return this.Ha}nu(e,t){let r=t?t.ru:new Uh,i=t?t.eu:this.eu,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{let g=i.get(d),m=Wc(this.query,f)?f:null,w=!!g&&this.mutatedKeys.has(g.key),R=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations),P=!1;g&&m?g.data.isEqual(m.data)?w!==R&&(r.track({type:3,doc:m}),P=!0):this.iu(g,m)||(r.track({type:2,doc:m}),P=!0,(c&&this.Xa(m,c)>0||l&&this.Xa(m,l)<0)&&(a=!0)):!g&&m?(r.track({type:0,doc:m}),P=!0):g&&!m&&(r.track({type:1,doc:g}),P=!0,(c||l)&&(a=!0)),P&&(m?(s=s.add(m),o=R?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),r.track({type:1,doc:d})}return{eu:s,ru:r,Ds:a,mutatedKeys:o}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let s=e.ru.pa();s.sort((d,f)=>function(m,w){let R=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $(20277,{At:P})}};return R(m)-R(w)}(d.type,f.type)||this.Xa(d.doc,f.doc)),this.su(r),i=i!=null&&i;let a=t&&!i?this.ou():[],c=this.Za.size===0&&this.current&&!i?1:0,l=c!==this.Ya;return this.Ya=c,s.length!==0||l?{snapshot:new zi(this.query,e.eu,o,s,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Uh,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=X(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});let t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new zh(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new qh(r))}),t}uu(e){this.Ha=e.qs,this.Za=X();let t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return zi.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},zr="SyncEngine",A_=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},N_=class{constructor(e){this.key=e,this.lu=!1}},R_=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.hu={},this.Pu=new tn(a=>FA(a),zc),this.Tu=new Map,this.Iu=new Set,this.du=new be(V.comparator),this.Eu=new Map,this.Au=new Ac,this.Ru={},this.Vu=new Map,this.mu=Is.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};function eH(n,e,t=!0){return v(this,null,function*(){let r=mf(n),i,o=r.Pu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.cu()):i=yield LN(r,e,t,!0),i})}function tH(n,e){return v(this,null,function*(){let t=mf(n);yield LN(t,e,!0,!1)})}function LN(n,e,t,r){return v(this,null,function*(){let i=yield Es(n.localStore,at(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield NI(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&gf(n.remoteStore,i),a})}function NI(n,e,t,r,i){return v(this,null,function*(){n.gu=(f,g,m)=>function(R,P,O,B){return v(this,null,function*(){let U=P.view.nu(O);U.Ds&&(U=yield xh(R.localStore,P.query,!1).then(({documents:T})=>P.view.nu(T,U)));let W=B&&B.targetChanges.get(P.targetId),de=B&&B.targetMismatches.get(P.targetId)!=null,K=P.view.applyChanges(U,R.isPrimaryClient,W,de);return P_(R,P.targetId,K._u),K.snapshot})}(n,f,g,m);let o=yield xh(n.localStore,e,!0),s=new Wh(e,o.qs),a=s.nu(o.documents),c=Dc.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,c);P_(n,t,l._u);let d=new A_(e,t,s);return n.Pu.set(e,d),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),l.snapshot})}function nH(n,e,t){return v(this,null,function*(){let r=F(n),i=r.Pu.get(e),o=r.Tu.get(i.targetId);if(o.length>1)return r.Tu.set(i.targetId,o.filter(s=>!zc(s,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield ws(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Ts(r.remoteStore,i.targetId),Ds(r,i.targetId)}).catch(Ur))):(Ds(r,i.targetId),yield ws(r.localStore,i.targetId,!0))})}function rH(n,e){return v(this,null,function*(){let t=F(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ts(t.remoteStore,r.targetId))})}function iH(n,e,t){return v(this,null,function*(){let r=kI(n);try{let i=yield function(s,a){let c=F(s),l=Ae.now(),d=a.reduce((m,w)=>m.add(w.key),X()),f,g;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let w=bt(),R=X();return c.Os.getEntries(m,d).next(P=>{w=P,w.forEach((O,B)=>{B.isValidDocument()||(R=R.add(O))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,w)).next(P=>{f=P;let O=[];for(let B of a){let U=v$(B,f.get(B.key).overlayedDocument);U!=null&&O.push(new nn(B.key,U,SA(U.value.mapValue),ke.exists(!0)))}return c.mutationQueue.addMutationBatch(m,l,O,a)}).next(P=>{g=P;let O=P.applyToLocalDocumentSet(f,R);return c.documentOverlayCache.saveOverlays(m,P.batchId,O)})}).then(()=>({batchId:g.batchId,changes:BA(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let l=s.Ru[s.currentUser.toKey()];l||(l=new be(z)),l=l.insert(a,c),s.Ru[s.currentUser.toKey()]=l}(r,i.batchId,t),yield Xn(r,i.changes),yield Ms(r.remoteStore)}catch(i){let o=xs(i,"Failed to persist write");t.reject(o)}})}function VN(n,e){return v(this,null,function*(){let t=F(n);try{let r=yield L$(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Eu.get(o);s&&(H(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.lu=!0:i.modifiedDocuments.size>0?H(s.lu,14607):i.removedDocuments.size>0&&(H(s.lu,42227),s.lu=!1))}),yield Xn(t,r,e)}catch(r){yield Ur(r)}})}function j0(n,e,t){let r=F(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Pu.forEach((o,s)=>{let a=s.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let c=F(s);c.onlineState=a;let l=!1;c.queries.forEach((d,f)=>{for(let g of f.wa)g.va(a)&&(l=!0)}),l&&AI(c)}(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function oH(n,e,t){return v(this,null,function*(){let r=F(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Eu.get(e),o=i&&i.key;if(o){let s=new be(V.comparator);s=s.insert(o,We.newNoDocument(o,q.min()));let a=X().add(o),c=new Tc(q.min(),new Map,new be(z),s,a);yield VN(r,c),r.du=r.du.remove(o),r.Eu.delete(e),MI(r)}else yield ws(r.localStore,e,!1).then(()=>Ds(r,e,t)).catch(Ur)})}function sH(n,e){return v(this,null,function*(){let t=F(n),r=e.batch.batchId;try{let i=yield F$(t.localStore,e);PI(t,r,null),RI(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Xn(t,i)}catch(i){yield Ur(i)}})}function aH(n,e,t){return v(this,null,function*(){let r=F(n);try{let i=yield function(s,a){let c=F(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(f=>(H(f!==null,37113),d=f.keys(),c.mutationQueue.removeMutationBatch(l,f))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);PI(r,e,t),RI(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Xn(r,i)}catch(i){yield Ur(i)}})}function cH(n,e){return v(this,null,function*(){let t=F(n);qr(t.remoteStore)||x(zr,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(s){let a=F(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===Ar)return void e.resolve();let i=t.Vu.get(r)||[];i.push(e),t.Vu.set(r,i)}catch(r){let i=xs(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function RI(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function PI(n,e,t){let r=F(n),i=r.Ru[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function Ds(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||jN(n,r)})}function jN(n,e){n.Iu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(Ts(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),MI(n))}function P_(n,e,t){for(let r of t)r instanceof qh?(n.Au.addReference(r.key,e),uH(n,r)):r instanceof zh?(x(zr,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||jN(n,r.key)):$(19791,{yu:r})}function uH(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(x(zr,"New document in limbo: "+t),n.Iu.add(r),MI(n))}function MI(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Iu.values().next().value;n.Iu.delete(e);let t=new V(ue.fromString(e)),r=n.mu.next();n.Eu.set(r,new N_(t)),n.du=n.du.insert(t,r),gf(n.remoteStore,new _s(at(Rs(t.path)),r,"TargetPurposeLimboResolution",xt.ue))}}function Xn(n,e,t){return v(this,null,function*(){let r=F(n),i=[],o=[],s=[];r.Pu.isEmpty()||(r.Pu.forEach((a,c)=>{s.push(r.gu(c,e,t).then(l=>{var d;if((l||t)&&r.isPrimaryClient){let f=l?!l.fromCache:(d=t?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(l){i.push(l);let f=c_.Es(c.targetId,l);o.push(f)}}))}),yield Promise.all(s),r.hu.J_(i),yield function(c,l){return v(this,null,function*(){let d=F(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>N.forEach(l,g=>N.forEach(g.Is,m=>d.persistence.referenceDelegate.addReference(f,g.targetId,m)).next(()=>N.forEach(g.ds,m=>d.persistence.referenceDelegate.removeReference(f,g.targetId,m)))))}catch(f){if(!$r(f))throw f;x(wI,"Failed to update sequence numbers: "+f)}for(let f of l){let g=f.targetId;if(!f.fromCache){let m=d.Fs.get(g),w=m.snapshotVersion,R=m.withLastLimboFreeSnapshotVersion(w);d.Fs=d.Fs.insert(g,R)}}})}(r.localStore,o))})}function lH(n,e){return v(this,null,function*(){let t=F(n);if(!t.currentUser.isEqual(e)){x(zr,"User change. New user:",e.toKey());let r=yield EN(t.localStore,e);t.currentUser=e,function(o,s){o.Vu.forEach(a=>{a.forEach(c=>{c.reject(new k(S.CANCELLED,s))})}),o.Vu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Xn(t,r.Bs)}})}function dH(n,e){let t=F(n),r=t.Eu.get(e);if(r&&r.lu)return X().add(r.key);{let i=X(),o=t.Tu.get(e);if(!o)return i;for(let s of o){let a=t.Pu.get(s);i=i.unionWith(a.view.tu)}return i}}function hH(n,e){return v(this,null,function*(){let t=F(n),r=yield xh(t.localStore,e.query,!0),i=e.view.uu(r);return t.isPrimaryClient&&P_(t,e.targetId,i._u),i})}function fH(n,e){return v(this,null,function*(){let t=F(n);return bN(t.localStore,e).then(r=>Xn(t,r))})}function pH(n,e,t,r){return v(this,null,function*(){let i=F(n),o=yield function(a,c){let l=F(a),d=F(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Xn(f,c).next(g=>g?l.localDocuments.getDocuments(f,g):N.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?yield Ms(i.remoteStore):t==="acknowledged"||t==="rejected"?(PI(i,e,r||null),RI(i,e),function(a,c){F(F(a).mutationQueue).rr(c)}(i.localStore,e)):$(6720,"Unknown batchState",{wu:t}),yield Xn(i,o)):x(zr,"Cannot apply mutation batch with id: "+e)})}function gH(n,e){return v(this,null,function*(){let t=F(n);if(mf(t),kI(t),e===!0&&t.fu!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield B0(t,r.toArray());t.fu=!0,yield T_(t.remoteStore,!0);for(let o of i)gf(t.remoteStore,o)}else if(e===!1&&t.fu!==!1){let r=[],i=Promise.resolve();t.Tu.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then(()=>(Ds(t,s),ws(t.localStore,s,!0))),Ts(t.remoteStore,s)}),yield i,yield B0(t,r),function(s){let a=F(s);a.Eu.forEach((c,l)=>{Ts(a.remoteStore,l)}),a.Au.jr(),a.Eu=new Map,a.du=new be(V.comparator)}(t),t.fu=!1,yield T_(t.remoteStore,!1)}})}function B0(n,e,t){return v(this,null,function*(){let r=F(n),i=[],o=[];for(let s of e){let a,c=r.Tu.get(s);if(c&&c.length!==0){a=yield Es(r.localStore,at(c[0]));for(let l of c){let d=r.Pu.get(l),f=yield hH(r,d);f.snapshot&&o.push(f.snapshot)}}else{let l=yield DN(r.localStore,s);a=yield Es(r.localStore,l),yield NI(r,BN(l),s,!1,a.resumeToken)}i.push(a)}return r.hu.J_(o),i})}function BN(n){return kA(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function mH(n){return function(t){return F(F(t).persistence).Ps()}(F(n).localStore)}function yH(n,e,t,r){return v(this,null,function*(){let i=F(n);if(i.fu)return void x(zr,"Ignoring unexpected query state notification.");let o=i.Tu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield bN(i.localStore,LA(o[0])),a=Tc.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ve.EMPTY_BYTE_STRING);yield Xn(i,s,a);break}case"rejected":yield ws(i.localStore,e,!0),Ds(i,e,r);break;default:$(64155,t)}})}function vH(n,e,t){return v(this,null,function*(){let r=mf(n);if(r.fu){for(let i of e){if(r.Tu.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){x(zr,"Adding an already active target "+i);continue}let o=yield DN(r.localStore,i),s=yield Es(r.localStore,o);yield NI(r,BN(o),s.targetId,!1,s.resumeToken),gf(r.remoteStore,s)}for(let i of t)r.Tu.has(i)&&(yield ws(r.localStore,i,!1).then(()=>{Ts(r.remoteStore,i),Ds(r,i)}).catch(Ur))}})}function mf(n){let e=F(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=VN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=dH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oH.bind(null,e),e.hu.J_=J$.bind(null,e.eventManager),e.hu.pu=X$.bind(null,e.eventManager),e}function kI(n){let e=F(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sH.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aH.bind(null,e),e}function _H(n,e,t){let r=F(n);(function(o,s,a){return v(this,null,function*(){try{let c=yield s.getMetadata();if(yield function(m,w){let R=F(m),P=Le(w.createTime);return R.persistence.runTransaction("hasNewerBundle","readonly",O=>R.Ti.getBundleMetadata(O,w.id)).then(O=>!!O&&O.createTime.compareTo(P)>=0)}(o.localStore,c))return yield s.close(),a._completeWith(function(m){return{taskState:"Success",documentsLoaded:m.totalDocuments,bytesLoaded:m.totalBytes,totalDocuments:m.totalDocuments,totalBytes:m.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(FN(c));let l=new xc(c,s.serializer),d=yield s.Su();for(;d;){let g=yield l.Wa(d);g&&a._updateProgress(g),d=yield s.Su()}let f=yield l.za(o.localStore);return yield Xn(o,f.Ja,void 0),yield function(m,w){let R=F(m);return R.persistence.runTransaction("Save bundle","readwrite",P=>R.Ti.saveBundleMetadata(P,w))}(o.localStore,c),a._completeWith(f.progress),Promise.resolve(f.ja)}catch(c){return mt(zr,`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var yf=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return v(this,null,function*(){this.serializer=Zi(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),yield this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)})}Cu(t,r){return null}Fu(t,r){return null}vu(t){return IN(this.persistence,new kh,t.initialUser,this.serializer)}Du(t){return new Nc(Ph.Vi,this.serializer)}bu(t){return new Lh}terminate(){return v(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),Oc=class extends yf{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){H(this.persistence.referenceDelegate instanceof Mh,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Ah(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?Dt.withCacheSize(this.cacheSizeBytes):Dt.DEFAULT;return new Nc(r=>Mh.Vi(r,t),this.serializer)}},Fc=class n extends yf{constructor(e,t,r){super(),this.Mu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){yield rn(n.prototype,this,"initialize").call(this,e),yield this.Mu.initialize(this,e),yield kI(this.Mu.syncEngine),yield Ms(this.Mu.remoteStore),yield this.persistence.ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}vu(e){return IN(this.persistence,new kh,e.initialUser,this.serializer)}Cu(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new Ah(r,e.asyncQueue,t)}Fu(e,t){let r=new av(t,this.persistence);return new sv(e.asyncQueue,r)}Du(e){let t=EI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Dt.withCacheSize(this.cacheSizeBytes):Dt.DEFAULT;return new a_(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,RN(),th(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new Lh}},Gh=class n extends Fc{constructor(e,t){super(e,t,!1),this.Mu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return v(this,null,function*(){yield rn(n.prototype,this,"initialize").call(this,e);let t=this.Mu.syncEngine;this.sharedClientState instanceof cc&&(this.sharedClientState.syncEngine={Do:pH.bind(null,t),vo:yH.bind(null,t),Co:vH.bind(null,t),Ps:mH.bind(null,t),bo:fH.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.ji(r=>v(this,null,function*(){yield gH(this.Mu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}bu(e){let t=RN();if(!cc.C(t))throw new k(S.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=EI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new cc(t,e.asyncQueue,r,e.clientId,e.initialUser)}},Os=(()=>{class n{initialize(t,r){return v(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>j0(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=lH.bind(null,this.syncEngine),yield T_(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new C_}()}createDatastore(t){let r=Zi(t.databaseInfo.databaseId),i=function(s){return new m_(s)}(t.databaseInfo);return function(s,a,c,l){return new I_(s,a,c,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,s,a,c){return new w_(i,o,s,a,c)}(this.localStore,this.datastore,t.asyncQueue,r=>j0(this.syncEngine,r,0),function(){return Vh.C()?new Vh:new h_}())}createSyncEngine(t,r){return function(o,s,a,c,l,d,f){let g=new R_(o,s,a,c,l,d);return f&&(g.fu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return v(this,null,function*(){var t,r;yield function(o){return v(this,null,function*(){let s=F(o);x(qi,"RemoteStore shutting down."),s.Ia.add(5),yield Ps(s),s.Ea.shutdown(),s.Aa.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function U0(n,e=10240){let t=0;return{read(){return v(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return v(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var bs=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Fe("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var M_=class{constructor(e,t){this.Nu=e,this.serializer=t,this.metadata=new qe,this.buffer=new Uint8Array,this.Bu=function(){return new TextDecoder("utf-8")}(),this.Lu().then(r=>{r&&r.Qa()?this.metadata.resolve(r.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.qa)}`))},r=>this.metadata.reject(r))}close(){return this.Nu.cancel()}getMetadata(){return v(this,null,function*(){return this.metadata.promise})}Su(){return v(this,null,function*(){return yield this.getMetadata(),this.Lu()})}Lu(){return v(this,null,function*(){let e=yield this.ku();if(e===null)return null;let t=this.Bu.decode(e),r=Number(t);isNaN(r)&&this.qu(`length string (${t}) is not valid number`);let i=yield this.Qu(r);return new $h(JSON.parse(i),e.length+r)})}$u(){return this.buffer.findIndex(e=>e===123)}ku(){return v(this,null,function*(){for(;this.$u()<0&&!(yield this.Uu()););if(this.buffer.length===0)return null;let e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Qu(e){return v(this,null,function*(){for(;this.buffer.length<e;)(yield this.Uu())&&this.qu("Reached the end of bundle when more is expected.");let t=this.Bu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}qu(e){throw this.Nu.cancel(),new Error(`Invalid bundle format: ${e}`)}Uu(){return v(this,null,function*(){let e=yield this.Nu.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var k_=class{constructor(e,t){this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let r=this.Su();if(!r||!r.Qa())throw new Error(`The first element of the bundle is not a metadata object, it is
         ${JSON.stringify(r?.qa)}`);this.metadata=r;do r=this.Su(),r!==null&&this.elements.push(r);while(r!==null)}getMetadata(){return this.metadata}Ku(){return this.elements}Su(){if(this.cursor===this.bundleData.length)return null;let e=this.ku(),t=this.Qu(e);return new $h(JSON.parse(t),e)}Qu(e){if(this.cursor+e>this.bundleData.length)throw new k(S.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}ku(){let e=this.cursor,t=this.cursor;for(;t<this.bundleData.length;){if(this.bundleData[t]==="{"){if(t===e)throw new Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw new Error("Reached the end of bundle when more is expected.")}};var x_=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new k(S.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,o){return v(this,null,function*(){let s=F(i),a={documents:o.map(f=>bc(s.serializer,f))},c=yield s.Jo("BatchGetDocuments",s.serializer.databaseId,ue.emptyPath(),a,o.length),l=new Map;c.forEach(f=>{let g=D$(s.serializer,f);l.set(g.key.toString(),g)});let d=[];return o.forEach(f=>{let g=l.get(f.toString());H(!!g,55234,{key:f}),d.push(g)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Vr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=V.fromPath(r);this.mutations.push(new Ic(i,this.precondition(i)))}),yield function(r,i){return v(this,null,function*(){let o=F(r),s={writes:i.map(a=>Cc(o.serializer,a))};yield o.Wo("Commit",o.serializer.databaseId,ue.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw $(50498,{Wu:e.constructor.name});t=q.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new k(S.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(q.min())?ke.exists(!1):ke.updateTime(t):ke.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(q.min()))throw new k(S.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ke.updateTime(t)}return ke.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var O_=class{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this.Gu=r.maxAttempts,this.F_=new Pc(this.asyncQueue,"transaction_retry")}zu(){this.Gu-=1,this.ju()}ju(){this.F_.g_(()=>v(this,null,function*(){let e=new x_(this.datastore),t=this.Ju(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Hu(i)}))}).catch(r=>{this.Hu(r)})}))}Ju(e){try{let t=this.updateFunction(e);return!$c(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Hu(e){this.Gu>0&&this.Yu(e)?(this.Gu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ju(),Promise.resolve()))):this.deferred.reject(e)}Yu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!YA(t)}return!1}};var Br="FirestoreClient",F_=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=$e.UNAUTHENTICATED,this.clientId=lc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>v(this,null,function*(){x(Br,"Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(x(Br,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new qe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=xs(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Ky(n,e){return v(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),x(Br,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>v(null,null,function*(){r.isEqual(i)||(yield EN(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>{mt("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{x("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{mt("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e})}function $0(n,e){return v(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield xI(n);x(Br,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>F0(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>F0(e.remoteStore,i)),n._onlineComponents=e})}function xI(n){return v(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){x(Br,"Using user provided OfflineComponentProvider");try{yield Ky(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===S.FAILED_PRECONDITION||i.code===S.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;mt("Error using user provided cache. Falling back to memory cache: "+t),yield Ky(n,new yf)}}else x(Br,"Using default OfflineComponentProvider"),yield Ky(n,new Oc(void 0));return n._offlineComponents})}function vf(n){return v(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(x(Br,"Using user provided OnlineComponentProvider"),yield $0(n,n._uninitializedComponentsProvider._online)):(x(Br,"Using default OnlineComponentProvider"),yield $0(n,new Os))),n._onlineComponents})}function UN(n){return xI(n).then(e=>e.persistence)}function Fs(n){return xI(n).then(e=>e.localStore)}function $N(n){return vf(n).then(e=>e.remoteStore)}function OI(n){return vf(n).then(e=>e.syncEngine)}function HN(n){return vf(n).then(e=>e.datastore)}function Cs(n){return v(this,null,function*(){let e=yield vf(n),t=e.eventManager;return t.onListen=eH.bind(null,e.syncEngine),t.onUnlisten=nH.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=tH.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=rH.bind(null,e.syncEngine),t})}function IH(n){return n.asyncQueue.enqueue(()=>v(null,null,function*(){let e=yield UN(n),t=yield $N(n);return e.setNetworkEnabled(!0),function(i){let o=F(i);return o.Ia.delete(0),Gc(o)}(t)}))}function EH(n){return n.asyncQueue.enqueue(()=>v(null,null,function*(){let e=yield UN(n),t=yield $N(n);return e.setNetworkEnabled(!1),function(i){return v(this,null,function*(){let o=F(i);o.Ia.add(0),yield Ps(o),o.Aa.set("Offline")})}(t)}))}function wH(n,e){let t=new qe;return n.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return function(i,o,s){return v(this,null,function*(){try{let a=yield function(l,d){let f=F(l);return f.persistence.runTransaction("read document","readonly",g=>f.localDocuments.getDocument(g,d))}(i,o);a.isFoundDocument()?s.resolve(a):a.isNoDocument()?s.resolve(null):s.reject(new k(S.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=xs(a,`Failed to get document '${o} from cache`);s.reject(c)}})}(yield Fs(n),e,t)})),t.promise}function qN(n,e,t={}){let r=new qe;return n.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return function(o,s,a,c,l){let d=new bs({next:g=>{d.Ou(),s.enqueueAndForget(()=>SI(o,f));let m=g.docs.has(a);!m&&g.fromCache?l.reject(new k(S.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&g.fromCache&&c&&c.source==="server"?l.reject(new k(S.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(g)},error:g=>l.reject(g)}),f=new kc(Rs(a.path),d,{includeMetadataChanges:!0,ka:!0});return CI(o,f)}(yield Cs(n),n.asyncQueue,e,t,r)})),r.promise}function TH(n,e){let t=new qe;return n.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return function(i,o,s){return v(this,null,function*(){try{let a=yield xh(i,o,!0),c=new Wh(o,a.qs),l=c.nu(a.documents),d=c.applyChanges(l,!1);s.resolve(d.snapshot)}catch(a){let c=xs(a,`Failed to execute query '${o} against cache`);s.reject(c)}})}(yield Fs(n),e,t)})),t.promise}function zN(n,e,t={}){let r=new qe;return n.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return function(o,s,a,c,l){let d=new bs({next:g=>{d.Ou(),s.enqueueAndForget(()=>SI(o,f)),g.fromCache&&c.source==="server"?l.reject(new k(S.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(g)},error:g=>l.reject(g)}),f=new kc(a,d,{includeMetadataChanges:!0,ka:!0});return CI(o,f)}(yield Cs(n),n.asyncQueue,e,t,r)})),r.promise}function DH(n,e,t){let r=new qe;return n.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){try{let i=yield HN(n);r.resolve(function(s,a,c){return v(this,null,function*(){var l;let d=F(s),{request:f,ft:g,parent:m}=iN(d.serializer,xA(a),c);d.connection.Qo||delete f.parent;let w=(yield d.Jo("RunAggregationQuery",d.serializer.databaseId,m,f,1)).filter(P=>!!P.result);H(w.length===1,64727);let R=(l=w[0].result)===null||l===void 0?void 0:l.aggregateFields;return Object.keys(R).reduce((P,O)=>(P[g[O]]=R[O],P),{})})}(i,e,t))}catch(i){r.reject(i)}})),r.promise}function bH(n,e){let t=new bs(e);return n.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return function(i,o){F(i).Da.add(o),o.next()}(yield Cs(n),t)})),()=>{t.Ou(),n.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return function(i,o){F(i).Da.delete(o)}(yield Cs(n),t)}))}}function CH(n,e,t,r){let i=function(s,a){let c;return c=typeof s=="string"?oI().encode(s):s,function(d,f){return new M_(d,f)}(function(d,f){if(d instanceof Uint8Array)return U0(d,f);if(d instanceof ArrayBuffer)return U0(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,Zi(e));n.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){_H(yield OI(n),i,r)}))}function SH(n,e){return n.asyncQueue.enqueue(()=>v(null,null,function*(){return function(r,i){let o=F(r);return o.persistence.runTransaction("Get named query","readonly",s=>o.Ti.getNamedQuery(s,i))}(yield Fs(n),e)}))}function WN(n,e){return function(r,i){return new k_(r,i)}(n,e)}function AH(n,e){return n.asyncQueue.enqueue(()=>v(null,null,function*(){return function(r,i){return v(this,null,function*(){let o=F(r),s=o.indexManager,a=[];return o.persistence.runTransaction("Configure indexes","readwrite",c=>s.getFieldIndexes(c).next(l=>function(f,g,m,w,R){f=[...f],g=[...g],f.sort(m),g.sort(m);let P=f.length,O=g.length,B=0,U=0;for(;B<O&&U<P;){let W=m(f[U],g[B]);W<0?R(f[U++]):W>0?w(g[B++]):(B++,U++)}for(;B<O;)w(g[B++]);for(;U<P;)R(f[U++])}(l,i,PU,d=>{a.push(s.addFieldIndex(c,d))},d=>{a.push(s.deleteFieldIndex(c,d))})).next(()=>N.waitFor(a)))})}(yield Fs(n),e)}))}function NH(n,e){return n.asyncQueue.enqueue(()=>v(null,null,function*(){return function(r,i){F(r).Cs.Rs=i}(yield Fs(n),e)}))}function RH(n){return n.asyncQueue.enqueue(()=>v(null,null,function*(){return function(t){let r=F(t),i=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",o=>i.deleteAllFieldIndexes(o))}(yield Fs(n))}))}function GN(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var H0=new Map;var KN="firestore.googleapis.com",q0=!0,Kh=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new k(S.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=KN,this.ssl=q0}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:q0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=hN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mN)throw new k(S.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}RU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=GN((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new k(S.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new k(S.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new k(S.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Wi=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Kh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new k(S.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new k(S.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Kh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Qy;switch(r.type){case"firstParty":return new Xy(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new k(S.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return v(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=H0.get(t);r&&(x("ComponentProvider","Removing Datastore"),H0.delete(t),r.terminate())}(this),Promise.resolve()}};function FI(n,e,t,r={}){var i;n=ae(n,Wi);let o=xn(e),s=n._getSettings(),a=Object.assign(Object.assign({},s),{emulatorOptions:n._getEmulatorOptions()}),c=`${e}:${t}`;o&&(Pa(`https://${c}`),ad("Firestore",!0)),s.host!==KN&&s.host!==c&&mt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l=Object.assign(Object.assign({},s),{host:c,ssl:o,emulatorOptions:r});if(!Tt(l,a)&&(n._setSettings(l),r.mockUserToken)){let d,f;if(typeof r.mockUserToken=="string")d=r.mockUserToken,f=$e.MOCK_USER;else{d=$b(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new k(S.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new $e(g)}n._authCredentials=new Yy(new nh(d,f))}}var Qe=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},De=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Yi(t,n._jsonSchema))return new n(e,r||null,new V(ue.fromString(t.referencePath)))}};De._jsonSchemaVersion="firestore/documentReference/1.0",De._jsonSchema={type:He("string",De._jsonSchemaVersion),referencePath:He("string")};var wn=class n extends Qe{constructor(e,t,r){super(e,t,Rs(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new De(this.firestore,null,new V(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function QN(n,e,...t){if(n=ge(n),sI("collection","path",e),n instanceof Wi){let r=ue.fromString(e,...t);return jS(r),new wn(n,null,r)}{if(!(n instanceof De||n instanceof wn))throw new k(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ue.fromString(e,...t));return jS(r),new wn(n.firestore,null,r)}}function YN(n,e){if(n=ae(n,Wi),sI("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(S.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Qe(n,null,function(r){return new en(ue.emptyPath(),r)}(e))}function LI(n,e,...t){if(n=ge(n),arguments.length===1&&(e=lc.newId()),sI("doc","path",e),n instanceof Wi){let r=ue.fromString(e,...t);return VS(r),new De(n,null,new V(r))}{if(!(n instanceof De||n instanceof wn))throw new k(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ue.fromString(e,...t));return VS(r),new De(n.firestore,n instanceof wn?n.converter:null,new V(r))}}function Wr(n,e){return n=ge(n),e=ge(e),(n instanceof De||n instanceof wn)&&(e instanceof De||e instanceof wn)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function _f(n,e){return n=ge(n),e=ge(e),n instanceof Qe&&e instanceof Qe&&n.firestore===e.firestore&&zc(n._query,e._query)&&n.converter===e.converter}var z0="AsyncQueue",Qh=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Pc(this,"async_queue_retry"),this.oc=()=>{let r=th();r&&x(z0,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=th();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=th();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new qe;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}cc(){return v(this,null,function*(){if(this.Zu.length!==0){try{yield this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!$r(e))throw e;x(z0,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}})}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Fe("INTERNAL UNHANDLED ERROR: ",W0(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let i=D_.createAndSchedule(this,e,t,r,o=>this.lc(o));return this.ec.push(i),i}ac(){this.tc&&$(47125,{hc:W0(this.tc)})}verifyOperationInProgress(){}Pc(){return v(this,null,function*(){let e;do e=this._c,yield e;while(e!==this._c)})}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function W0(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function rs(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var L_=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new qe,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var kK=-1,ye=class extends Wi{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Qh,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return v(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Qh(e),this._firestoreClient=void 0,yield e}})}};function ZN(n,e,t){t||(t=yc);let r=fr(n,"firestore");if(r.isInitialized(t)){let i=r.getImmediate({identifier:t}),o=r.getOptions(t);if(Tt(o,e))return i;throw new k(S.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new k(S.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mN)throw new k(S.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&xn(e.host)&&Pa(e.host),r.initialize({options:e,instanceIdentifier:t})}function JN(n,e){let t=typeof n=="object"?n:gr(),r=typeof n=="string"?n:e||yc,i=fr(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Ub("firestore");o&&FI(i,...o)}return i}function Re(n){if(n._terminated)throw new k(S.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||XN(n),n._firestoreClient}function XN(n){var e,t,r;let i=n._freezeSettings(),o=function(a,c,l,d){return new dv(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,GN(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new F_(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}}(n._componentsProvider))}function eR(n,e){mt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return nR(n,Os.provider,{build:r=>new Fc(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function tR(n){return v(this,null,function*(){mt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();nR(n,Os.provider,{build:t=>new Gh(t,e.cacheSizeBytes)})})}function nR(n,e,t){if((n=ae(n,ye))._firestoreClient||n._terminated)throw new k(S.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new k(S.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},XN(n)}function rR(n){if(n._initialized&&!n._terminated)throw new k(S.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new qe;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>v(null,null,function*(){try{yield function(r){return v(this,null,function*(){if(!Mr.C())return Promise.resolve();let i=r+_N;yield Mr.delete(i)})}(EI(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function iR(n){return function(t){let r=new qe;return t.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return cH(yield OI(t),r)})),r.promise}(Re(n=ae(n,ye)))}function oR(n){return IH(Re(n=ae(n,ye)))}function sR(n){return EH(Re(n=ae(n,ye)))}function aR(n){return lC(n.app,"firestore",n._databaseId.database),n._delete()}function Yh(n,e){let t=Re(n=ae(n,ye)),r=new L_;return CH(t,n._databaseId,e,r),r}function VI(n,e){return SH(Re(n=ae(n,ye)),e).then(t=>t?new Qe(n,null,t.query):null)}var Gi=class{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}},V_=class{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}};var zn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ve.fromBase64String(e))}catch(t){throw new k(S.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ve.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yi(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};zn._jsonSchemaVersion="firestore/bytes/1.0",zn._jsonSchema={type:He("string",zn._jsonSchemaVersion),bytes:He("string")};var Zn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new k(S.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};function cR(){return new Zn(nv)}var Jn=class{constructor(e){this._methodName=e}};var Nr=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new k(S.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new k(S.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return z(this._lat,e._lat)||z(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Yi(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Nr._jsonSchemaVersion="firestore/geoPoint/1.0",Nr._jsonSchema={type:He("string",Nr._jsonSchemaVersion),latitude:He("number"),longitude:He("number")};var Wn=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yi(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new k(S.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Wn._jsonSchemaVersion="firestore/vectorValue/1.0",Wn._jsonSchema={type:He("string",Wn._jsonSchemaVersion),vectorValues:He("object")};var PH=/^__.*__$/,j_=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new nn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Lr(e,this.data,t,this.fieldTransforms)}},Zh=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new nn(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function uR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $(40011,{Ec:n})}}var Jh=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Xh(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(uR(this.Ec)&&PH.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},B_=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Zi(e)}Dc(e,t,r,i=!1){return new Jh({Ec:e,methodName:t,bc:r,path:ze.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Ji(n){let e=n._freezeSettings(),t=Zi(n._databaseId);return new B_(n._databaseId,!!e.ignoreUndefinedProperties,t)}function If(n,e,t,r,i,o={}){let s=n.Dc(o.merge||o.mergeFields?2:0,e,t,i);UI("Data must be an object, but it was:",s,r);let a=hR(r,s),c,l;if(o.merge)c=new Ot(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let f of o.mergeFields){let g=Vc(e,f,t);if(!s.contains(g))throw new k(S.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);pR(d,g)||d.push(g)}c=new Ot(d),l=s.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,l=s.fieldTransforms;return new j_(new ot(a),c,l)}var Lc=class n extends Jn{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function lR(n,e,t){return new Jh({Ec:3,bc:e.settings.bc,methodName:n._methodName,mc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var U_=class n extends Jn{_toFieldTransform(e){return new Ui(e.path,new Or)}isEqual(e){return e instanceof n}},$_=class n extends Jn{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){let t=lR(this,e,!0),r=this.vc.map(o=>Xi(o,t)),i=new Qn(r);return new Ui(e.path,i)}isEqual(e){return e instanceof n&&Tt(this.vc,e.vc)}},H_=class n extends Jn{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){let t=lR(this,e,!0),r=this.vc.map(o=>Xi(o,t)),i=new Yn(r);return new Ui(e.path,i)}isEqual(e){return e instanceof n&&Tt(this.vc,e.vc)}},q_=class n extends Jn{constructor(e,t){super(e),this.Cc=t}_toFieldTransform(e){let t=new Fr(e.serializer,HA(e.serializer,this.Cc));return new Ui(e.path,t)}isEqual(e){return e instanceof n&&this.Cc===e.Cc}};function jI(n,e,t,r){let i=n.Dc(1,e,t);UI("Data must be an object, but it was:",i,r);let o=[],s=ot.empty();Hr(r,(c,l)=>{let d=Ef(e,c,t);l=ge(l);let f=i.gc(d);if(l instanceof Lc)o.push(d);else{let g=Xi(l,f);g!=null&&(o.push(d),s.set(d,g))}});let a=new Ot(o);return new Zh(s,a,i.fieldTransforms)}function BI(n,e,t,r,i,o){let s=n.Dc(1,e,t),a=[Vc(e,r,t)],c=[i];if(o.length%2!=0)throw new k(S.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)a.push(Vc(e,o[g])),c.push(o[g+1]);let l=[],d=ot.empty();for(let g=a.length-1;g>=0;--g)if(!pR(l,a[g])){let m=a[g],w=c[g];w=ge(w);let R=s.gc(m);if(w instanceof Lc)l.push(m);else{let P=Xi(w,R);P!=null&&(l.push(m),d.set(m,P))}}let f=new Ot(l);return new Zh(d,f,s.fieldTransforms)}function dR(n,e,t,r=!1){return Xi(t,n.Dc(r?4:3,e))}function Xi(n,e){if(fR(n=ge(n)))return UI("Unsupported field value:",e,n),hR(n,e);if(n instanceof Jn)return function(r,i){if(!uR(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let c=Xi(a,i.yc(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=ge(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return HA(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Ae.fromDate(r);return{timestampValue:vs(i.serializer,o)}}if(r instanceof Ae){let o=new Ae(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:vs(i.serializer,o)}}if(r instanceof Nr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof zn)return{bytesValue:JA(i.serializer,r._byteString)};if(r instanceof De){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.wc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:_I(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Wn)return function(s,a){return{mapValue:{fields:{[fI]:{stringValue:pI},[fs]:{arrayValue:{values:s.toArray().map(l=>{if(typeof l!="number")throw a.wc("VectorValues must only contain numeric values.");return vI(a.serializer,l)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${of(r)}`)}(n,e)}function hR(n,e){let t={};return _A(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hr(n,(r,i)=>{let o=Xi(i,e.Vc(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function fR(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ae||n instanceof Nr||n instanceof zn||n instanceof De||n instanceof Jn||n instanceof Wn)}function UI(n,e,t){if(!fR(t)||!tA(t)){let r=of(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function Vc(n,e,t){if((e=ge(e))instanceof Zn)return e._internalPath;if(typeof e=="string")return Ef(n,e);throw Xh("Field path arguments must be of type string or ",n,!1,void 0,t)}var MH=new RegExp("[~\\*/\\[\\]]");function Ef(n,e,t){if(e.search(MH)>=0)throw Xh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Zn(...e.split("."))._internalPath}catch{throw Xh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Xh(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new k(S.INVALID_ARGUMENT,a+n+c)}function pR(n,e){return n.some(t=>t.isEqual(e))}var Ki=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new De(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new z_(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(wf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},z_=class extends Ki{data(){return super.data()}};function wf(n,e){return typeof e=="string"?Ef(n,e):e instanceof Zn?e._internalPath:e._delegate._internalPath}function gR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new k(S.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var jc=class{},Qi=class extends jc{};function mR(n,e,...t){let r=[];e instanceof jc&&r.push(e),r=r.concat(t),function(o){let s=o.filter(c=>c instanceof Ss).length,a=o.filter(c=>c instanceof Bc).length;if(s>1||s>0&&a>0)throw new k(S.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Bc=class n extends Qi{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return AR(e._query,t),new Qe(e.firestore,e.converter,Dv(e._query,t))}_parse(e){let t=Ji(e.firestore);return function(o,s,a,c,l,d,f){let g;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new k(S.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){K0(f,d);let w=[];for(let R of f)w.push(G0(c,o,R));g={arrayValue:{values:w}}}else g=G0(c,o,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||K0(f,d),g=dR(a,s,f,d==="in"||d==="not-in");return le.create(l,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function yR(n,e,t){let r=e,i=wf("where",n);return Bc._create(i,r,t)}var Ss=class n extends jc{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:me.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let c of a)AR(s,c),s=Dv(s,c)}(e._query,t),new Qe(e.firestore,e.converter,Dv(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function vR(...n){return n.forEach(e=>NR("or",e)),Ss._create("or",n)}function _R(...n){return n.forEach(e=>NR("and",e)),Ss._create("and",n)}var W_=class n extends Qi{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new k(S.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new k(S.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ji(o,s)}(e._query,this._field,this._direction);return new Qe(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new en(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function IR(n,e="asc"){let t=e,r=wf("orderBy",n);return W_._create(r,t)}var ef=class n extends Qi{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Qe(e.firestore,e.converter,gh(e._query,this._limit,this._limitType))}};function ER(n){return nA("limit",n),ef._create("limit",n,"F")}function wR(n){return nA("limitToLast",n),ef._create("limitToLast",n,"L")}var tf=class n extends Qi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=SR(e,this.type,this._docOrFields,this._inclusive);return new Qe(e.firestore,e.converter,function(i,o){return new en(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}};function TR(...n){return tf._create("startAt",n,!0)}function DR(...n){return tf._create("startAfter",n,!1)}var nf=class n extends Qi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=SR(e,this.type,this._docOrFields,this._inclusive);return new Qe(e.firestore,e.converter,function(i,o){return new en(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}};function bR(...n){return nf._create("endBefore",n,!1)}function CR(...n){return nf._create("endAt",n,!0)}function SR(n,e,t,r){if(t[0]=ge(t[0]),t[0]instanceof Ki)return function(o,s,a,c,l){if(!c)throw new k(S.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let f of ts(o))if(f.field.isKeyField())d.push(Vi(s,c.key));else{let g=c.data.field(f.field);if(uf(g))throw new k(S.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let m=f.field.canonicalString();throw new k(S.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}d.push(g)}return new Dn(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Ji(n.firestore);return function(s,a,c,l,d,f){let g=s.explicitOrderBy;if(d.length>g.length)throw new k(S.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let m=[];for(let w=0;w<d.length;w++){let R=d[w];if(g[w].field.isKeyField()){if(typeof R!="string")throw new k(S.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof R}`);if(!mI(s)&&R.indexOf("/")!==-1)throw new k(S.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${R}' contains a slash.`);let P=s.path.child(ue.fromString(R));if(!V.isDocumentKey(P))throw new k(S.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);let O=new V(P);m.push(Vi(a,O))}else{let P=dR(c,l,R);m.push(P)}}return new Dn(m,f)}(n._query,n.firestore._databaseId,i,e,t,r)}}function G0(n,e,t){if(typeof(t=ge(t))=="string"){if(t==="")throw new k(S.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mI(e)&&t.indexOf("/")!==-1)throw new k(S.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ue.fromString(t));if(!V.isDocumentKey(r))throw new k(S.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Vi(n,new V(r))}if(t instanceof De)return Vi(n,t._key);throw new k(S.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${of(t)}.`)}function K0(n,e){if(!Array.isArray(n)||n.length===0)throw new k(S.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function AR(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new k(S.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new k(S.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function NR(n,e){if(!(e instanceof Bc||e instanceof Ss))throw new k(S.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}var rf=class{convertValue(e,t="none"){switch(kr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Kn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw $(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Hr(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[fs].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>Se(s.doubleValue));return new Wn(o)}convertGeoPoint(e){return new Nr(Se(e.latitude),Se(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=lf(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(mc(e));default:return null}}convertTimestamp(e){let t=Gn(e);return new Ae(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ue.fromString(e);H(cN(r),9688,{name:e});let i=new hs(r.get(1),r.get(3)),o=new V(r.popFirst(5));return i.isEqual(t)||Fe(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function Tf(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Uc=class extends rf{constructor(e){super(),this.firestore=e}convertBytes(e){return new zn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new De(this.firestore,null,t)}};function RR(n){return new Gi("sum",Vc("sum",n))}function xK(n){return new Gi("avg",Vc("average",n))}function kH(){return new Gi("count")}function PR(n,e){var t,r;return n instanceof Gi&&e instanceof Gi&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function MR(n,e){return _f(n.query,e.query)&&Tt(n.data(),e.data())}var kR="NOT SUPPORTED",_n=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ft=class n extends Ki{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new is(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(wf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new k(S.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};function OK(n,e,t){if(Yi(e,Ft._jsonSchema)){if(e.bundle===kR)throw new k(S.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let r=Zi(n._databaseId),i=WN(e.bundle,r),o=i.Ku(),s=new xc(i.getMetadata(),r);for(let d of o)s.Wa(d);let a=s.documents;if(a.length!==1)throw new k(S.INVALID_ARGUMENT,`Expected bundle data to contain 1 document, but it contains ${a.length} documents.`);let c=hf(r,a[0].document),l=new V(ue.fromString(e.bundleName));return new Ft(n,new Uc(n),l,c,new _n(!1,!1),t||null)}}Ft._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ft._jsonSchema={type:He("string",Ft._jsonSchemaVersion),bundleSource:He("string","DocumentSnapshot"),bundleName:He("string"),bundle:He("string")};var is=class extends Ft{data(e={}){return super.data(e)}},Lt=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new _n(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new is(this._firestore,this._userDataWriter,r.key,r,new _n(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new k(S.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let c=new is(i._firestore,i._userDataWriter,a.doc.key,a.doc,new _n(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let c=new is(i._firestore,i._userDataWriter,a.doc.key,a.doc,new _n(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:xH(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new k(S.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=lc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function FK(n,e,t){if(Yi(e,Lt._jsonSchema)){if(e.bundle===kR)throw new k(S.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");let r=Zi(n._databaseId),i=WN(e.bundle,r),o=i.Ku(),s=new xc(i.getMetadata(),r);for(let g of o)s.Wa(g);if(s.queries.length!==1)throw new k(S.INVALID_ARGUMENT,`Snapshot data expected 1 query but found ${s.queries.length} queries.`);let a=pf(s.queries[0].bundledQuery),c=s.documents,l=new Mc;c.map(g=>{let m=hf(r,g.document);l=l.add(m)});let d=zi.fromInitialDocuments(a,l,X(),!1,!1),f=new Qe(n,t||null,a);return new Lt(n,new Uc(n),f,d)}}function xH(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $(61501,{type:n})}}function xR(n,e){return n instanceof Ft&&e instanceof Ft?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Lt&&e instanceof Lt&&n._firestore===e._firestore&&_f(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function OR(n){n=ae(n,De);let e=ae(n.firestore,ye);return qN(Re(e),n._key).then(t=>$I(e,n,t))}Lt._jsonSchemaVersion="firestore/querySnapshot/1.0",Lt._jsonSchema={type:He("string",Lt._jsonSchemaVersion),bundleSource:He("string","QuerySnapshot"),bundleName:He("string"),bundle:He("string")};var bn=class extends rf{constructor(e){super(),this.firestore=e}convertBytes(e){return new zn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new De(this.firestore,null,t)}};function FR(n){n=ae(n,De);let e=ae(n.firestore,ye),t=Re(e),r=new bn(e);return wH(t,n._key).then(i=>new Ft(e,r,n._key,i,new _n(i!==null&&i.hasLocalMutations,!0),n.converter))}function LR(n){n=ae(n,De);let e=ae(n.firestore,ye);return qN(Re(e),n._key,{source:"server"}).then(t=>$I(e,n,t))}function VR(n){n=ae(n,Qe);let e=ae(n.firestore,ye),t=Re(e),r=new bn(e);return gR(n._query),zN(t,n._query).then(i=>new Lt(e,r,n,i))}function jR(n){n=ae(n,Qe);let e=ae(n.firestore,ye),t=Re(e),r=new bn(e);return TH(t,n._query).then(i=>new Lt(e,r,n,i))}function BR(n){n=ae(n,Qe);let e=ae(n.firestore,ye),t=Re(e),r=new bn(e);return zN(t,n._query,{source:"server"}).then(i=>new Lt(e,r,n,i))}function UR(n,e,t){n=ae(n,De);let r=ae(n.firestore,ye),i=Tf(n.converter,e,t);return Kc(r,[If(Ji(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,ke.none())])}function $R(n,e,t,...r){n=ae(n,De);let i=ae(n.firestore,ye),o=Ji(i),s;return s=typeof(e=ge(e))=="string"||e instanceof Zn?BI(o,"updateDoc",n._key,e,t,r):jI(o,"updateDoc",n._key,e),Kc(i,[s.toMutation(n._key,ke.exists(!0))])}function HR(n){return Kc(ae(n.firestore,ye),[new Vr(n._key,ke.none())])}function qR(n,e){let t=ae(n.firestore,ye),r=LI(n),i=Tf(n.converter,e);return Kc(t,[If(Ji(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,ke.exists(!1))]).then(()=>r)}function As(n,...e){var t,r,i;n=ge(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||rs(e[s])||(o=e[s++]);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(rs(e[s])){let f=e[s];e[s]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[s+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[s+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let c,l,d;if(n instanceof De)l=ae(n.firestore,ye),d=Rs(n._key.path),c={next:f=>{e[s]&&e[s]($I(l,n,f))},error:e[s+1],complete:e[s+2]};else{let f=ae(n,Qe);l=ae(f.firestore,ye),d=f._query;let g=new bn(l);c={next:m=>{e[s]&&e[s](new Lt(l,g,f,m))},error:e[s+1],complete:e[s+2]},gR(n._query)}return function(g,m,w,R){let P=new bs(R),O=new kc(m,P,w);return g.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return CI(yield Cs(g),O)})),()=>{P.Ou(),g.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return SI(yield Cs(g),O)}))}}(Re(l),d,a,c)}function LK(n,e,...t){let r=ge(n),i=function(c){let l={bundle:"",bundleName:"",bundleSource:""},d=["bundle","bundleName","bundleSource"];for(let f of d){if(!(f in c)){l.error=`snapshotJson missing required field: ${f}`;break}let g=c[f];if(typeof g!="string"){l.error=`snapshotJson field '${f}' must be a string.`;break}if(g.length===0){l.error=`snapshotJson field '${f}' cannot be an empty string.`;break}f==="bundle"?l.bundle=g:f==="bundleName"?l.bundleName=g:f==="bundleSource"&&(l.bundleSource=g)}return l}(e);if(i.error)throw new k(S.INVALID_ARGUMENT,i.error);let o,s=0;if(typeof t[s]!="object"||rs(t[s])||(o=t[s++]),i.bundleSource==="QuerySnapshot"){let a=null;if(typeof t[s]=="object"&&rs(t[s])){let c=t[s++];a={next:c.next,error:c.error,complete:c.complete}}else a={next:t[s++],error:t[s++],complete:t[s++]};return function(l,d,f,g,m){let w,R=!1;return Yh(l,d.bundle).then(()=>VI(l,d.bundleName)).then(O=>{O&&!R&&(m&&O.withConverter(m),w=As(O,f||{},g))}).catch(O=>(g.error&&g.error(O),()=>{})),()=>{R||(R=!0,w&&w())}}(r,i,o,a,t[s])}if(i.bundleSource==="DocumentSnapshot"){let a=null;if(typeof t[s]=="object"&&rs(t[s])){let c=t[s++];a={next:c.next,error:c.error,complete:c.complete}}else a={next:t[s++],error:t[s++],complete:t[s++]};return function(l,d,f,g,m){let w,R=!1;return Yh(l,d.bundle).then(()=>{if(!R){let O=new De(l,m||null,V.fromPath(d.bundleName));w=As(O,f||{},g)}}).catch(O=>(g.error&&g.error(O),()=>{})),()=>{R||(R=!0,w&&w())}}(r,i,o,a,t[s])}throw new k(S.INVALID_ARGUMENT,`unsupported bundle source: ${i.bundleSource}`)}function zR(n,e){return bH(Re(n=ae(n,ye)),rs(e)?e:{next:e})}function Kc(n,e){return function(r,i){let o=new qe;return r.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){return iH(yield OI(r),i,o)})),o.promise}(Re(n),e)}function $I(n,e,t){let r=t.docs.get(e._key),i=new bn(n);return new Ft(n,i,e._key,r,new _n(t.hasPendingWrites,t.fromCache),e.converter)}function Df(n){return HI(n,{count:kH()})}function HI(n,e){let t=ae(n.firestore,ye),r=Re(t),i=vA(e,(o,s)=>new mh(s,o.aggregateType,o._internalFieldPath));return DH(r,n._query,i).then(o=>function(a,c,l){let d=new bn(a);return new V_(c,d,l)}(t,n,o))}var G_=class{constructor(e){this.kind="memory",this._onlineComponentProvider=Os.provider,e?.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider={build:()=>new Oc(void 0)}}toJSON(){return{kind:this.kind}}},K_=class{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=OH(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}},Q_=class{constructor(){this.kind="memoryEager",this._offlineComponentProvider=yf.provider}toJSON(){return{kind:this.kind}}},Y_=class{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new Oc(e)}}toJSON(){return{kind:this.kind}}};function VK(){return new Q_}function jK(n){return new Y_(n?.cacheSizeBytes)}function BK(n){return new G_(n)}function UK(n){return new K_(n)}var Z_=class{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Os.provider,this._offlineComponentProvider={build:t=>new Fc(t,e?.cacheSizeBytes,this.forceOwnership)}}},J_=class{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Os.provider,this._offlineComponentProvider={build:t=>new Gh(t,e?.cacheSizeBytes)}}};function OH(n){return new Z_(n?.forceOwnership)}function $K(){return new J_}var FH={maxAttempts:5};var X_=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ji(e)}set(e,t,r){this._verifyNotCommitted();let i=Sr(e,this._firestore),o=Tf(i.converter,t,r),s=If(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,ke.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let o=Sr(e,this._firestore),s;return s=typeof(t=ge(t))=="string"||t instanceof Zn?BI(this._dataReader,"WriteBatch.update",o._key,t,r,i):jI(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,ke.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Sr(e,this._firestore);return this._mutations=this._mutations.concat(new Vr(t._key,ke.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(S.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Sr(n,e){if((n=ge(n)).firestore!==e)throw new k(S.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var eI=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Ji(e)}get(e){let t=Sr(e,this._firestore),r=new Uc(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||i.length!==1)return $(24041);let o=i[0];if(o.isFoundDocument())return new Ki(this._firestore,r,o.key,o,t.converter);if(o.isNoDocument())return new Ki(this._firestore,r,t._key,null,t.converter);throw $(18433,{doc:o})})}set(e,t,r){let i=Sr(e,this._firestore),o=Tf(i.converter,t,r),s=If(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,r);return this._transaction.set(i._key,s),this}update(e,t,r,...i){let o=Sr(e,this._firestore),s;return s=typeof(t=ge(t))=="string"||t instanceof Zn?BI(this._dataReader,"Transaction.update",o._key,t,r,i):jI(this._dataReader,"Transaction.update",o._key,t),this._transaction.update(o._key,s),this}delete(e){let t=Sr(e,this._firestore);return this._transaction.delete(t._key),this}};var tI=class extends eI{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Sr(e,this._firestore),r=new bn(this._firestore);return super.get(e).then(i=>new Ft(this._firestore,r,t._key,i._document,new _n(!1,!1),t.converter))}};function WR(n,e,t){n=ae(n,ye);let r=Object.assign(Object.assign({},FH),t);return function(o){if(o.maxAttempts<1)throw new k(S.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,s,a){let c=new qe;return o.asyncQueue.enqueueAndForget(()=>v(null,null,function*(){let l=yield HN(o);new O_(o.asyncQueue,l,a,s,c).zu()})),c.promise}(Re(n),i=>e(new tI(n,i)),r)}function GR(){return new Lc("deleteField")}function HK(){return new U_("serverTimestamp")}function qK(...n){return new $_("arrayUnion",n)}function zK(...n){return new H_("arrayRemove",n)}function KR(n){return new q_("increment",n)}function QR(n){return new Wn(n)}function YR(n){return Re(n=ae(n,ye)),new X_(n,e=>Kc(n,e))}function ZR(n,e){let t=Re(n=ae(n,ye));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return mt("Cannot enable indexes when persistence is disabled"),Promise.resolve();let r=function(o){let s=typeof o=="string"?function(l){try{return JSON.parse(l)}catch(d){throw new k(S.INVALID_ARGUMENT,"Failed to parse JSON: "+d?.message)}}(o):o,a=[];if(Array.isArray(s.indexes))for(let c of s.indexes){let l=Q0(c,"collectionGroup"),d=[];if(Array.isArray(c.fields))for(let f of c.fields){let g=Ef("setIndexConfiguration",Q0(f,"fieldPath"));f.arrayConfig==="CONTAINS"?d.push(new qn(g,2)):f.order==="ASCENDING"?d.push(new qn(g,0)):f.order==="DESCENDING"&&d.push(new qn(g,1))}a.push(new Pr(Pr.UNKNOWN_ID,l,d,as.empty()))}return a}(e);return AH(t,r)}function Q0(n,e){if(typeof n[e]!="string")throw new k(S.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}var nI=class{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}};function JR(n){var e;n=ae(n,ye);let t=Y0.get(n);if(t)return t;if(((e=Re(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;let r=new nI(n);return Y0.set(n,r),r}function XR(n){nP(n,!0)}function eP(n){nP(n,!1)}function tP(n){RH(Re(n._firestore)).then(e=>x("deleting all persistent cache indexes succeeded")).catch(e=>mt("deleting all persistent cache indexes failed",e))}function nP(n,e){NH(Re(n._firestore),e).then(t=>x(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>mt(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}var Y0=new WeakMap;function WK(n){var e;let t=(e=Re(ae(n.firestore,ye))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:ff(t,at(n._query)).Vt}function GK(n,e){var t;let r=vA(e,(o,s)=>new mh(s,o.aggregateType,o._internalFieldPath)),i=(t=Re(ae(n.firestore,ye))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return i===void 0?null:iN(i,xA(n._query),r,!0).request}var Z0=class{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return rI.instance.onExistenceFilterMismatch(e)}},rI=class n{constructor(){this.Fc=new Map}static get instance(){return Gd||(Gd=new n,function(t){if(yh)throw new Error("a TestingHooksSpi instance is already set");yh=t}(Gd)),Gd}ct(e){this.Fc.forEach(t=>t(e))}onExistenceFilterMismatch(e){let t=Symbol(),r=this.Fc;return r.set(t,e),()=>r.delete(t)}},Gd=null;(function(e,t=!0){(function(i){Ns=i})(pr),Yt(new gt("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new ye(new Zy(r.getProvider("auth-internal")),new ev(s,r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new k(S.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hs(l.options.projectId,d)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),Ne(xS,OS,e),Ne(xS,OS,"esm2017")})();var bf=function(){return bf=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},bf.apply(this,arguments)};function WI(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}var LH={includeMetadataChanges:!1};function Qc(n,e){return e===void 0&&(e=LH),new ee(function(t){var r=As(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function GI(n){return Qc(n,{includeMetadataChanges:!0})}function rP(n,e){return e===void 0&&(e={}),GI(n).pipe(dt(function(t){return Cf(t,e)}))}function Cf(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:bf(bf({},r),(t={},t[e.idField]=n.id,t))}var iP=["added","modified","removed"],VH=function(n){return ar(function(e){for(var t=!1,r=0;r<e.length;r++){var i=e[r];if(n&&n.indexOf(i.type)>=0){t=!0;break}}return t})};function qI(n,e,t){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=n.slice();return o.splice.apply(o,WI([e,t],r,!1)),o}function jH(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&Wr(n[e.newIndex].doc.ref,e.doc.ref)))return qI(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||Wr(n[e.oldIndex].doc.ref,e.doc.ref))if(e.oldIndex!==e.newIndex){var t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return qI(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&Wr(n[e.oldIndex].doc.ref,e.doc.ref))return qI(n,e.oldIndex,1);break}return n}function BH(n,e,t){return t===void 0&&(t=iP),e.forEach(function(r){t.indexOf(r.type)>-1&&(n=jH(n,r))}),n}var oP=function(){return Cu(xp(void 0),kp())},zI=function(n,e){return JSON.stringify(n.metadata)===JSON.stringify(e.metadata)},UH=function(){return Cu(oP(),ar(function(n){var e=n[0],t=n[1];return t.length>0||e===void 0}),dt(function(n){var e=n[1];return e}))};function Sf(n,e){return e===void 0&&(e={}),Qc(n,{includeMetadataChanges:!0}).pipe(oP(),dt(function(t){var r=t[0],i=t[1],o=i.docChanges();return r&&!zI(r,i)&&i.docs.forEach(function(s,a){var c=o.find(function(d){return Wr(d.doc.ref,s.ref)});if(c){if(zI(c.doc,s))return}else{var l=r?.docs.find(function(d){return Wr(d.ref,s.ref)});if(l&&zI(l,s))return}o.push({oldIndex:a,newIndex:a,type:"modified",doc:s})}),o}),VH(e.events||iP),UH())}function KI(n){return Qc(n,{includeMetadataChanges:!0}).pipe(dt(function(e){return e.docs}))}function sP(n,e){return e===void 0&&(e={}),Sf(n,e).pipe(Yu(function(t,r){return BH(t,r,e.events)},[]),Pp())}function aP(n,e){return e===void 0&&(e={}),Sf(n,e).pipe(Yu(function(t,r){return WI(WI([],t,!0),r,!0)},[]))}function cP(n,e){return e===void 0&&(e={}),KI(n).pipe(dt(function(t){return t.map(function(r){return Cf(r,e)})}))}function QI(n){return Vt(Df(n))}function uP(n){return QI(n).pipe(dt(function(e){return e.data().count}))}var Yc=class{constructor(e){return e}},ZI="firestore",YI=class{constructor(){return wi(ZI)}},fQ=Sp(0,300).pipe(Ap(()=>Vt(wi(ZI))),Rp()),JI=new oe("angularfire2.firestore-instances");function $H(n,e){let t=xa(ZI,n,e);return t&&new Yc(t)}function HH(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Yc(r)}}var lP={provide:YI,deps:[[new At,JI]]},dP={provide:Yc,useFactory:$H,deps:[[new At,JI],Ln]},pQ=(()=>{class n{constructor(){Ne("angularfire",Fn.full,"fst")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Jl({type:n});static \u0275inj=kl({providers:[dP,lP]})}return n})();function gQ(n,...e){return Ne("angularfire",Fn.full,"fst"),No([dP,lP,{provide:JI,useFactory:HH(n),multi:!0,deps:[xe,Et,mr,Ti,[new At,Ga],[new At,Bo],...e]}])}var mQ=j(aP,!0),yQ=j(KI,!0),vQ=j(Sf,!0),_Q=j(uP,!0),IQ=j(QI,!0),EQ=j(cP,!0),wQ=j(GI,!0),TQ=j(rP,!0),DQ=j(Qc,!0),bQ=j(Cf,!0),CQ=j(sP,!0),SQ=j(qR,!0,2),AQ=j(PR,!0,2),NQ=j(MR,!0,2),RQ=j(_R,!0,2),PQ=j(rR,!0),MQ=j(QN,!0,2),kQ=j(YN,!0,2),xQ=j(FI,!0),OQ=j(tP,!0),FQ=j(HR,!0,2),LQ=j(GR,!0,2),VQ=j(sR,!0),jQ=j(eP,!0),BQ=j(LI,!0,2),UQ=j(cR,!0,2),$Q=j(eR,!0),HQ=j(tR,!0),qQ=j(oR,!0),zQ=j(XR,!0),WQ=j(CR,!0,2),GQ=j(bR,!0,2),KQ=j(HI,!0),QQ=j(Df,!0),YQ=j(OR,!0),ZQ=j(FR,!0),JQ=j(LR,!0),XQ=j(VR,!0),eY=j(jR,!0),tY=j(BR,!0),nY=j(JN,!0),rY=j(JR,!0),iY=j(KR,!0,2),oY=j(ZN,!0),sY=j(ER,!0,2),aY=j(wR,!0,2),cY=j(Yh,!0),uY=j(VI,!0,2),lY=j(As,!0),dY=j(zR,!0),hY=j(vR,!0,2),fY=j(IR,!0,2),pY=j(mR,!0,2),gY=j(_f,!0,2),mY=j(Wr,!0,2),yY=j(WR,!0),vY=j(UR,!0,2),_Y=j(ZR,!0),IY=j(J0,!0),EY=j(xR,!0,2),wY=j(DR,!0,2),TY=j(TR,!0,2),DY=j(RR,!0,2),bY=j(aR,!0),CY=j($R,!0,2),SY=j(QR,!0,2),AY=j(iR,!0),NY=j(yR,!0,2),RY=j(YR,!0,2);export{Ze as a,Je as b,v as c,je as d,Cu as e,wp as f,Tp as g,Rn as h,ca as i,la as j,Vt as k,_M as l,IM as m,EM as n,ni as o,dt as p,NM as q,ri as r,Ku as s,PM as t,MM as u,Sp as v,ar as w,Mw as x,Ap as y,da as z,Np as A,OM as B,FM as C,Mp as D,LM as E,Yu as F,xp as G,xw as H,VM as I,jM as J,ie as K,TT as L,Te as M,kl as N,V8 as O,oe as P,ne as Q,ft as R,Q as S,No as T,BT as U,sn as V,Ro as W,bk as X,j8 as Y,B8 as Z,U8 as _,Et as $,Ul as aa,Aa as ba,cr as ca,xe as da,bo as ea,$8 as fa,Xg as ga,Sx as ha,H8 as ia,q8 as ja,xx as ka,LD as la,z8 as ma,BD as na,_a as oa,W8 as pa,bl as qa,Sl as ra,gb as sa,wt as ta,Zl as ua,BO as va,UO as wa,n5 as xa,Jl as ya,Xl as za,QO as Aa,cF as Ba,r5 as Ca,pm as Da,fF as Ea,wa as Fa,bF as Ga,CF as Ha,SF as Ia,Ab as Ja,Nb as Ka,LF as La,BF as Ma,UF as Na,i5 as Oa,YF as Pa,o5 as Qa,s5 as Ra,a5 as Sa,eL as Ta,Rb as Ua,c5 as Va,u5 as Wa,l5 as Xa,d5 as Ya,h5 as Za,TL as _a,f5 as $a,p5 as ab,xb as bb,SL as cb,Ob as db,fd as eb,pd as fb,XV as gb,Um as hb,wC as ib,f2 as jb,kC as kb,p2 as lb,m2 as mb,_2 as nb,I2 as ob,E2 as pb,w2 as qb,Gm as rb,gW as sb,mW as tb,yW as ub,wj as vb,Wa as wb,fK as xb,pK as yb,gK as zb,mK as Ab,yK as Bb,mt as Cb,RK as Db,k as Eb,Qy as Fb,FS as Gb,lc as Hb,ze as Ib,V as Jb,RU as Kb,ae as Lb,Ae as Mb,MK as Nb,Ve as Ob,hs as Pb,Qe as Qb,De as Rb,wn as Sb,L_ as Tb,kK as Ub,ZN as Vb,Re as Wb,Gi as Xb,V_ as Yb,zn as Zb,Zn as _b,Jn as $b,Nr as ac,Wn as bc,Qi as cc,Bc as dc,Ss as ec,W_ as fc,ef as gc,tf as hc,nf as ic,rf as jc,xK as kc,kH as lc,_n as mc,Ft as nc,OK as oc,is as pc,Lt as qc,FK as rc,LK as sc,Kc as tc,VK as uc,jK as vc,BK as wc,UK as xc,OH as yc,$K as zc,X_ as Ac,tI as Bc,HK as Cc,qK as Dc,zK as Ec,nI as Fc,WK as Gc,GK as Hc,Z0 as Ic,Yc as Jc,YI as Kc,fQ as Lc,pQ as Mc,gQ as Nc,mQ as Oc,yQ as Pc,vQ as Qc,_Q as Rc,IQ as Sc,EQ as Tc,wQ as Uc,TQ as Vc,DQ as Wc,bQ as Xc,CQ as Yc,SQ as Zc,AQ as _c,NQ as $c,RQ as ad,PQ as bd,MQ as cd,kQ as dd,xQ as ed,OQ as fd,FQ as gd,LQ as hd,VQ as id,jQ as jd,BQ as kd,UQ as ld,$Q as md,HQ as nd,qQ as od,zQ as pd,WQ as qd,GQ as rd,KQ as sd,QQ as td,YQ as ud,ZQ as vd,JQ as wd,XQ as xd,eY as yd,tY as zd,nY as Ad,rY as Bd,iY as Cd,oY as Dd,sY as Ed,aY as Fd,cY as Gd,uY as Hd,lY as Id,dY as Jd,hY as Kd,fY as Ld,pY as Md,gY as Nd,mY as Od,yY as Pd,vY as Qd,_Y as Rd,IY as Sd,EY as Td,wY as Ud,TY as Vd,DY as Wd,bY as Xd,CY as Yd,SY as Zd,AY as _d,NY as $d,RY as ae};
